<HTML>
<HEAD>
<TITLE>Linear Models</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect1.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect3.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Fit Analyses</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H1><FONT SIZE="5">Linear Models  </FONT></H1>
<A NAME="idxfit0025">&#13;</A><A NAME="idxfit0024">&#13;</A><A NAME="idxfit0027">&#13;</A><A NAME="idxfit0026">&#13;</A>SAS/INSIGHT fit analysis provides the traditional
parametric regression analysis assuming that the
regression function is linear in the unknown parameters.
The relationship is expressed as an equation
that predicts a response variable from a
linear function of explanatory variables.
<A NAME="idxfit0028">&#13;</A><A NAME="idxfit0029">&#13;</A><A NAME="idxfit0030">&#13;</A><A NAME="idxfit0031">&#13;</A>Besides the usual estimators and test statistics
produced for a regression, a fit analysis can
produce many diagnostic statistics.
Collinearity diagnostics measure the strength of the
linear relationship among explanatory variables and
how this affects the stability of the estimates.
Influence diagnostics measure how each individual
observation contributes to determining the parameter
estimates and the fitted values.
<A NAME="idxfit0033">&#13;</A><A NAME="idxfit0032">&#13;</A>In matrix algebra notation, a linear model is written as

<DL CLASS="equation"><DD><IMG WIDTH="91" HEIGHT="72"
 SRC="images/fiteq6.gif"
 ALT="y = X {\beta} + {{\epsilon}}"></DL>
where <B>y</B> is the <SPAN CLASS="mathfont"><I>n</I>&times;1</SPAN> vector of responses,
<B>X</B> is the <SPAN CLASS="mathfont"><I>n</I>&times;<I>p</I></SPAN> design matrix (rows
are observations and columns are explanatory variables),
<B><IMG WIDTH="15" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq5.gif"
 ALT="\beta"></B> is the <SPAN CLASS="mathfont"><I>p</I>&times;1</SPAN> vector of unknown
parameters, and <B><IMG WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq7.gif"
 ALT="{\epsilon}"></B> is the <SPAN CLASS="mathfont"><I>n</I>&times;1</SPAN>
vector of unknown errors.
<A NAME="idxfit0035">&#13;</A><A NAME="idxfit0034">&#13;</A><A NAME="idxfit0036">&#13;</A>Each effect in the model generates one or
more columns in a design matrix <B>X</B>.
The first column of <B>X</B> is usually a vector
of 1's used to estimate the intercept term.
In general, no-intercept models should be fit
only when theoretical justification exists.
Refer to the chapter on the GLM procedure in the
<I>SAS/STAT User's Guide</I>
for a description of the model parameterization.
<A NAME="idxfit0037">&#13;</A>The classical theory of linear models
is based on some strict assumptions.
Ideally, the response is measured with all
the explanatory variables controlled in
an experimentally determined environment.
If the explanatory variables do not have
experimentally fixed values but are stochastic,
the conditional distribution of <B>y</B> given
<B>X</B> must be normal in the appropriate form.
<P>Less restrictive assumptions are as follows:
<P><UL>
<LI> The form of the model is correct (all
   important X variables have been included).
<LI> Explanatory variables are measured without error.
<LI> The expected value of the errors is 0.
<LI> The variance of the errors (and thus the
   response variable) is constant across
   observations (denoted by  <IMG WIDTH="22" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq8.gif"
 ALT="{\sigma}^2">).
<LI> The errors are uncorrelated across observations.
<P></UL>
<A NAME="idxfit0038">&#13;</A><A NAME="idxfit0039">&#13;</A><A NAME="idxfit0040">&#13;</A>If all the necessary assumptions are met, the least-squares
estimates of <IMG WIDTH="15" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq5.gif"
 ALT="\beta"> are the best linear unbiased estimates
(BLUE); in other words, the estimates have minimum variance
among the class of estimators that are unbiased and are
linear functions of the responses.
In addition, when the error term is assumed to
be normally distributed, sampling distributions
for the computed statistics can be derived.
These sampling distributions form the basis
for hypothesis tests on the parameters.
<A NAME="idxfit0041">&#13;</A><A NAME="idxfit0042">&#13;</A>The method used to estimate the parameters is to minimize
the sum of squares of the differences between the actual
response values and the values predicted by the model.
An estimator <B>b</B> for <B><IMG WIDTH="15" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq5.gif"
 ALT="\beta"></B> is generated
by solving the resulting normal equations

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont">(<b>X</b>'<b>X</b>)<b>b</b> = <b>X</b>'<b>y</b></SPAN>
</DL>
yielding

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>b</b> = (<b>X</b>'<b>X</b>)<sup>-1</sup> <b>X</b>'<b>y</b></SPAN>
</DL>
<A NAME="idxfit0044">&#13;</A><A NAME="idxfit0043">&#13;</A>Let <B>H</B> be the projection matrix for the space
spanned by <B>X</B>, sometimes called the hat matrix,

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>H</b> = <b>X</b> (<b>X</b>'<b>X</b>)<sup>-1</sup> <b>X</b>'</SPAN>
</DL>
<A NAME="idxfit0046">&#13;</A><A NAME="idxfit0045">&#13;</A><A NAME="idxfit0048">&#13;</A><A NAME="idxfit0047">&#13;</A>Then the predicted mean vector of
the <SPAN CLASS="mathfont"><I>n</I></SPAN> observation responses is

<DL CLASS="equation"><DD><IMG WIDTH="112" HEIGHT="72"
 SRC="images/fiteq9.gif"
 ALT="\hat{y} = X{b} = H y"></DL>
<A NAME="idxfit0050">&#13;</A><A NAME="idxfit0049">&#13;</A>The sum of squares for error is

<DL CLASS="equation"><DD><IMG WIDTH="323" HEIGHT="110"
 SRC="images/fiteq10.gif"
 ALT="SSE = {(y-\hat{y})'}
 (y-\hat{y})
 = \sum_{i=1}^n{( y_{i}
 - x_{i}b)^2}"></DL>
where <B>x</B><SPAN CLASS="mathfont"><sub><I>i</I></sub></SPAN> is the
<SPAN CLASS="mathfont"><I>i</I></SPAN>th row of the <B>X</B> matrix.
<A NAME="idxfit0052">&#13;</A><A NAME="idxfit0051">&#13;</A>Assume that <B>X</B> is of full rank.
The variance  <IMG WIDTH="22" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq8.gif"
 ALT="{\sigma}^2"> of the
error is estimated by the mean square error

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><I>s<SUp>2</SUp></I> = <I>MSE</I> = [<I>SSE</I>/(<I>n</I> - <I>p</I>)]</SPAN>
</DL>
<A NAME="idxfit0054">&#13;</A><A NAME="idxfit0053">&#13;</A><A NAME="idxfit0056">&#13;</A><A NAME="idxfit0055">&#13;</A>The parameter estimates are unbiased:

<DL CLASS="equation"><DD><IMG WIDTH="76" HEIGHT="74"
 SRC="images/fiteq11.gif"
 ALT="{E(b) = {\beta}}"></DL>

<DL CLASS="equation"><DD><IMG WIDTH="91" HEIGHT="76"
 SRC="images/fiteq12.gif"
 ALT="{E( s^2) = {\sigma}^2}."></DL>
<P>The covariance matrix of the estimates is

<DL CLASS="equation"><DD><IMG WIDTH="164" HEIGHT="76"
 SRC="images/fiteq13.gif"
 ALT="\rm{Var}(b) = ({X'}X)^{-1}
 {\sigma}^2"></DL>
<A NAME="idxfit0058">&#13;</A><A NAME="idxfit0057">&#13;</A>The estimate of the covariance matrix,
<IMG WIDTH="57" HEIGHT="42" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq14.gif"
 ALT="{\hat{\rm{Var}}(b)}">, is obtained by
replacing  <IMG WIDTH="22" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq8.gif"
 ALT="{\sigma}^2"> with its estimate,
 <SPAN CLASS="mathfont"><I>s<SUp>2</SUp></I></SPAN>, in the preceding formula:

<DL CLASS="equation"><DD><IMG WIDTH="161" HEIGHT="78"
 SRC="images/fiteq15.gif"
 ALT="\hat{\rm{Var}}(b) = ({X'}X)^{-1}
 s^2"></DL>
<P>The correlations of the estimates,

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>S</b><sup>-1/2</sup> (<b>X</b>'<b>X</b>)<sup>-1</sup> <b>S</b><sup>-1/2</sup></SPAN>
</DL>
are derived by scaling to one on the diagonal, where
<SPAN CLASS="mathfont"><b>S</b></SPAN> = diag ( <SPAN CLASS="mathfont">(<b>X</b>'<b>X</b>)<sup>-1</sup></SPAN>).
<A NAME="idxfit0060">&#13;</A><A NAME="idxfit0059">&#13;</A>If the model is not full rank,
the matrix <B>X</B>'<B>X</B> is singular.
A generalized (g2) inverse (Pringle and Raynor 1971),
denoted as <SPAN CLASS="mathfont">(<b>X</b>'<b>X</b>)<sup>-</sup></SPAN>,
is then used to solve the normal equations, as follows:

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>b</b> = (<b>X</b>'<b>X</b>)<sup>-</sup> <b>X</b>'<b>Y</b></SPAN>
</DL>
<P>However, this solution is not unique, and there are an infinite
number of solutions using different generalized inverses.
In SAS/INSIGHT software, the fit analysis chooses a basis
of all variables that are linearly independent of previous
variables and a zero solution for the remaining variables.
<P><p><TABLE WIDTH="100%" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD ALIGN="CENTER" WIDTH="70"><img width="32" height="32" alt="" src="../../common/images/refr.gif"><br>
<font size="-2">Related<BR>Reading</font></TD><TD BGCOLOR="#F0F0F0">Multiple Regression, <A HREF="../chap14/index.htm">Chapter 14</A>.</TD></TR></TABLE><p>
<P><p><TABLE WIDTH="100%" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD ALIGN="CENTER" WIDTH="70"><img width="32" height="32" alt="" src="../../common/images/refr.gif"><br>
<font size="-2">Related<BR>Reading</font></TD><TD BGCOLOR="#F0F0F0">Analysis of Variance, <A HREF="../chap15/index.htm">Chapter 15</A>.</TD></TR></TABLE><p>
<P>
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect1.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect3.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
