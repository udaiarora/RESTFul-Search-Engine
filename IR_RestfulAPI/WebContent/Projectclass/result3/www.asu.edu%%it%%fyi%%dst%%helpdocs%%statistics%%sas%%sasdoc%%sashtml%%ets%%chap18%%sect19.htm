<HTML>
<HEAD>
<TITLE>Parameter Estimation</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect18.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect20.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The STATESPACE Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Parameter Estimation  </H2>
<P>The model is <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I>+1</sub> = <b>Fz</b><sub><I>t</I></sub>+<b>Ge</b><sub><I>t</I>+1</sub></SPAN>,
where <SPAN CLASS="mathfont"><b>e</b><sub><I>t</I></sub></SPAN> is a sequence of independent multivariate
normal innovations with mean vector <B>0</B> and variance
<IMG WIDTH="32" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq3.gif"
 ALT="{{\Sigma}_{ee}}">.The observed sequence, <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN>, composes the first <I>r</I>
components of <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I></sub></SPAN> and, thus,
<SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub> = <b>Hz</b><sub><I>t</I></sub></SPAN>,
where <B>H</B> is the <SPAN CLASS="mathfont"><I>r</I> &times;<I>s</I></SPAN> matrix 
<SPAN CLASS="mathfont">[<SPAN CLASS="ssbeleven"><b>I</b><sub><I>r</I></sub>&#160;&#160;<b>0</b></SPAN>]</SPAN>.
<P>Let <SPAN CLASS="mathfont"><b>E</b></SPAN> be the <SPAN CLASS="mathfont"><I>r</I> &times;<I>n</I></SPAN> matrix of innovations:
<P><DL CLASS="equation"><DD><IMG WIDTH="147" HEIGHT="94" ALIGN="left"
 SRC="images/staeq51.gif"
 ALT="E = [\matrix{e_{1} & { ... } & e_{n} }] "><BR CLEAR="ALL">
</DL>
<P>If the number of observations, <I>n</I>, is reasonably large,
the log likelihood, L,
can be approximated up to an additive constant as follows:
<P>
<DL CLASS="equation"><DD><IMG WIDTH="291" HEIGHT="92"
 SRC="images/staeq52.gif"
 ALT="L
= -\frac{n}2 {\ln}( {|{\Sigma}_{ee}|} )
 -\frac{1}2 {trace}( {\Sigma}^{-1}_{ee}
 {EE}')"></DL>
<P>The elements of <IMG WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq53.gif"
 ALT="{{\Sigma}_{ee}}"> are taken as free parameters
and are estimated as follows:
<P>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>S</b><sub>0</sub> = [1/<I>n</I>]<b>EE</b>'</SPAN>
</DL>
<P>Replacing <IMG WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq53.gif"
 ALT="{{\Sigma}_{ee}}"> by <SPAN CLASS="mathfont"><b>S</b><sub>0</sub></SPAN>
in the likelihood equation,
the log likelihood, up to an additive constant, is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="123" HEIGHT="88"
 SRC="images/staeq54.gif"
 ALT="L = -\frac{n}2{\ln}( {|{S}_{0}|} )"></DL>
<P>Letting B be the backshift operator,
the formal relation between <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN>
and <SPAN CLASS="mathfont"><b>e</b><sub><I>t</I></sub></SPAN> is
<P>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub> = <b>H</b>(<b>I</b>-<I>B</I><b>F</b>)<sup>-1</sup><b>Ge</b><sub><I>t</I></sub></SPAN>
</DL>

<DL CLASS="equation"><DD><IMG WIDTH="317" HEIGHT="110"
 SRC="images/staeq55.gif"
 ALT="e_{t}
 = (H(I-B{F})^{-1}G)^{-1}x_{t}
 = \sum_{i=0}^{{\infty}}{{\Xi}_{i}x_{t-i} }"></DL>
<P>Letting <SPAN CLASS="mathfont"><b>C</b><sub><I>i</I></sub></SPAN> be the <I>i</I>th lagged sample
covariance of <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN>,
and neglecting end effects,
the matrix <SPAN CLASS="mathfont"><b>S</b><sub>0</sub></SPAN> is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="168" HEIGHT="112"
 SRC="images/staeq56.gif"
 ALT="S_{0}
 = \sum_{i,j=0}^{{\infty}}{{\Xi}_{i}C_{-i+j}
 {\Xi}^{'}_{j}
 }"></DL>
<P>For the computation of <SPAN CLASS="mathfont"><b>S</b><sub>0</sub></SPAN>,
the infinite sum is truncated at the value of the KLAG= option.
The value of the KLAG= option should be large enough that
the sequence <IMG WIDTH="23" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq57.gif"
 ALT="{{\Xi}_{i}}"> is approximately 0 beyond that point.
<P>Let <IMG WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/staeq58.gif"
 ALT="{{\theta}}"> be the vector of free parameters in the
<SPAN CLASS="mathfont"><b>F</b></SPAN> and <SPAN CLASS="mathfont"><b>G</b></SPAN> matrices.
The derivative of the log likelihood
with respect to the parameter <IMG WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/staeq58.gif"
 ALT="{{\theta}}"> is
<P><DL CLASS="equation"><DD><IMG WIDTH="210" HEIGHT="113" ALIGN="left"
 SRC="images/staeq59.gif"
 ALT="\frac{{\partial}L}{{\partial}{\theta}}
 = -\frac{n}2
 \,{\rm trace}( S^{-1}_{0}
 \frac{{\partial}S_{0}}{{\partial}{\theta}} ) "><BR CLEAR="ALL">
</DL>
<P>The second derivative is
<P><DL CLASS="equation"><DD><IMG WIDTH="478" HEIGHT="114" ALIGN="left"
 SRC="images/staeq60.gif"
 ALT="\frac{{\partial}^2{L}}{{\partial}{\theta}{\partial}{\theta}'}
 = \frac{n}2( {\rm...
 ...-1}_{0}
 \frac{{\partial}^2{S}_{0}}{{\partial}{\theta}{\partial}{\theta}'}
 ) ) "><BR CLEAR="ALL">
</DL>
<P>Near the maximum, the first term is unimportant and the
second term can be approximated to give
the following second derivative approximation:
<P><DL CLASS="equation"><DD><IMG WIDTH="254" HEIGHT="114" ALIGN="left"
 SRC="images/staeq61.gif"
 ALT="\frac{{\partial}^2L}{{\partial}{\theta}{\partial}{\theta}'}
 \cong -n\, {\rm tra...
 ...ac{{\partial}E}{{\partial}{\theta}}
 \frac{{\partial}E'}{{\partial}{\theta}' }) "><BR CLEAR="ALL">
</DL>
<P>The first derivative matrix and this second derivative matrix approximation
are computed from the sample covariance matrix <SPAN CLASS="mathfont"><b>C</b><sub>0</sub></SPAN>
and the truncated sequence <IMG WIDTH="23" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq57.gif"
 ALT="{{\Xi}_{i}}">.The approximate likelihood function is maximized by a
modified Newton-Raphson algorithm employing these derivative matrices.
<P>The matrix <SPAN CLASS="mathfont"><b>S</b><sub>0</sub></SPAN> is used as the estimate of the innovation
covariance matrix, <IMG WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq53.gif"
 ALT="{{\Sigma}_{ee}}">.The negative of the inverse of the second derivative matrix at the maximum
is used as an approximate covariance matrix for the parameter estimates.
The standard errors of the parameter estimates printed in the
parameter estimates tables are taken from the diagonal of this
covariance matrix.
The parameter covariance matrix is printed when the COVB option is specified.
<P>If the data are nearly nonstationary, a better
estimate of <IMG WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq53.gif"
 ALT="{{\Sigma}_{ee}}"> and the other parameters can
sometimes be obtained by specifying the RESIDEST option.
The RESIDEST option estimates the parameters using conditional least squares
instead of maximum likelihood.
<P>The residuals are computed using the state space equation and the
sample mean values of the variables in the model as start-up values.
The estimate of <SPAN CLASS="mathfont"><b>S</b><sub>0</sub></SPAN> is then computed using the residuals
from the <I>i</I>th observation on, where <I>i</I> is the maximum number
of times any variable occurs in the state vector.
A multivariate Gauss-Marquardt algorithm is used to
minimize <IMG WIDTH="33" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq62.gif"
 ALT="{{|{S}_{0}|}}">.Refer to Harvey (1981a) for a further description of this method.
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect18.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect20.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
