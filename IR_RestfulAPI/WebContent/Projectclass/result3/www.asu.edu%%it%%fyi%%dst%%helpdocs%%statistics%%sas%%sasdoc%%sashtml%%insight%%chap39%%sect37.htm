<HTML>
<HEAD>
<TITLE>Kernel Surface Plot</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect36.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect38.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Fit Analyses</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Kernel Surface Plot  </H2>
<P>A <I>kernel estimator</I> uses an explicitly defined set of
weights at each point <I><B>x</B></I> to produce the estimate
at <I><B>x</B></I>.  The kernel estimator of <SPAN CLASS="mathfont"><I>f</I></SPAN> has the form

<DL CLASS="equation"><DD><IMG WIDTH="230" HEIGHT="110"
 SRC="images/fiteq161.gif"
 ALT="\hat{f_\lambda}(x) = \sum_{i=1}^n{W( x , x_{i}; \lambda, V_{x}) y_{i}}"></DL>
where W<IMG WIDTH="105" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq162.gif"
 ALT="{( x , x_{i}; \lambda, V_{x})}">is the weight function that depends on the smoothing parameter <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> and
the diagonal matrix  <SPAN CLASS="mathfont"><b>V</b><sub><b>x</b></sub></SPAN> of the squares
of the sample interquartile ranges.
<P><A NAME="idxfit0615">&#13;</A><A NAME="idxfit0614">&#13;</A>The weights are derived from a single
function that is independent of the design

<DL CLASS="equation"><DD><IMG WIDTH="351" HEIGHT="102"
 SRC="images/fiteq163.gif"
 ALT="W( x , x_{i}; \lambda, V_{x}) =
 \frac{K_{0} (
 (x - x_{i})/\lambda, V_{x} )}{\sum_{j=1}^n{K_{0} (
 (x - x_{j})/\lambda, V_{x} ) } }"></DL>
where  <SPAN CLASS="mathfont"><I>K<SUB>0</SUB></I></SPAN> is a kernel function and
<IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> is the bandwidth or smoothing parameter.
The weights are nonnegative and sum to 1.
<P>Symmetric probability density functions
commonly used as kernel functions are
<P><TABLE COLS=3 BORDER=0><COL><COL ALIGN=JUSTIFY><COL ALIGN=JUSTIFY>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="96" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq164.gif"
 ALT=" \bullet  Normal"></TD><TD><IMG WIDTH="243" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq165.gif"
 ALT="K_{0}(t, V) = \frac{1}{2{\pi}} \exp( - \frac{1}2 {t'} V^{-1} t) "></TD><TD>for all t</TD></TR>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="114" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq166.gif"
 ALT=" \bullet  Quadratic"></TD><TD><IMG WIDTH="244" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq167.gif"
 ALT="K_{0}(t, V) = \{ \frac{2}{{\pi}} (1-{t'} V^{-1} t)
 \ 0 
 \ ."></TD><TD><IMG WIDTH="135" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq168.gif"
 ALT="  {for {t'} V^{-1} t \le 1} \  {otherwise} \ "></TD></TR>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="106" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq169.gif"
 ALT=" \bullet  Biweight"></TD><TD><IMG WIDTH="251" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq170.gif"
 ALT="K_{0}(t, V) = \{ \frac{3}{{\pi}} (1-{t'} V^{-1} t)^2 
 \ 0 
 \ ."></TD><TD><IMG WIDTH="135" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq168.gif"
 ALT="  {for {t'} V^{-1} t \le 1} \  {otherwise} \ "></TD></TR>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="113" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq171.gif"
 ALT=" \bullet  Triweight"></TD><TD><IMG WIDTH="251" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq172.gif"
 ALT="K_{0}(t, V) = \{ \frac{4}{{\pi}} (1-{t'} V^{-1} t)^3 
 \ 0 
 \ ."></TD><TD><IMG WIDTH="135" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq168.gif"
 ALT="  {for {t'} V^{-1} t \le 1} \  {otherwise} \ "></TD></TR>
</TABLE>
<P><A NAME="idxfit0617">&#13;</A><A NAME="idxfit0616">&#13;</A><A NAME="idxfit0619">&#13;</A><A NAME="idxfit0618">&#13;</A><A NAME="idxfit0621">&#13;</A><A NAME="idxfit0620">&#13;</A><A NAME="idxfit0623">&#13;</A><A NAME="idxfit0622">&#13;</A><A NAME="idxfit0625">&#13;</A><A NAME="idxfit0624">&#13;</A><A NAME="idxfit0627">&#13;</A><A NAME="idxfit0626">&#13;</A><A NAME="idxfit0629">&#13;</A><A NAME="idxfit0628">&#13;</A>You select a bandwidth <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> for each kernel
estimator by specifying <I>c</I> in the formula

<DL CLASS="equation"><DD><IMG WIDTH="74" HEIGHT="75"
 SRC="images/fiteq173.gif"
 ALT="\lambda = n^{-\frac{1}6} c"></DL>
where <SPAN CLASS="mathfont"><I>n</I></SPAN> is the sample size.
Both <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> and <I>c</I> are independent of the units of <SPAN CLASS="ssbeleven"><B>X</B></SPAN>.
<P>SAS/INSIGHT software divides the range of each explanatory
variable into a number of evenly spaced intervals, then estimates 
the kernel fit on this grid.
For a data point <SPAN CLASS="mathfont"><b>x</b><sub><I>i</I></sub></SPAN> that lies
between two grid points, a linear interpolation
is used to compute the predicted value.
For <SPAN CLASS="mathfont"><b>x</b><sub><I>i</I></sub></SPAN> that lies
inside a square of grid points, a pair of points that 
lie on the same vertical line as <SPAN CLASS="mathfont"><b>x</b><sub><I>i</I></sub></SPAN>
and each lying between two grid points can be found.
A linear interpolation of these two points 
is used to compute the predicted value.
<P><A NAME="idxfit0631">&#13;</A><A NAME="idxfit0630">&#13;</A><BR>
<P>After choosing <SPAN CLASS="ssbeleven"><B>Graphs:Surface Plot:Kernel</B></SPAN> from the menu, you specify a kernel and
smoothing parameter selection method in the <SPAN CLASS="ssbeleven"><B>Kernel Fit</B></SPAN> dialog.
<P><A NAME="fitkernelsurfacefitdialog">&#13;</A><CENTER><IMG SRC="images/fit30.gif" ALT="fit30.gif (4896 bytes)" HEIGHT="319" WIDTH="579"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 39.30:</B> Kernel Surface Fit Dialog</SPAN><P>
<P>By default, SAS/INSIGHT software divides the range of 
each explanatory variable into 20 evenly spaced intervals,
uses a normal weight, and uses a <I>c</I> value that minimizes
<IMG WIDTH="100" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq127.gif"
 ALT="{ \rm{MSE}_{GCV}(\lambda)}">.<A HREF="sect37.htm#fitkernelsurfaceplot">Figure 39.31</A> illustrates normal
kernel estimates with <I>c</I> values of 0.5435 (the GCV value) and 1.0.
Use the slider to change the <I>c</I> value of the kernel fit.
<A NAME="idxfit0632">&#13;</A><P><A NAME="fitkernelsurfaceplot">&#13;</A>
<CENTER><IMG SRC="images/fit31.gif" ALT="fit31.gif (22067 bytes)" HEIGHT="518" WIDTH="977"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 39.31:</B> Kernel Surface Plot</SPAN><P>
<P>
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect36.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect38.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
