<HTML>
<!-- This page produced Tue Jul 20 10:24:46 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Data Set Data Model Class : Data Set Data Model: _setKey </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="zmv6slam.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z19064.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z19069.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">Data Set Data Model: _setKey</FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z19067">Data Set Data Model: _setKey</A></FONT></H1>

<P><HR><BR><B>Sets an index key for retrieving the rows in the
table</B><p>
 <HR>
<TABLE cellspacing="0" cellpadding="1">
<TR>
<TD colspan="2"><A href="z19067.htm#zid-4997"><FONT size="2"><B>Syntax</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z19067.htm#z11834"><FONT size="2"><B>Details</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z19067.htm#z11835"><FONT size="2"><B>Example</b></FONT></A></TD></TR></TABLE>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><H2><A name="zid-4997">Syntax</A></H2></TD></TR></TABLE>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top"><TD>
CALL SEND (<I>object-id</I>, '_setKey', <I>rc</I>&lt;,
<I>keyname</I>&lt;, <I>condition</I>&lt;, <I>scroll</I>&lt;,
<I>val-list</I>&gt;&gt;&gt;&gt;);
</TD></TR></TABLE><A name="zid-4998">&#13;</A>
<P>
<P>
<TABLE cellpadding="6" cellspacing="0" border="1">


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="BOTTOM" ><B>Argument </B></TH>
  <TH  align="LEFT" valign="BOTTOM" ><B>Type </B></TH>
  <TH  colspan="3" align="LEFT" valign="BOTTOM" ><B>Description </B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>rc</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">N </TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">returns 


<CODE><B>0</B></CODE> if the   key was successfully applied, nonzero otherwise</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>keyname</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">C </TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">specifies the name of the key or index to use on the   table.  The <B>keyname</B> may
specify a single or compound index.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>condition</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">C </TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">specifies the condition to use when comparing the   key value:</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">equal to</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">  greater than or equal to</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">greater than</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">  less than or equal to</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">less than</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>scroll</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">C </TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">specifies whether rows can be retrieved in  random order:</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  colspan="2" align="LEFT" valign="TOP">'SCROLL' </TD>
  
<TD  align="LEFT" valign="TOP">rows can be retrieved in random order (default)</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  colspan="2" align="LEFT" valign="TOP">'NOSCROLL' </TD>
  
<TD  align="LEFT" valign="TOP">rows can only be retrieved sequentially</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>val-list</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">N </TD>
  
<TD  colspan="3" align="LEFT" valign="TOP">specifies the identifier of an SCL list that   contains values to use
in the   key.  The item name should reflect the appropriate column name, and
  the item value should be the value that the key value is compared   against.</TD>
</TR>

</TABLE>

<BR>

<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z11834">Details</A></FONT></B></TD></TR></TABLE>

<P>  The _setKey method enables you to set an active key in an open table
to a simple or composite key.  It establishes a set of criteria for reading
table rows by evaluating the value of the columns against the key value in
the rows.
<P>Using a composite key with _setKey operates the same way as the _where
method only when the condition is EQ.  The value returned when the condition
is EQ is the same as if the columns specified in the composite key were connected
by WHERE conditions that use AND or ALSO.
<P>For all other conditions (GT, GE, LT, or LE) specified with _setKey
for a composite key, the composite key columns are concatenated together to
form the index key.  The number returned by the _keyCount method is the number
of rows in the table that satisfy the composite key.  For example, if the
composite index consists of columns SEX and AGE and the condition is GT (greater
than), the values to search for are concatenated such that key values of 


<CODE><B>F</B></CODE> for SEX and 


<CODE><B>13</B></CODE> for AGE yield an index key of 


<CODE><B>F13</B></CODE>.  Because the search is performed on the concatenated values, some
values may meet the search condition that you did not expect, such as SEX
of 


<CODE><B>M</B></CODE> and AGE of 


<CODE><B>11</B></CODE>, because the string 


<CODE><B>M11</B></CODE>
is considered greater than the string 


<CODE><B>F13</B></CODE>.
<P>Once an active key is set through the _setKey method, it remains active
until the following conditions are met: 
<P>
<UL>

<LI>the table is closed<P>

<LI>another key is set<P>

<LI>the current setting is cleared by passing
the <B>rc</B>
argument alone to the _setKey method.<P>
</UL>

<P>The table is automatically positioned at the row that meets the specified
criteria.
<P>The _setKey method cannot be used in conjunction with a WHERE clause.
<P>The _setKey method sets SYSRC for error, note, and warning
conditions.
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z11835">Example</A></FONT></B></TD></TR></TABLE>

<P>  The following example creates an index on the STATE column in the
table SASUSER.CRIME.  It subsets on STATE values less than 20.  In this example,
COUNT returns 


<CODE><B>15</B></CODE>.  This example assumes you have created a frame
with a data table named TABLE.
<P>   



<TABLE cellspacing="0" cellpadding="6" border="0">
<TR valign="top">
<TD ><A name="z12426">&nbsp;</A><A href="z12426.htm"><IMG border="0" src="../common/images/snbut.gif" height="24" width="24" alt="Note about code"></A></TD><TD><PRE>
INIT:
   dsid=open('sasuser.crime', 'v');
   rc=icreate(dsid, 'state', 'state');
   dsid=close(dsid);</PRE></TD></TR></TABLE>


  



<TABLE cellspacing="0" cellpadding="6" border="0">
<TR valign="top">
<TD ><A name="z12427">&nbsp;</A><A href="z12427.htm"><IMG border="0" src="../common/images/snbut.gif" height="24" width="24" alt="Note about code"></A></TD><TD><PRE>
   call notify('.', '_getWidget',
              'TABLE', tabid);
   call send(tabid, '_setDataset',
              'sasuser.crime');</PRE></TD></TR></TABLE>


  



<TABLE cellspacing="0" cellpadding="6" border="0">
<TR valign="top">
<TD ><A name="z12430">&nbsp;</A><A href="z12430.htm"><IMG border="0" src="../common/images/snbut.gif" height="24" width="24" alt="Note about code"></A></TD><TD><PRE>
   list=makelist();
   list=setnitemn(list, 20, 'state');
   call send(tabid, '_setKey', rc,
            'state', 'LT', 'scroll', list);
   call send(tabid, '_keyCount', rc, count);
   put count=;
return;

TERM:
   list=dellist(list);
return;</PRE></TD></TR></TABLE>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="zmv6slam.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z19064.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z19069.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z19067">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>