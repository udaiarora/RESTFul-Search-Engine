<HTML>
<!-- This page produced Tue Jul 20 10:24:46 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Chart Control : Using Subsets of Data in a Chart Control </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="zt-c-doc.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0614389.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0614391.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">SAS/AF Software: Class Dictionary                                                                                         </FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z1239338">Using Subsets of Data in a Chart Control</A></FONT></H1>


<P>To create subsets of the
data for a Chart control, you can:
<P>
<UL>

<LI>Use the dataSetID attribute when specifying data for the analysis.
This technique lets you use a WHERE clause to create a data subset before
displaying a graph. For more information, see <A href="z0614389.htm">Specifying Data in a Chart Control</A>.<P>

<LI>Provide reference lines so the user can interactively
position
the reference line at data points of interest. You can then query the reference
lines to get their position, and create a data subset using those data values.
For information on using reference lines, see <A href="z1239372.htm">Adding Reference Lines to a Chart Control</A>.<P>
</UL>

<P>Because you can query a reference line
for its position, you can create
an application that creates data subsets interactively. In this application,
the user can drag the reference lines to encompass the data range of interest.
You can then query each line to determine its position, and generate a graph
that uses those position values as the minimum and maximum values in the analysis.
<P>For example, assume you have added two reference lines to a control
named chart1, and that you stored their ID's in the variables refLine1 and
refLine2. The following code queries the lines for their values and sets the
data source for a histogram whose lowest data value is the value from line
refLine1, and whose highest value is the value from line refLine2:



<PRE>lowVal=0;
highVal=0;
chart1._getReferenceLineValue(refLine1, lowVal);
chart1._getReferenceLineValue(refLine2, highVal);
/* open a data set and use the reference-line */
/* values as the low and high values          */
dsid=open('sasuser.mydata');
   rc=where(dsid, 'x>lowVal','and x&lt;highVal');
/* assume hist1 is an existing Histogram control */
hist1.dataSource='datasetid';
hist1.dataSetID=dsid;</PRE>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="zt-c-doc.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0614389.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0614391.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z1239338">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>