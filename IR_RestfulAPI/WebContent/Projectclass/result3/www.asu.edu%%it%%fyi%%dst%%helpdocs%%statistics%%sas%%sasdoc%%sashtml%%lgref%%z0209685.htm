<HTML>
<!-- This page produced Mon Jul 19 13:58:41 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Functions and CALL Routines : MOPEN </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0245852.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0197966.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0245917.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">MOPEN</FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z0209685">MOPEN</A></FONT></H1>

<P><HR><BR><B>Opens a file by directory id and member name, and returns the
file identifier or a 0</B><p>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="right" bgcolor="#F5F5F5" nowrap><B>Category:</B></TD>
<TD bgcolor="#CCCCCC" align="left">External
Files
</TD></TR>
</TABLE><HR>
<TABLE cellspacing="0" cellpadding="1">
<TR>
<TD colspan="2"><A href="z0209685.htm#zid-1325"><FONT size="2"><B>Syntax</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0209685.htm#zid-1326"><FONT size="2"><B>Arguments</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0209685.htm#z0226355"><FONT size="2"><B>Details</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0209685.htm#z0226358"><FONT size="2"><B>Examples</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0209685.htm#z0226360"><FONT size="2"><B>See Also</b></FONT></A></TD></TR></TABLE>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><H2><A name="zid-1325">Syntax</A></H2></TD></TR></TABLE>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top"><TD>
<B>MOPEN</B>(<I>directory-id</I>,<I>member-name</I>&lt;<I>open-mode</I>&lt;,<I>record-length</I>&lt;,<I>record-format</I>&gt;&gt;&gt;)
</TD></TR></TABLE>
<BR><H3><A name="zid-1326">Arguments</A></H3>

<P><A name="z0844772">&#13;</A>
<DL>
<DT><B><B><I>directory-id</I></B></B></DT>
<DD>specifies the identifier that was assigned
when the directory was opened, generally by the DOPEN function.<P></DD>

<DT><B><B><I>member-name</I></B></B></DT>
<DD>specifies the member name in the directory.<P></DD>

<DT><B><B><I>open-mode</I></B></B></DT>
<DD>specifies the type of access to the file: 
<TABLE cellpadding="5" cellspacing="0">
<TR align=left valign="top">
<TD>A</TD>
<TD align="left">APPEND mode allows writing new records
after the current end of the file.</TD></TR>

<TR align=left valign="top">
<TD>I</TD>
<TD align="left">INPUT mode allows reading only. (Default)</TD></TR>

<TR align=left valign="top">
<TD>O</TD>
<TD align="left">OUTPUT mode defaults to the OPEN
mode specified in the host option in the FILENAME statement or function. 
If no host option is specified, it allows writing new records at the beginning
of the file.</TD></TR>

<TR align=left valign="top">
<TD>S</TD>
<TD align="left">Sequential input mode is used for
pipes and other sequential devices such as hardware ports.</TD></TR>

<TR align=left valign="top">
<TD>U</TD>
<TD align="left">UPDATE mode allows both reading and
writing.</TD></TR>

<TR align=left valign="top">
<TD>W</TD>
<TD align="left">Sequential update  mode is used for
pipes and other sequential devices such as ports.</TD></TR>
</TABLE>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Default:</B></TD>
<TD align="left" bgcolor="#F5F5F5">I</TD>
</TABLE>
<P></DD>

<DT><B><B><I>record-length</I></B></B></DT>
<DD>specifies a new logical record length for
the file.  To use the existing record length for the file, specify a length
of 0 or do not provide a value here.<P></DD>

<DT><B><B><I>record-format</I></B></B></DT>
<DD>specifies a new record format for the file.
To use the existing record format, do not specify a value here.  Valid values
are: 
<TABLE cellpadding="5" cellspacing="0">
<TR align=left valign="top">
<TD>B</TD>
<TD align="left">specifies that data is to be interpreted
as binary data.</TD></TR>

<TR align=left valign="top">
<TD>D</TD>
<TD align="left">specifies the default record format.</TD></TR>

<TR align=left valign="top">
<TD>E</TD>
<TD align="left">specifies the editable record format.</TD></TR>

<TR align=left valign="top">
<TD>F</TD>
<TD align="left">specifies that the file contains
fixed-length records.</TD></TR>

<TR align=left valign="top">
<TD>P</TD>
<TD align="left">specifies that the file contains
printer carriage control in host-dependent record format.</TD></TR>

<TR align=left valign="top">
<TD>V</TD>
<TD align="left">specifies that the file contains
variable-length records.</TD></TR>
</TABLE>
<P></DD>
</DL>


<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0226355">Details</A></FONT></B></TD></TR></TABLE>

<P>MOPEN returns the
identifier for the file, or 0 if the file could not be opened. You can use
a <I>file-id</I> that is returned by the MOPEN function
as you would use a <I>file-id</I> returned by the FOPEN
function. <DL>
<DT><B><FONT color="FF00007">CAUTION:</FONT></B></DT><DD><B>Use OUTPUT mode with care.</B>
Opening an existing file for output may overwrite the current
contents of the file without warning.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"></DD></DL>
<P>The member is identified by <I>directory-id</I> and <I>member-name</I>
instead of by
a fileref.  You can also open a directory member by using FILENAME to assign
a fileref to the member, followed by a call to FOPEN. However, when you use
MOPEN, you do not have to use a separate fileref for each member.
<P>If the file already exists, the output and update modes
default to the host option (append or replace) specified with the FILENAME
statement or function.  For example,  



<PRE>%let rc=%sysfunc(filename(file,<I>physical-name</I>,,mod));
%let did=%sysfunc(dopen(&amp;file));
%let fid=%sysfunc(mopen(&amp;did,<I>member-name</I>,o,0,d));
%let rc=%sysfunc(fput(&amp;fid,This is a test.));
%let rc=%sysfunc(fwrite(&amp;fid));
%let rc=%sysfunc(fclose(&amp;fid));</PRE>
<P>If 


<CODE><B>'file'</B></CODE> already exists, FWRITE appends
the new record instead of writing it at the beginning of the file.  However,
if there is no a host option specified with the FILENAME function, the output
mode implies that the record be replace.
<P>If the open fails, use SYSMSG to retrieve the message
text. 
<P><B>Operating Environment Information:</B>&nbsp;&nbsp;&nbsp;The term
<I>directory</I> in this
description refers to an aggregate grouping of files that are managed by the
operating environment.  Different host operating environments identify such
groupings with different names, such as directory, subdirectory, MACLIB, or
partitioned data set.  For details, see the SAS documentation for your operating
environment.
<P>Opening a directory member for output or append is not
possible in some operating environments.&nbsp;&nbsp;<img border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom">
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0226358">Examples</A></FONT></B></TD></TR></TABLE>

<P>This example assigns the fileref MYDIR to a directory.
 Then it opens the directory, determines the number of members, retrieves
the name of the first member, and opens that member.  The last three arguments
to MOPEN are the defaults. Note that in a macro statement you do not enclose
character strings in quotation marks. 



<PRE>%let filrf=mydir;
%let rc=%sysfunc(filename(filrf,<I>physical-name</I>));
%let did=%sysfunc(dopen(&amp;filrf));
%let frstname=' ';
%let memcount=%sysfunc(dnum(&amp;did));
%if (&amp;memcount > 0) %then
   %do;
      %let frstname = 
         %sysfunc(dread(&amp;did,1));
      %let fid = 
         %sysfunc(mopen(&amp;did,&amp;frstname,i,0,d));
      <I>macro statements to process the member</I>

      %let rc=%sysfunc(fclose(&amp;fid));
   %end;
%else
   %put %sysfunc(sysmsg());
%let rc=%sysfunc(dclose(&amp;did));</PRE>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><FONT size="5"><A name="z0226360">See Also</A></FONT>
</FONT></B></TD></TR></TABLE>
<P>
<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD>Functions:
<P>
<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD><A href="z0209680.htm">DCLOSE</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0209695.htm">DNUM</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0209538.htm">DOPEN</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0209687.htm">DREAD</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0210034.htm">FCLOSE</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0210819.htm">FILENAME</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0209683.htm">FOPEN</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0210081.htm">FPUT</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0210085.htm">FWRITE</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0210917.htm">SYSMSG</A></TD></TR></TABLE></TD></TR></TABLE>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0245852.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0197966.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0245917.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z0209685">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>