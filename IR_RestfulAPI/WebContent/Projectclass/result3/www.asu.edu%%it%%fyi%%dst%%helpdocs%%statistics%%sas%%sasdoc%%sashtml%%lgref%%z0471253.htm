<HTML>
<!-- This page produced Mon Jul 19 13:58:41 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Functions and CALL Routines : CALL MODULE </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0245852.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0127812.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0471258.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">CALL MODULE</FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z0471253">CALL MODULE</A></FONT></H1>

<P><HR><BR><B>Calls the external routine without any return code</B><p>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="right" bgcolor="#F5F5F5" nowrap><B>Category:</B></TD>
<TD bgcolor="#CCCCCC" align="left">External Routines
</TD></TR>
</TABLE><HR>
<TABLE cellspacing="0" cellpadding="1">
<TR>
<TD colspan="2"><A href="z0471253.htm#znid-654"><FONT size="2"><B>Syntax</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0471253.htm#znid-655"><FONT size="2"><B>Arguments</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0471253.htm#z0510011"><FONT size="2"><B>Details</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0471253.htm#z0510012"><FONT size="2"><B>Comparisons</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0471253.htm#z0510013"><FONT size="2"><B>Examples</b></FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0471253.htm#z0624720"><FONT size="2">Example 1: Using the CALL MODULE Routine</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0471253.htm#z0624725"><FONT size="2">Example 2: Using the MODULEIN Function in the IML Procedure</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0471253.htm#z0624738"><FONT size="2">Example 3: Using the MODULEN Function</FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0471253.htm#z0510014"><FONT size="2"><B>See Also</b></FONT></A></TD></TR></TABLE>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><H2><A name="znid-654">Syntax</A></H2></TD></TR></TABLE>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top"><TD>
<B>CALL
MODULE</B>(&lt;<I>cntl-string</I>,&gt;<I>module-name</I>&lt;,<I>argument-1,
..., argument-n</I>&gt;);
</TD></TR></TABLE>
<BR><H3><A name="znid-655">Arguments</A></H3>

<P>
<DL>
<DT><B><B><I>cntl-string</I></B></B></DT>
<DD>is an optional control string whose first
character must be an asterisk (*), followed by any combination of the following
characters:
<TABLE cellpadding="5" cellspacing="0">
<TR align=left valign="top">
<TD>I</TD>
<TD align="left">prints the hexadecimal representations
of all arguments to the CALL MODULE routine. You can use this option to help
diagnose problems caused by incorrect arguments or attribute tables. If you
specify the I option, the E option is implied.</TD></TR>

<TR align=left valign="top">
<TD>E</TD>
<TD align="left">prints detailed error messages. Without
the E option (or the I option, which supersedes it), the only error message
that the CALL MODULE routine generates is "Invalid argument to function,"
which is usually not enough information to determine the cause of the error.
The E option is useful for a production environment, while the I option is
preferable for a development or debugging environment.</TD></TR>

<TR align=left valign="top">
<TD>H</TD>
<TD align="left">provides brief help information about
the syntax of the CALL MODULE routine, the attribute file format, and suggested
SAS formats and informats.</TD></TR>
</TABLE>
<P></DD>

<DT><B><B><I>module-name</I></B></B></DT>
<DD>is the name of the external module to use. <P></DD>

<DT><B><B><I>argument</I></B></B></DT>
<DD>is one or more arguments to pass to the
requested routine. <DL>
<DT><B><FONT color="FF00007">CAUTION:</FONT></B></DT><DD><B>Be sure to use the correct arguments and attributes.</B>
If you use incorrect arguments or attributes, you can
cause the SAS System, and possibly your operating system, to fail.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"></DD></DL><P></DD>
</DL>


<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0510011">Details</A></FONT></B></TD></TR></TABLE>

<P>The CALL MODULE
routine executes a routine <I>module-name</I> that resides
in an external library with the specified arguments.
<P>CALL MODULE builds a parameter list using the information
in the arguments and a routine description and argument attribute table that
you define in a separate file. The attribute table is a sequential text file
that contains descriptions of the routines that you can invoke with the CALL
MODULE routine. The purpose of the table is to define how CALL MODULE should
interpret its supplied arguments when it builds a parameter list to pass to
the external routine. The attribute table should contain a description for
each external routine that you intend to call, and descriptions of each argument
associated with that routine.
<P>Before you invoke CALL MODULE, you must define the fileref
of SASCBTBL to point to the external file that contains the attribute table.
You can name the file whatever you want when you create it. This way, you
can use SAS variables and formats as arguments to CALL MODULE and ensure that
these arguments are properly converted before being passed to the external
routine. If you do not define this fileref, CALL MODULE calls the requested
routine without altering the arguments.
<P>For more information on the attribute table, see <B>SAS Language Reference: Concepts</B>.<DL>
<DT><B><FONT color="FF00007">CAUTION:</FONT></B></DT><DD><B>Using the
CALL MODULE routine without a defined attribute
table can cause the SAS System to fail or force you to reset your computer.</B>
You need to use an attribute table for all
external functions that you want to invoke.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"></DD></DL>
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0510012">Comparisons</A></FONT></B></TD></TR></TABLE>

<P>The two CALL
routines and four functions share identical syntax:
<P>
<UL>

<LI>The MODULEN and MODULEC functions return a number
and a character, respectively, while the routine CALL MODULE does not return
a value.<P>

<LI>The CALL MODULEI routine and the functions MODULEIC
and MODULEIN permit vector and matrix arguments. Their return values are scalar.
You can invoke CALL MODULEI, MODULEIC, and MODULEIN only from the IML procedure.<P>
</UL>

<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0510013">Examples</A></FONT></B></TD></TR></TABLE>

<BR><H3> <A name="z0624720">Example 1: Using the CALL MODULE Routine</A> </H3>


<P>This example calls the 


<CODE><B>xyz</B></CODE>
routine. Use the following attribute table:



<PRE>routine xyz minarg=2 maxarg=2;
arg 1 input num byvalue format=ib4.;
arg 2 output char format=$char10.;</PRE>
<P>The following is the sample SAS code that calls the 


<CODE><B>xyz</B></CODE> function:



<PRE>data _null_;
   call module('xyz',1,x);
run;</PRE>
<BR><H3> <A name="z0624725">Example 2: Using the MODULEIN Function in the IML Procedure</A> </H3>


<P>This example invokes the 


<CODE><B>changi</B></CODE> routine from the TRYMOD.DLL module on a Windows platform. Use
the following attribute table:



<PRE>routine changi module=trymod returns=long;
arg 1 input num format=ib4. byvalue;
arg 2 update num format=ib4.;</PRE>
<P>The following PROC IML code  calls the 


<CODE><B>changi</B></CODE> function:



<PRE>proc iml;
   x1=J(4,5,0);
   do i=1 to 4;
      do j=1 to 5;
         x1[i,j]=i*10+j+3;
      end;
   end;
   y1=x1;
   x2=x1;
   y2=y1;
   rc=modulein('*i','changi',6,x2);</PRE>
<BR><H3> <A name="z0624738">Example 3: Using the MODULEN Function</A> </H3>


<P>This example calls the 


<CODE><B>Beep</B></CODE>
routine, which is part of the Win32 API in the USER32 Dynamic Link Library
on a Windows platform. Use the following attribute table:



<PRE>routine Beep
   minarg=2
   maxarg=2
   stackpop=called
   callseq=byvalue
   module=user32;
arg 1 num format=pib4.;
arg 2 num format=pib4.;</PRE>
<P>The following is the sample SAS code that calls the 


<CODE><B>Beep</B></CODE> function:



<PRE>filename sascbtbl 'sascbtbl.dat';
data _null_;
   rc=modulen("Beep",1380,1000);
run;</PRE>
<P>The previous code causes the computer speaker to beep.
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><FONT size="5"><A name="z0510014">See Also</A></FONT>
</FONT></B></TD></TR></TABLE>
<P>
<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD>CALL Routine:
<P>
<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD><A href="z0471258.htm">CALL MODULEI</A></TD></TR></TABLE></TD></TR></TABLE>



<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD>Functions:
<P>
<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD><A href="z0470863.htm">MODULEC</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0471223.htm">MODULEIC</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0471226.htm">MODULEIN</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0470860.htm">MODULEN</A></TD></TR></TABLE></TD></TR></TABLE>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0245852.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0127812.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0471258.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z0471253">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>