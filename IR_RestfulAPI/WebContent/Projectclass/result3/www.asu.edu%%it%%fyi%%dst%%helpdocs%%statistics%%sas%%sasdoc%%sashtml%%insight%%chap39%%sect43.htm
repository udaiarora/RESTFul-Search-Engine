<HTML>
<HEAD>
<TITLE>Nonparametric Smoothing Spline</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect42.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect44.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Fit Analyses</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Nonparametric Smoothing Spline  </H2>
<A NAME="idxfit0680">&#13;</A><A NAME="idxfit0679">&#13;</A><A NAME="idxfit0682">&#13;</A><A NAME="idxfit0681">&#13;</A>Two criteria can be used to select an estimator
<IMG WIDTH="21" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq156.gif"
 ALT="{\hat{f_\lambda}}"> for the function <SPAN CLASS="mathfont"><I>f</I></SPAN>:
<P><UL>
<LI> goodness of fit to the data
<LI> smoothness of the fit
<P></UL>
<P>A standard measure of goodness of fit
is the mean residual sum of squares

<DL CLASS="equation"><DD><IMG WIDTH="149" HEIGHT="110"
 SRC="images/fiteq191.gif"
 ALT="\frac{1}n\sum_{i=1}^n{( y_{i}-
 \hat{f_\lambda}( x_{i}))^2}"></DL>
<A NAME="idxfit0683">&#13;</A>A measure of the smoothness of a fit is
the integrated squared second derivative

<DL CLASS="equation"><DD><IMG WIDTH="129" HEIGHT="99"
 SRC="images/fiteq192.gif"
 ALT="\int_{-{\infty}}^{{\infty}}{(
 {\hat{f_\lambda}''}(x))^2 dx}"></DL>
<P>A single criterion that combines
the two criteria is then given by

<DL CLASS="equation"><DD><IMG WIDTH="380" HEIGHT="110"
 SRC="images/fiteq193.gif"
 ALT="S(\lambda) = \frac{1}n
 \sum_{i=1}^n{( y_{i}-
 \hat{f_\lambda}( x_{i}))^2} +
 \lambda\int_{-{\infty}}^{{\infty}}{(
 {\hat{f_\lambda}''}(x) )^2 dx}"></DL>
where <IMG WIDTH="21" HEIGHT="41" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq156.gif"
 ALT="{\hat{f_\lambda}}"> belongs to the set of
all continuously differentiable functions with square integrable
second derivatives, and <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> is a positive constant.
<P>The estimator that results from minimizing <I>S</I>(<IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda">)is called the <I>smoothing spline estimator</I>.
This estimator fits a cubic polynomial
in each interval between points.
At each point <SPAN CLASS="mathfont"> <I>x</I><SUB><I>i</I></SUB></SPAN>, the curve and its
first two derivatives are continuous (Reinsch 1967).
<A NAME="idxfit0684">&#13;</A><A NAME="idxfit0685">&#13;</A><A NAME="idxfit0686">&#13;</A>The smoothing parameter <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> controls the amount of
smoothing; that is, it controls the trade-off between the
goodness of fit to the data and the smoothness of the fit.
You select a smoothing parameter <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> by
specifying a constant <I>c</I> in the formula

<DL CLASS="equation"><DD><IMG WIDTH="106" HEIGHT="76"
 SRC="images/fiteq194.gif"
 ALT="\lambda = (Q / 10)^3 c"></DL>
where <I>Q</I> is the interquartile range of the explanatory variable.
This formulation makes <I>c</I> independent of the units of <SPAN CLASS="ssbeleven"><B>X</B></SPAN>.
<P>
<P>After choosing <SPAN CLASS="ssbeleven"><B>Curves:Spline</B></SPAN>, you specify a smoothing
parameter selection method in the <SPAN CLASS="ssbeleven"><B>Spline Fit</B></SPAN> dialog.
<A NAME="idxfit0687">&#13;</A><P><A NAME="fitsplinefitdialog">&#13;</A><CENTER><IMG SRC="images/fit38.gif" ALT="fit38.gif (3910 bytes)" HEIGHT="287" WIDTH="443"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 39.40:</B> Spline Fit Dialog</SPAN><P>
<P>The default <SPAN CLASS="ssbeleven"><B>Method:GCV</B></SPAN> uses a <I>c</I> value that
minimizes the generalized cross validation mean
squared error <IMG WIDTH="100" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq127.gif"
 ALT="{ \rm{MSE}_{GCV}(\lambda)}">.<A HREF="sect43.htm#fitsmoothingsplineestimates">Figure 39.41</A> displays smoothing spline estimates
with <I>c</I> values of 0.0017 (the GCV value) and 15.2219 (DF=3).
Use the slider in the table to change
the <I>c</I> value of the spline fit.
<P><A NAME="fitsmoothingsplineestimates">&#13;</A><CENTER><IMG SRC="images/fit39.gif" ALT="fit39.gif (14218 bytes)" HEIGHT="536" WIDTH="911"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 39.41:</B> Smoothing Spline Estimates</SPAN><P>
<P>
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect42.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect44.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
