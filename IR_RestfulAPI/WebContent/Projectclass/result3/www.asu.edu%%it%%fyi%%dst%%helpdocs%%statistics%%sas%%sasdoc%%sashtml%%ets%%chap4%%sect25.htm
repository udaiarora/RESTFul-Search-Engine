<HTML>
<HEAD>
<TITLE>Details</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect24.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect26.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">SAS Macros and Functions</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Details  </H2>
<P><H3><I>Theoretical Background</I></H3>
When a time series has a unit root, the
series is nonstationary and the ordinary least squares (OLS) estimator
is not normally distributed.
Dickey (1976) and Dickey and Fuller (1979)
studied the limiting distribution of the OLS estimator of
autoregressive models for time series with a simple unit root.
Dickey, Hasza and Fuller (1984) obtained the limiting
distribution for time series with seasonal unit roots.
<P>Consider the (<I>p</I>+1)th order autoregressive time series
<P>
<DL CLASS="equation"><DD><IMG WIDTH="361" HEIGHT="73"
 SRC="images/maceq19.gif"
 ALT="Y_{t} = {\alpha}_{1}Y_{t-1} + {\alpha}_{2}Y_{t-2}
 + { ... } + {\alpha}_{p+1}Y_{t-p-1} + e_{t}"></DL>
<P>and its characteristic equation
<P>
<DL CLASS="equation"><DD><IMG WIDTH="326" HEIGHT="77"
 SRC="images/maceq20.gif"
 ALT="m^{p+1} -{\alpha}_{1}m^p - {\alpha}_{2}m^{p-1}
 - { ... } - {\alpha}_{p+1} = 0"></DL>
<P>If all the characteristic roots are less than 1 in absolute value,
<SPAN CLASS="mathfont"><I>Y</I><SUB><I>t</I></SUB></SPAN> is stationary.
<SPAN CLASS="mathfont"><I>Y</I><SUB><I>t</I></SUB></SPAN> is nonstationary if there is a unit root.
If there is a unit root, the sum of the autoregressive
parameters is 1, and, hence, you can test for a unit root by testing
whether the sum of the autoregressive parameters is 1 or not.
For convenience, the model is parameterized as
<P>
<DL CLASS="equation"><DD><IMG WIDTH="353" HEIGHT="74"
 SRC="images/maceq21.gif"
 ALT="{\nabla}Y_{t} = {\delta}Y_{t-1} + {\theta}_{1}{\nabla}Y_{t-1}
+ { ... } + {\theta}_{p}{\nabla}Y_{t-p} + e_{t}"></DL>
<P>where <IMG WIDTH="132" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq22.gif"
 ALT="{{\nabla}Y_{t}=Y_{t}-Y_{t-1}}"> and
<P>
<DL CLASS="equation"><DD><IMG WIDTH="183" HEIGHT="74"
 SRC="images/maceq23.gif"
 ALT="{\delta} = {\alpha}_{1}+{ ... }+{\alpha}_{p+1}-1"></DL>

<DL CLASS="equation"><DD><IMG WIDTH="193" HEIGHT="74"
 SRC="images/maceq24.gif"
 ALT="{\theta}_{k} = -{\alpha}_{k+1}-{ ... }-{\alpha}_{p+1}"></DL>
<P>The estimators are obtained by regressing
<IMG WIDTH="35" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq25.gif"
 ALT="{{\nabla}Y_{t}}"> on
<IMG WIDTH="183" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq26.gif"
 ALT="{Y_{t-1},{\nabla}Y_{t-1},{ ... },{\nabla}Y_{t-p}}">.The <I>t</I> statistic of the ordinary least squares estimator
of <IMG WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/maceq27.gif"
 ALT="{\delta}"> is the test statistic for the unit root test.
<P>If the TREND=1 option is used, the autoregressive model includes
a mean term <IMG WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq28.gif"
 ALT="{{\alpha}_{0}}">.If TREND=2, the model also includes a time trend term and the
model is as follows:
<P>
<DL CLASS="equation"><DD><IMG WIDTH="433" HEIGHT="74"
 SRC="images/maceq29.gif"
 ALT="{\nabla}Y_{t} = {\alpha}_{0} + {\gamma}t +
{\delta}Y_{t-1} + {\theta}_{1}{\nabla}Y_{t-1}
+ { ... } + {\theta}_{p}{\nabla}Y_{t-p} + e_{t}"></DL>
<P>For testing for a seasonal unit root,
consider the multiplicative model
<P>
<DL CLASS="equation"><DD><IMG WIDTH="321" HEIGHT="78"
 SRC="images/maceq30.gif"
 ALT="(1-{\alpha}_{d}B^d)(1-{\theta}_{1}B-{ ... }
-{\theta}_{p}B^p)Y_{t}=e_{t}"></DL>
<P>Let <IMG WIDTH="131" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq31.gif"
 ALT="{{\nabla}^dY_{t} {\equiv} Y_{t}-Y_{t-d}}">.The test statistic is calculated in the following steps:
<P><OL>
<LI> Regress <IMG WIDTH="43" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq32.gif"
 ALT="{{\nabla}^dY_{t}}"> on
<IMG WIDTH="140" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq33.gif"
 ALT="{{\nabla}^dY_{t-1}{ ... }{\nabla}^dY_{t-p}}">to obtain the initial estimators <IMG WIDTH="18" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq34.gif"
 ALT="{\hat{{\theta}}_{i}}"> and compute
residuals <IMG WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq35.gif"
 ALT="{\hat{e}_{t}}">.Under the null hypothesis that <IMG WIDTH="56" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq36.gif"
 ALT="{{\alpha}_{d}=1}">,<IMG WIDTH="18" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq34.gif"
 ALT="{\hat{{\theta}}_{i}}"> are consistent estimators of
<IMG WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq37.gif"
 ALT="{{\theta}_{i}}">.<LI> Regress <IMG WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq35.gif"
 ALT="{\hat{e}_{t}}"> on <IMG WIDTH="285" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq38.gif"
 ALT="{(1-\hat{{\theta}}_{1}B-{ ... }-\hat{{\theta}}_{p}B^p)Y_{t-d},
{\nabla}^dY_{t-1}}">, <SPAN CLASS="mathfont">...</SPAN>, <IMG WIDTH="61" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq39.gif"
 ALT="{{\nabla}^dY_{t-p}}">to obtain estimates of <IMG WIDTH="87" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq40.gif"
 ALT="{{\delta}={\alpha}_{d}-1}"> and
<IMG WIDTH="54" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq41.gif"
 ALT="{{\theta}_{i}-\hat{{\theta}}_{i}}">.<P></OL>
<P>The <I>t</I> ratio for the estimate of <IMG WIDTH="12" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/maceq27.gif"
 ALT="{\delta}"> produced by the second step
is used as a test statistic for testing for a seasonal unit root.
The estimates of
<IMG WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq37.gif"
 ALT="{{\theta}_{i}}"> are obtained by adding the estimates of
<IMG WIDTH="54" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq41.gif"
 ALT="{{\theta}_{i}-\hat{{\theta}}_{i}}"> from the second step to
<IMG WIDTH="18" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq34.gif"
 ALT="{\hat{{\theta}}_{i}}"> from the first step.
The estimates of <IMG WIDTH="54" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq42.gif"
 ALT="{{\alpha}_{d}-1}"> and <IMG WIDTH="18" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq37.gif"
 ALT="{{\theta}_{i}}">are saved in the OUTSTAT= data set if the OUTSTAT= option is specified.
<P>The series <SPAN CLASS="mathfont">(1-<I>B</I><SUP><I>d</I></SUP>)<I>Y</I><SUB><I>t</I></SUB></SPAN> is assumed to be stationary,
where <I>d</I> is the value of the DLAG= option.
<P>If the OUTSTAT= option is specified,
the OUTSTAT= data set contains estimates
<IMG WIDTH="90" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq43.gif"
 ALT="{\hat{{\delta}}, \hat{{\theta}}_{1},{ ... }, \hat{{\theta}}_{p}}">.<P>If the series is an ARMA process, a large value of the AR= option
may be desirable in order to obtain a reliable test statistic.
To determine an appropriate value for the AR= option for an ARMA process,
refer to Said and Dickey (1984).
<P><H3><I>Test Statistics</I></H3>
The Dickey-Fuller test is used to test the null hypothesis that
the time series exhibits a lag <I>d</I> unit root against the 
alternative of stationarity.
The PROBDF function computes the probability of observing
a test statistic more extreme than <I>x</I> 
under the assumption that the null hypothesis is true.
You should reject the unit root hypothesis when PROBDF returns
a small (significant) probability value.
<P>There are several different versions of the Dickey-Fuller test.
The PROBDF function supports six versions, 
as selected by the <I>type</I> argument. 
Specify the <I>type</I> value that corresponds to the way that 
you calculated the test statistic <I>x</I>.
<P>The last two characters of the <I>type</I> value specify 
the kind of regression model used to compute the Dickey-Fuller 
test statistic.
The meaning of the last two characters of the <I>type</I> value 
are as follows.
<P><DL>
<DT>ZM
<DD>zero mean or no intercept case. 
The test statistic <I>x</I> is assumed to be computed from 
the regression model

<DL CLASS="equation"><DD><IMG WIDTH="126" HEIGHT="71"
 SRC="images/maceq44.gif"
 ALT="y_{t} = {\alpha}_{d}y_{t-d}+e_{t}"></DL><BR><DT>SM
<DD>single mean or intercept case.
The test statistic <I>x</I> is assumed to be computed from 
the regression model

<DL CLASS="equation"><DD><IMG WIDTH="168" HEIGHT="71"
 SRC="images/maceq45.gif"
 ALT="y_{t} = {\alpha}_{0}+{\alpha}_{d}y_{t-d}+e_{t}"></DL><BR><DT>TR
<DD>intercept and deterministic time trend case.
The test statistic <I>x</I> is assumed to be computed from 
the regression model

<DL CLASS="equation"><DD><IMG WIDTH="207" HEIGHT="71"
 SRC="images/maceq46.gif"
 ALT="y_{t} = {\alpha}_{0}+{\gamma} t+{\alpha}_{1}y_{t-1}+e_{t}"></DL></DL><BR>The first character of the <I>type</I> value specifies whether 
the regression test statistic or the studentized test statistic is used.
Let <IMG WIDTH="23" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq47.gif"
 ALT="{\hat{{\alpha}}_{d}}"> be the estimated
regression coefficient for the <I>d</I>th lag of the series,
and let <IMG WIDTH="29" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq48.gif"
 ALT="{\rm{se}_{\hat{{\alpha}}}}"> be the standard error of
<IMG WIDTH="23" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq47.gif"
 ALT="{\hat{{\alpha}}_{d}}">.The meaning of the first character of the <I>type</I> value is as follows.
<BR><BR><DL>
<DT>R
<DD>the regression coefficient-based test statistic.
The test statistic is 

<DL CLASS="equation"><DD><IMG WIDTH="109" HEIGHT="74"
 SRC="images/maceq49.gif"
 ALT="x = n(\hat{{\alpha}}_{d}-1)"></DL><BR><DT>S
<DD>the studentized test statistic.
The test statistic is

<DL CLASS="equation"><DD><IMG WIDTH="103" HEIGHT="97"
 SRC="images/maceq50.gif"
 ALT="x = \frac{(\hat{{\alpha}}_{d}-1)}{\rm{se}_{\hat{{\alpha}}}}"></DL></DL>
<P>Refer to Dickey and Fuller (1979) and Dickey, Hasza, and Fuller (1984)
for more information about the Dickey-Fuller test null distribution.
The preceding formulas are for the basic Dickey-Fuller test.
The PROBDF function can also be used for the 
augmented Dickey-Fuller test, in which the error term <SPAN CLASS="mathfont"><I>e</I><SUB><I>t</I></SUB></SPAN>
is modeled as an autoregressive process; however,
the test statistic is computed somewhat differently 
for the augmented Dickey-Fuller test.
Refer to Dickey, Hasza, and Fuller (1984) and Hamilton (1994) 
for information about seasonal and nonseasonal augmented Dickey-Fuller tests.
<P>The PROBDF function is calculated from approximating functions fit 
to empirical quantiles produced by Monte Carlo simulation 
employing <SPAN CLASS="mathfont">10<SUP>8</SUP></SPAN> replications for each simulation.
Separate simulations were performed for selected values of <I>n</I>
and for <SPAN CLASS="mathfont"><I>d</I>=1,2,4,6,12</SPAN>.
<P>The maximum error of the PROBDF function is approximately 
<IMG WIDTH="55" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="images/maceq51.gif"
 ALT="{{+-}10^{-3}}"> for <I>d</I> in the set (1,2,4,6,12)
and may be slightly larger for other <I>d</I> values.
(Because the number of simulation replications used to produce 
the PROBDF function is much greater than the 60,000 replications used by
Dickey and Fuller (1979) and Dickey, Hasza, and Fuller (1984),
the PROBDF function can be expected to produce results that are
substantially more accurate than the critical values reported in 
those papers.)
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect24.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect26.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
