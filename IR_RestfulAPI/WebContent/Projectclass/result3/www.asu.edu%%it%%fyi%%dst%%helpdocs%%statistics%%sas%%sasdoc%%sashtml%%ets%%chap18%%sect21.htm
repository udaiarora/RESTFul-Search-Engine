<HTML>
<HEAD>
<TITLE>Relation of ARMA and State Space Forms</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect20.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect22.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The STATESPACE Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Relation of ARMA and State Space Forms  </H2>
<P><A NAME="idxsta0109">&#13;</A><A NAME="idxsta0108">&#13;</A>Every state space model has an ARMA representation,
and conversely every ARMA model has a state space representation.
This section discusses this equivalence.
The following material is adapted from Akaike (1974),
where there is a more complete discussion.
Pham-Dinh-Tuan (1978) also contains a discussion of this material.
<P>Suppose you are given the following ARMA model:
<P>
<DL CLASS="equation"><DD><IMG WIDTH="143" HEIGHT="74"
 SRC="images/staeq85.gif"
 ALT="{\Phi}(B)x_{t}={\Theta}(B)e_{t}"></DL>
<P>or, in more detail
<P><TABLE COLS=2 RULES=GROUPS CELLPADDING=5 CELLSPACING=0 BORDER=0><COL ALIGN=JUSTIFY><COL ALIGN=RIGHT>
<TR VALIGN="TOP"><TD><IMG WIDTH="467" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq86.gif"
 ALT="x_{t}-{\Phi}_{1}x_{t-1}-
 { ... }-{\Phi}_{p}x_{t-p}
 = e_{t}+{\Theta}_{1}e_{t-1}+
 { ... }+{\Theta}_{q}e_{t-q}"></TD><TD ALIGN=RIGHT NOWRAP>(1)</TD></TR>
</TABLE>
<P>where <SPAN CLASS="mathfont"><b>e</b><sub><I>t</I></sub></SPAN> is a sequence of independent multivariate
normal random vectors with mean <B>0</B> and variance matrix
<IMG WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq53.gif"
 ALT="{{\Sigma}_{ee}}">;B is the backshift operator
(<SPAN CLASS="mathfont"><I>B</I><b>x</b><sub><I>t</I></sub> = <b>x</b><sub><I>t</I>-1</sub></SPAN>);
<IMG WIDTH="47" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq87.gif"
 ALT="{{\Phi}(B)}"> and <IMG WIDTH="49" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq88.gif"
 ALT="{{\Theta}(B)}"> are matrix polynomials in B;
and <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN> is the observed process.
<P>If the roots of the determinantial equation <IMG WIDTH="91" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq89.gif"
 ALT="{{|{\Phi}(B)|} = 0}">are outside the unit circle in the complex plane,
the model can also be written as
<P>
<DL CLASS="equation"><DD><IMG WIDTH="269" HEIGHT="110"
 SRC="images/staeq90.gif"
 ALT="x_{t}
 = {\Phi}^{-1}(B){\Theta}(B)e_{t}
 = \sum_{i=0}^{{\infty}}{{\Psi}_{i}e_{t-i}
 }"></DL>
<P>The <IMG WIDTH="25" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq91.gif"
 ALT="{{\Psi}_{i}}"> matrices are known as the impulse response
matrices and can be computed as <IMG WIDTH="111" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq92.gif"
 ALT="{{\Phi}^{-1}(B){\Theta}(B)}">.<A NAME="idxsta0111">&#13;</A><A NAME="idxsta0110">&#13;</A>You can assume <SPAN CLASS="mathfont"><I>p</I>&#62;<I>q</I></SPAN> since, if this is not initially true,
you can add more terms <IMG WIDTH="24" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq93.gif"
 ALT="{{\Phi}_{i}}">that are identically 0 without changing the model.
<P>To write this set of equations in a state space form, proceed as follows.
Let <IMG WIDTH="45" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq94.gif"
 ALT="{x_{t+i| t}}"> be the conditional expectation of
<SPAN CLASS="mathfont"><b>x</b><sub><I>t</I>+<I>i</I></sub></SPAN> given <SPAN CLASS="mathfont"><b>x</b><sub><I>w</I></sub></SPAN> for <IMG WIDTH="38" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq95.gif"
 ALT="{w {\leq} t}">.The following relations hold:
<P>
<DL CLASS="equation"><DD><IMG WIDTH="166" HEIGHT="112"
 SRC="images/staeq96.gif"
 ALT="x_{t+i| t}
 = \sum_{j=i}^{{\infty}}{{\Psi}_{j}e_{t+i-j}
 }"></DL>

<DL CLASS="equation"><DD><IMG WIDTH="218" HEIGHT="75"
 SRC="images/staeq97.gif"
 ALT="x_{t+i| t+1} = x_{t+i| t}+{\Psi}_{i-1}e_{t+1}"></DL>
<P>However, from equation (1) you can derive the following relationship:
<P><TABLE COLS=2 RULES=GROUPS CELLPADDING=5 CELLSPACING=0 BORDER=0><COL ALIGN=JUSTIFY><COL ALIGN=RIGHT>
<TR VALIGN="TOP"><TD><IMG WIDTH="262" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq98.gif"
 ALT="x_{t+p| t}
 = {\Phi}_{1}x_{t+p-1| t}+{ ... }+{\Phi}_{p}x_{t}"></TD><TD ALIGN=RIGHT NOWRAP>(2)</TD></TR>
</TABLE>
<P>Hence, when <SPAN CLASS="mathfont"><I>i</I>=<I>p</I></SPAN>, you can substitute for <IMG WIDTH="47" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq46.gif"
 ALT="{x_{t+p| t}}">in the right-hand side of equation (2) and close the system of equations.
<P>This substitution results in the following model in
the state space form
<SPAN CLASS="mathfont"><b>z</b><sub><I>t</I>+1</sub> = <b>Fz</b><sub><I>t</I></sub>+<b>Ge</b><sub><I>t</I>+1</sub></SPAN>:
<P>
<DL CLASS="equation"><DD><IMG WIDTH="555" HEIGHT="154"
 SRC="images/staeq99.gif"
 ALT="[\matrix{
 x_{t+1} \cr x_{t+2| t+1} \cr {\vdots} \cr x_{t+p| t+1} }
 ] =
 [\matr...
 ...] +
 [\matrix{
 I \cr {\Psi}_{1} \cr {\vdots} \cr {\Psi}_{p-1} \cr
 } ]
 e_{t+1}"></DL>
<P>Note that the state vector <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I></sub></SPAN> is composed of conditional
expectations of <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN> and the first <I>r</I> components
of <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I></sub></SPAN> are equal to <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN>.
<P>The state space form can be cast into an ARMA form by solving the
system of difference equations for the first <I>r</I> components.
<P>When converting from an ARMA form to a state space form,
you can generate a state vector larger than needed;
that is, the state space model may not be a minimal representation.
When going from a state space form to an ARMA form, you can have
nontrivial common factors in the autoregressive and moving average operators
that yield an ARMA model larger than necessary.
<P>If the state space form used is not a minimal representation,
some but not all components of <IMG WIDTH="45" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq94.gif"
 ALT="{x_{t+i| t}}">may be linearly dependent.
This situation corresponds to
<IMG WIDTH="79" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq100.gif"
 ALT="{[{\Phi}_{p} {\Theta}_{p-1} ] }">being of less than full rank when
<IMG WIDTH="47" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq87.gif"
 ALT="{{\Phi}(B)}"> and <IMG WIDTH="49" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq88.gif"
 ALT="{{\Theta}(B)}"> have no common
nontrivial left factors.
In this case, <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I></sub></SPAN> consists of
a subset of the possible components of
<IMG WIDTH="213" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq101.gif"
 ALT="{[x_{t+i| t}]  i=1, 2,{ ... }, p-1. }">However, once a component of <IMG WIDTH="45" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq94.gif"
 ALT="{x_{t+i| t}}">(for example, the <I>j</I>th one)
is linearly dependent on the previous conditional expectations,
then all subsequent <I>j</I>th components of <IMG WIDTH="48" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq2.gif"
 ALT="{x_{t+k| t}}"> for
<SPAN CLASS="mathfont"><I>k</I> &#62; <I>i</I></SPAN> must also be linearly dependent.
Note that in this case, equivalent but seemingly different structures can
arise if the order of the components within <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN> is changed.
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect20.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect22.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
