<HTML>
<HEAD>
<TITLE>The Likelihood Function and Maximum-Likelihood Estimation</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect5.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect7.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Fit Analyses</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>The Likelihood Function and Maximum-Likelihood Estimation  </H2>
<A NAME="idxfit0164">&#13;</A><A NAME="idxfit0163">&#13;</A><A NAME="idxfit0166">&#13;</A><A NAME="idxfit0165">&#13;</A><A NAME="idxfit0168">&#13;</A><A NAME="idxfit0167">&#13;</A><A NAME="idxfit0170">&#13;</A><A NAME="idxfit0169">&#13;</A><A NAME="idxfit0172">&#13;</A><A NAME="idxfit0171">&#13;</A><A NAME="idxfit0174">&#13;</A><A NAME="idxfit0173">&#13;</A>The log-likelihood function

<DL CLASS="equation"><DD><IMG WIDTH="358" HEIGHT="99"
 SRC="images/fiteq57.gif"
 ALT="l(\theta , \phi ; y) = \log f(y ; \theta, \phi) =
 \frac{y \theta-b(\theta)}{a(\phi)} + c(y , \phi)"></DL>
can be expressed in terms of the mean <IMG WIDTH="14" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq18.gif"
 ALT="\mu">and the dispersion parameter <IMG WIDTH="14" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq23.gif"
 ALT="\phi">:<A NAME="idxfit0175">&#13;</A><A NAME="idxfit0176">&#13;</A><DL>
<DT><SPAN CLASS="ssbeleven"><B>Normal</B></SPAN>
<DD><IMG WIDTH="412" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq58.gif"
 ALT="{l(\mu , \phi ; y) = -\frac{1}2 \log(\phi)
-\frac{1}{2\phi} (y-\mu)^2} \hfil {for -\infty\lt y\lt\infty}"><BR><BR>  &#160;&#160;&#160;&#160;&#160;
<BR><BR> <DT><SPAN CLASS="ssbeleven"><B>Inverse Gaussian</B></SPAN>
<DD><IMG WIDTH="336" HEIGHT="46" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq59.gif"
 ALT="{l(\mu , \phi ; y) = - \log( y^3 \phi)
-\frac{(y-\mu)^2}{2 y \mu^2 \phi} }  {for y\gt}"><BR><BR>  &#160;&#160;&#160;&#160;&#160;
<BR><BR> <DT><SPAN CLASS="ssbeleven"><B>Gamma</B></SPAN>
<DD><IMG WIDTH="423" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq60.gif"
 ALT="{l(\mu , \phi ; y) = -\log(y {\Gamma}(\frac{1}{\phi})) +
 \frac{1}{\phi}
 \log(\frac{y}{\mu\phi})
 -\frac{y}{\mu\phi}}  {for y\gt}"><BR><BR>  &#160;&#160;&#160;&#160;&#160;
<BR><BR> <DT><SPAN CLASS="ssbeleven"><B>Poisson</B></SPAN>
<DD><IMG WIDTH="189" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq61.gif"
 ALT="{l(\mu , \phi ; y) = y \log(\mu)-\mu }"> &#160;&#160;for <SPAN CLASS="mathfont"><I>y</I> = 0, 1, 2, ...</SPAN>
<BR><BR>  &#160;&#160;&#160;&#160;&#160;
<BR><BR> <DT><SPAN CLASS="ssbeleven"><B>Binomial</B></SPAN>
<DD><IMG WIDTH="322" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq62.gif"
 ALT="{l(\mu , \phi ; y) = r \log(\mu) + (m-r) \log(1-\mu) }"><BR><BR>for <SPAN CLASS="mathfont"><I>y</I>=<I>r</I>/<I>m</I>, <I>r</I>=0, 1, 2,..., <I>m</I></SPAN>
<BR><BR>  &#160;&#160;&#160;&#160;&#160;
</DL>
<A NAME="idxfit0178">&#13;</A><A NAME="idxfit0177">&#13;</A><A NAME="idxfit0180">&#13;</A><A NAME="idxfit0179">&#13;</A><A NAME="idxfit0182">&#13;</A><A NAME="idxfit0181">&#13;</A><A NAME="idxfit0184">&#13;</A><A NAME="idxfit0183">&#13;</A><A NAME="idxfit0186">&#13;</A><A NAME="idxfit0185">&#13;</A><A NAME="idxfit0188">&#13;</A><A NAME="idxfit0187">&#13;</A><A NAME="idxfit0190">&#13;</A><A NAME="idxfit0189">&#13;</A><A NAME="idxfit0192">&#13;</A><A NAME="idxfit0191">&#13;</A><A NAME="idxfit0194">&#13;</A><A NAME="idxfit0193">&#13;</A><A NAME="idxfit0196">&#13;</A><A NAME="idxfit0195">&#13;</A><BR><BR><TABLE WIDTH="100%" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD ALIGN="CENTER" WIDTH="70"><img width="32" height="32" alt="" src="../../common/images/note.gif"><br>
<font size="-2">Note</font></TD><TD BGCOLOR="#F0F0F0" CLASS="note">Some terms in the density function have been dropped in the log-likelihood
function since they do not affect the
estimation of the mean and scale parameters.</TD></TR></TABLE><BR><BR>SAS/INSIGHT software uses a ridge stabilized
Newton-Raphson algorithm to maximize the
log-likelihood function <I>l</I>(<IMG WIDTH="14" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq18.gif"
 ALT="\mu"> , <IMG WIDTH="14" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq23.gif"
 ALT="\phi"> ; y)
with respect to the regression parameters.
On the <I>r</I>th iteration, the algorithm
updates the parameter vector <B>b</B> by

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>b</b><sub>(<I>r</I>)</sub> = <b>b</b><sub>(<I>r</I>-1)</sub> - <b>H</b><sup>-1</sup><sub>(<I>r</I>-1)</sub> <b>u</b><sub>(<I>r</I>-1)</sub></SPAN>
</DL>
where <B>H</B> is the Hessian matrix and <B>u</B> is
the gradient vector, both evaluated at
<IMG WIDTH="87" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq63.gif"
 ALT="{{\beta}= b_{(r-1)}}">.<A NAME="idxfit0198">&#13;</A><A NAME="idxfit0197">&#13;</A><A NAME="idxfit0200">&#13;</A><A NAME="idxfit0199">&#13;</A>
<DL CLASS="equation"><DD><IMG WIDTH="188" HEIGHT="101"
 SRC="images/fiteq64.gif"
 ALT="H = ( h_{jk} ) =
 ( \frac{\partial^2l}{\partial \beta_{j}
 \partial \beta_{k}} )"></DL>

<DL CLASS="equation"><DD><IMG WIDTH="156" HEIGHT="100"
 SRC="images/fiteq65.gif"
 ALT="u = ( u_{j} ) = ( 
 \frac{\partial l}{\partial \beta_{j} } )."></DL><BR>The Hessian matrix <B>H</B> can be expressed as

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>H</b> = - <b>X</b>' <b>W</b><sub><I>o</I></sub> <b>X</b></SPAN>
</DL>
where <B>X</B> is the design matrix,  <SPAN CLASS="mathfont"><b>W</b><sub><I>o</I></sub></SPAN> is
a diagonal matrix with <SPAN CLASS="mathfont"><I>i</I></SPAN>th diagonal element

<DL CLASS="equation"><DD><IMG WIDTH="267" HEIGHT="100"
 SRC="images/fiteq66.gif"
 ALT="w_{oi} = w_{ei} +
 ( y_{i}- \mu_{i})
 \frac{V_{i}{g_{i}''} +
 {V_{i}'} {g_{i}'}}{V^2_{i}
 ({g_{i}'})^3
 a_{i}(\phi) }"></DL>

<DL CLASS="equation"><DD><IMG WIDTH="223" HEIGHT="98"
 SRC="images/fiteq67.gif"
 ALT="w_{ei} = E( w_{oi}) =
 \frac{1}{a_{i}(\phi) V_{i}
 ({g_{i}'})^2 }"></DL>
where <SPAN CLASS="mathfont"> <I>g</I><SUB><I>i</I></SUB></SPAN> is the link function,
<SPAN CLASS="mathfont"> <I>V</I><SUB><I>i</I></SUB></SPAN> is the variance function,
and the primes denote derivatives of
<SPAN CLASS="mathfont"><I>g</I></SPAN> and <SPAN CLASS="mathfont"><I>V</I></SPAN> with respect to <IMG WIDTH="14" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq18.gif"
 ALT="\mu">.All values are evaluated at the current
mean estimate <IMG WIDTH="20" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq3.gif"
 ALT="{ \mu_{i}}">.<IMG WIDTH="106" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq68.gif"
 ALT="{ a_{i}(\phi) = \phi / w_{i}}">,where <SPAN CLASS="mathfont"> <I>w</I><SUB><I>i</I></SUB></SPAN> is the prior weight
for the <SPAN CLASS="mathfont"><I>i</I></SPAN>th observation.
<BR><BR>SAS/INSIGHT software uses either the full Hessian matrix
<B>H</B> = - <B>X</B>'  <SPAN CLASS="mathfont"><b>W</b><sub><I>o</I></sub></SPAN> <B>X</B>
or the Fisher's scoring method in the
maximum-likelihood estimation.
In the Fisher's scoring method, <SPAN CLASS="mathfont"><b>W</b><sub><I>o</I></sub></SPAN>
is replaced by its expected value <SPAN CLASS="mathfont"><b>W</b><sub><I>e</I></sub></SPAN>
with <SPAN CLASS="mathfont"><I>i</I></SPAN>th element <SPAN CLASS="mathfont"> <I>w</I><SUB><I>ei</I></SUB></SPAN>.
<A NAME="idxfit0202">&#13;</A><A NAME="idxfit0201">&#13;</A>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>H</b> = <b>X</b>' <b>W</b><sub><I>e</I></sub> <b>X</b></SPAN>
</DL><BR>The estimated variance-covariance matrix
of the parameter estimates is

<DL CLASS="equation"><DD><IMG WIDTH="84" HEIGHT="74"
 SRC="images/fiteq69.gif"
 ALT="\hat{{{\Sigma}}} = - H^{-1}"></DL>
where <B>H</B> is the Hessian matrix
evaluated at the model parameter estimates.
<A NAME="idxfit0204">&#13;</A><A NAME="idxfit0203">&#13;</A>The estimated correlation matrix of the parameter
estimates is derived by scaling the estimated
variance-covariance matrix to 1 on the diagonal.
<A NAME="idxfit0206">&#13;</A><A NAME="idxfit0205">&#13;</A><p><TABLE WIDTH="100%" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD ALIGN="CENTER" WIDTH="70"><img width="32" height="32" alt="" src="../../common/images/note.gif"><br>
<font size="-2">Note</font></TD><TD BGCOLOR="#F0F0F0" CLASS="note">A warning message appears when the specified model fails to converge.
The output tables, graphs, and variables are based on the results from the last iteration.</TD></TR></TABLE><p>
<P>
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect5.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect7.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
