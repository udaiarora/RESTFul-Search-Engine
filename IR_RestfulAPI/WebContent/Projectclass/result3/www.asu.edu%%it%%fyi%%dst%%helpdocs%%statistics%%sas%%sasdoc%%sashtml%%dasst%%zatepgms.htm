<HTML>
<!-- This page produced Wed Jun 30 13:31:34 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Using the SQL Editor : Creating Template SQL Programs </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z1084677.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0940440.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="zancedse.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">Doing More with SAS/ASSIST Software                                                                                       </FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="zatepgms">Creating Template SQL Programs</A></FONT></H1>


<P><A name="z1287722">&#13;Many times you might want to begin a new program by using part
of another program. Or, you might want to begin a new program by using the
tools that Query and Reporting offers to create a template program. The following
sections show you how to use these tools to create a template that you can
edit and customize for your purposes.</A>
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5">Using a Stored Query or Statement</FONT></B></TD></TR></TABLE>

<P><A name="z1287723">&#13;You
can include a query that you have previously created in the Query window or include a query or non-SELECT statement that
you previously created in the SQL Editor window.
From the SQL Editor window, select <B>Open</B> from the <B>File</B> menu. The Open window appears with a
list of your saved queries or non-SELECT
statements (of types QUERY and SQL). Type an 


</A><CODE><B>S</B></CODE> (for Select) next to
the query or statement that you want to include.
<P><A name="z1287724">&#13;The Open window has the fields shown
in the following table.    </A>
<P>
<TABLE cellpadding="6" cellspacing="0" border="1">
<CAPTION align="top"><B><I><A name="ztable71">Fields in the Open Window</A></I></B></CAPTION>


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="BOTTOM" ><B>Field</B></TH>
  <TH  align="LEFT" valign="BOTTOM" ><B>Description</B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>Catalog</B></CODE><BR></TD>
  
<TD  align="LEFT" valign="TOP">Specifies the current catalog name. To change it, type
 a two-level name or 


<CODE><B>?</B></CODE> to list all possible catalogs. Then make a selection
from the resulting Select a Member window.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>Name</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">At the top of the display, the <B>Name</B>
field is empty, by default. To search for and limit the listing to certain
entries, type the complete name of an entry, or type a portion of a name with
a pattern-matching character (such as 


<CODE><B>%</B></CODE>
or 


<CODE><B>_</B></CODE>).  For example, specifying 


<CODE><B>JOB%</B></CODE> retrieves all of the
queries that begin with   


<CODE><B>JOB</B></CODE>.  Type 


<CODE><B>%</B></CODE> for a list of all the saved entries.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>Cmd</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">Type 


<CODE><B>S</B></CODE> or an asterisk (


<CODE><B>*</B></CODE>) to select the query or non-SELECT
statement.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>Row</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">Displays the number of queries and non-SELECT statements.
You can edit the value of the starting number to change the number of the
rows displayed.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>Name</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">In the window's listing, <B>Name</B>
displays the names of your queries or non-SELECT statements.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>Description</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">Describes your queries or non-SELECT statements.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>Type</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">Lists whether the entry was saved from the SQL Editor
window (SQL) or from the Query window (QUERY).</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>Date</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">Lists the date when the query or non-SELECT statement
was created or last edited.</TD>
</TR>

</TABLE>

<BR>
<P>You can also sort the contents of the window by <B>Name</B>,
<B>Description</B>, <B>Date</B>, or <B>Type</B> by selecting <B>Sort By</B> from the <B>View</B>
menu.
<P>After you type 


<CODE><B>S</B></CODE> in the <B>Cmd</B> field and press ENTER, the query or non-SELECT statement
is loaded into the SQL Editor window and a message
is displayed to indicate that the query has been loaded. Select <B>Goback</B> to return to the SQL Editor
window.
<P>If you load a query of type QUERY, changes that you
make to your SQL code in the SQL Editor window
are not reflected in the query that you display with the Query window.  However, you can save your changed SQL code, as described
in <A href="zlsaveas.htm">Saving SQL Code or Output</A>.
<P>You can now edit or run your SQL code.  You can edit
it in the SQL Editor window or select <B>Enhanced Editor</B> from the <B>Edit</B> menu.
The Enhanced Editor enables you to make more significant changes to your code.
 See <A href="zancedse.htm">Using the Enhanced SQL Editor</A> for more information.
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5">Selecting Tables with the Select Window</FONT></B></TD></TR></TABLE>

<P><A name="z1287747">&#13;You can use the Query and Reporting
Select
window to include tables in the SQL Editor.  Select <B>Query Manager</B> from the <B>Tools</B> menu to open the
Query and Reporting Select window. Choose one or
more tables and columns, as described in </A><A href="openqm.htm#zab-cols">Selecting Tables and Columns for Queries</A>.
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;Selections made from the Query and Reporting
Select window replace non-SELECT SQL statements in the SQL Editor window and append SQL queries in the SQL Query
window. If you want to append table selections to
non-SELECT SQL code, or want to replace SQL queries, do not use the Query
and Reporting Select window; instead, use the SQL Select Table window as described in the next section.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>
<P>After
you select your columns and select <B>Close</B> from the <B>File</B> menu, you return
automatically to the SQL Editor window.  SQL code
that is based on your selections is displayed in the SQL Editor window.
<P>Under DB2 SQL, if a column name has special or national
characters (such as FLIGHT#), the column automatically appears in quotation
marks.
<P>If relations are defined on the tables, the tables are
joined automatically; a WHERE clause is automatically generated in the SQL
code. If relations are not defined, edit the SQL code to add a WHERE clause
to complete the join.
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5">Choosing Tables with Select Table</FONT></B></TD></TR></TABLE>

<P><A name="z1287752">&#13;Another way to begin a template program is to follow these
instructions:</A>
<OL START="1" type="1">
<LI>Choose <B>Select Table</B>
from the <B>Edit</B> menu. The SQL Select
Table window appears.
<P>
<P>
<B><I>SQL Select Table Window</I></B><BR>

<P><IMG border="0" src="./images/01319302.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>Type the two-level name of a table that
you want
as the basis of your query.<P>

<LI>Select <B>Append</B> to append
the table to the query currently in the SQL Editor
window, or select <B>Replace</B> to replace it.<P>

<LI>Select <B>OK</B>. The SQL
template program appears in the SQL Editor window.
In this example, all the columns are selected from the AIRLINE.DELAY table,
as shown in the following display. Table and column aliases, formats, labels,
and lengths are automatically generated for the table(s) that you include.
<P>
<P>
<B><I>SQL Editor Window With AIRLINE.DELAY Table Selected</I></B><BR>

<P><IMG border="0" src="./images/01319303.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>To join the AIRLINE.DELAY with the
AIRLINE.FLINFO
table, choose <B>Select Table</B> again and type the table
name AIRLINE.FLINFO.  Select <B>Append</B> to append the
two tables. Select <B>OK</B>. If relations are defined
on the tables, a WHERE clause is automatically generated in the SQL code and
the join is complete.<P>
</OL>

<P>In this example, no relations are defined on the AIRLINE.DELAY
and AIRLINE.FLINFO tables.  For a join to work efficiently, it must have a
WHERE (or ON) clause, and so you must edit the SQL code.
<P>You can do minor editing in the SQL Editor window by using the
<B>Edit</B> menu's <B>Insert Line</B> and <B>Delete Line</B> items.
For more substantial editing, use the SQL Enhanced Editor, as described in
the following section.
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;If you decide that you do not want to join AIRLINE.DELAY
with AIRLINE.FLINFO and instead want only AIRLINE.FLINFO, choose <B>Select Table</B> again. Type the name AIRLINE.DELAY and select <B>Replace</B>.  The SQL
template program for the join is then replaced
by a template program for AIRLINE.FLINFO.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z1084677.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0940440.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="zancedse.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#zatepgms">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>