<HTML>
<!-- This page produced Tue Jul 20 10:24:46 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Drag and Drop Component : Using the Drag and Drop Component </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="zrop-doc.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="zropover.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="zopattrs.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">SAS/AF Software: Class Dictionary                                                                                         </FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z1255529">Using the Drag and Drop Component</A></FONT></H1>


<P>All drag and drop methods contain signatures that accept an object as
their only argument. This object is an instance of the Drag and Drop Component,
a container for the standard drag and drop information that is
passed between a drag site and a drop site. The information is stored in the
following attributes of the Drag and Drop component: 
<DL>
<DT>attributeName</DT>
<DD>is the name of the attribute that is passed from
the drag site to the drop site.<P></DD>

<DT>attributeValue</DT>
<DD>is the value of the attribute that is passed from
the drag site. This attribute is a complex attribute whose type is <B><CODE><FONT size="+1">sashelp.classes.type.class</FONT></CODE></B>, which contains the following
attributes:
<TABLE cellpadding="5" cellspacing="0">
<TR align=left valign="top">
<TD>type</TD>
<TD align="left">represents the type of the
attribute value (Character, Numeric, List, Object). Based on the value of <B><CODE><FONT size="+1">type</FONT></CODE></B>, you can query the appropriate "value"
attribute.</TD></TR>

<TR align=left valign="top">
<TD>characterValue</TD>
<TD align="left">stores the character
value if <B><CODE><FONT size="+1">type</FONT></CODE></B> is "Character."</TD></TR>

<TR align=left valign="top">
<TD>listValue</TD>
<TD align="left">stores the SCL list if <B><CODE><FONT size="+1">type</FONT></CODE></B> is "List."</TD></TR>

<TR align=left valign="top">
<TD>numericValue</TD>
<TD align="left">stores the numeric
value if <B><CODE><FONT size="+1">type</FONT></CODE></B> is "Numeric."</TD></TR>

<TR align=left valign="top">
<TD>objectValue</TD>
<TD align="left">stores the object identifier
if <B><CODE><FONT size="+1">type</FONT></CODE></B> is "Object."</TD></TR>
</TABLE>
For example, your method override could contain code as follows:



<PRE>drop: public method
   dndObj:input:object;
   if dndObj.attributeValue.type = 'Character' then
      do;
         /* Retrieve dndObj.attributeValue.characterValue, */
         /* then add any other code                        */
      end;
   else if dndObj.attributeValue.type = 'Numeric' then
       do;
       end;
         /* and so forth... */
endmethod; </PRE><P></DD>

<DT>completeDrag</DT>
<DD>is a character attribute that you can optionally
set to indicate whether a drop can successfully occur. For example, you can
perform validation in an override of the _validateDropData method, and you
can cancel the drop action by setting this attribute to "No".
You can also query this value in an override of the _completeDrag method to
verify whether the drop will actually occur before performing some action
on the drag site.<P></DD>

<DT>dataOperation</DT>
<DD>is the selected drag operation; corresponds to one
of the operations specified in the <B><CODE><FONT size="+1">dragOperations</FONT></CODE></B>
attribute that is set on the drag site.<P></DD>

<DT> dataRepresentation</DT>
<DD>is the form of the data that is passed between sites;
corresponds to the particular list item in the <B><CODE><FONT size="+1">dragInfo</FONT></CODE></B>
attribute that is set on the drag site.<P></DD>

<DT>dragSiteID</DT>
<DD>is the object ID of the drag site.<P></DD>

<DT>dragSiteLocation</DT>
<DD>indicates whether the drag started inside or outside
of the current frame.<P></DD>

<DT>XLocation</DT>
<DD>specifies the <B>x</B> location of the drag
site or drop site.<P></DD>

<DT>YLocation</DT>
<DD>specifies the <B>y</B> location of the drag
site or drop site.<P></DD>
</DL>

<P>For components that are based on the SCOM architecture, the data specified
in the data representation (such as characterData or EXPLORER_MEMBER_NAME)
is stored in the <B><CODE><FONT size="+1">attributeValue</FONT></CODE></B> complex attribute
of the Drag and Drop component. If one item is dragged, then the data is stored
in the <B><CODE><FONT size="+1">characterValue</FONT></CODE></B> attribute of the attributeValue
object. If two or more items are dragged, then the data is stored in the <B><CODE><FONT size="+1">listValue</FONT></CODE></B> attribute as separate character items.

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="zrop-doc.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="zropover.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="zopattrs.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z1255529">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>