<HTML>
<!-- This page produced Mon Jul 19 13:58:41 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Functions and CALL Routines : PROBMC </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0245852.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0245933.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0245934.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">PROBMC</FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z1016947">PROBMC</A></FONT></H1>

<P><HR><BR><B>Computes a probability or a quantile from various distributions
for multiple comparisons of means, and returns a value</B><p>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="right" bgcolor="#F5F5F5" nowrap><B>Category:</B></TD>
<TD bgcolor="#CCCCCC" align="left">Probability
</TD></TR>
</TABLE><HR>
<TABLE cellspacing="0" cellpadding="1">
<TR>
<TD colspan="2"><A href="z1016947.htm#zid-1444"><FONT size="2"><B>Syntax</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z1016947.htm#zid-1445"><FONT size="2"><B>Arguments</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z1016947.htm#z1010223"><FONT size="2"><B>Details</b></FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1016360"><FONT size="2">Formulas and Parameters</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1016362"><FONT size="2">Many-One <I>t</I>-Statistics: Dunnett's One-Sided Test</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1016399"><FONT size="2">Many-One <I>t</I>-Statistics: Dunnett's Two-sided Test</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1016408"><FONT size="2">The Studentized Range</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1016489"><FONT size="2">The Studentized Maximum Modulus</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1016940"><FONT size="2">Williams' Test</FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z1016947.htm#z1020424"><FONT size="2"><B>Comparisons</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z1016947.htm#z1010247"><FONT size="2"><B>Examples</b></FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1017231"><FONT size="2">Example 1: Using PROBMC to Compute Probabilities</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1017235"><FONT size="2">Example 2: Comparing Means</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1017294"><FONT size="2">Example 3: Computing Confidence Intervals</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z1016947.htm#z1017337"><FONT size="2">Example 4: Computing Williams' Test</FONT></A></TD></TR></TABLE>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><H2><A name="zid-1444">Syntax</A></H2></TD></TR></TABLE>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top"><TD>
<B>PROBMC</B>(<I>distribution, q, prob, df, nparms</I>&lt;,
<I>parameters</I>&gt;)
</TD></TR></TABLE>
<BR><H3><A name="zid-1445">Arguments</A></H3>

<P><A name="z1079666">&#13;   
 </A>
<DL>
<DT><B><B><I>distribution</I></B></B></DT>
<DD>is a character string that identifies the
distribution. Valid distributions are
<P>
<TABLE cellpadding="6" cellspacing="0" border="0">


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="TOP" ><B>Distribution</B></TH>
  <TH  align="LEFT" valign="TOP" ><B>Argument</B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">One-sided Dunnett</TD>
  
<TD  align="LEFT" valign="TOP">
<PRE>'DUNNETT1'</PRE></TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">Two-sided Dunnett</TD>
  
<TD  align="LEFT" valign="TOP">
<PRE>'DUNNETT2'</PRE></TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">Maximum Modulus</TD>
  
<TD  align="LEFT" valign="TOP">
<PRE>'MAXMOD'</PRE></TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">Studentized Range</TD>
  
<TD  align="LEFT" valign="TOP">
<PRE>'RANGE'</PRE></TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">Williams</TD>
  
<TD  align="LEFT" valign="TOP">
<PRE>'WILLIAMS'</PRE></TD>
</TR>

</TABLE>

<BR><P></DD>

<DT><B><B><I>q</I></B></B></DT>
<DD>is the quantile from the distribution.
<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Restriction:</B></TD>
<TD align="left" bgcolor="#F5F5F5">Either <I><B>q</B></I>
or <I><B>prob</B></I> can be specified, but not both.</TD>
</TABLE>
<P></DD>

<DT><B><B><I>prob</I></B></B></DT>
<DD>is the left probability from the distribution.
<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Restriction:</B></TD>
<TD align="left" bgcolor="#F5F5F5">Either <I><B>prob</B></I> or <I><B>q</B></I> can be specified, but not
both.</TD>
</TABLE>
<P></DD>

<DT><B><B><I>df</I></B></B></DT>
<DD>is the degrees of freedom.
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;A missing value is interpreted as an infinite
value.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR><P></DD>

<DT><B><B><I>nparms</I></B></B></DT>
<DD>is the number of treatments. 
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;For DUNNETT1 and DUNNETT2, the control group is not
counted.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR><P></DD>

<DT><B><B><I>parameters</I></B></B></DT>
<DD>is an optional set of <I><B>nparms</B></I>
parameters that must be specified to handle the case of unequal sample sizes.
The meaning of <I><B>parameters</B></I> depends on the value of <I><B>distribution</B></I>. If <I><B>parameters</B></I> is not specified, equal sample sizes are
assumed; this is usually the case for a null hypothesis.<P></DD>
</DL>


<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z1010223">Details</A></FONT></B></TD></TR></TABLE>

<P>The PROBMC function
returns the probability or the quantile from various distributions with finite
and infinite degrees of freedom for the the variance estimate.
<P>The <B>prob</B> argument is the probability that
the random variable is less than <B>q</B>. Therefore, <B>p</B>-values
can be computed as 1- <B>prob</B>. For example, to compute the
critical value for a 5% significance level, set <B>prob</B>= 0.95. The
precision of the computed probability is <B>O</B>(10<SUP>--8</SUP>) (absolute error); the precision of computed quantile is
<B>O</B>(10<SUP>--5</SUP>).
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;The studentized range is not computed for finite degrees of freedom and unequal
sample sizes.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;Williams' test is computed
only for equal sample sizes.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>
<BR><H3><A name="z1016360">Formulas and Parameters</A></H3>


<P>The equations listed here define expressions used in equations that relate
the probability, <B>prob</B>, and the quantile, <B>q</B>, for
different distributions and different situations within each distribution.
For these equations, let <IMG border="0" src="../common/images/nulc.gif" alt="[nu]"> be the degrees of freedom, <B>df</B>.
<P>
<P><IMG border="0" src="./images/deqn105.gif" vspace="12" alt="[IMAGE]">
<P>


<P>
<P><IMG border="0" src="./images/deqn106.gif" vspace="12" alt="[IMAGE]">
<P>


<P>
<P><IMG border="0" src="./images/deqn107.gif" vspace="12" alt="[IMAGE]">
<P>
<BR><H3><A name="z1016362">Many-One <I>t</I>-Statistics: Dunnett's One-Sided Test</A></H3>


<P>
<P>
<UL>

<LI><A name="z1079701">&#13;   This case relates
the probability, <B>prob</B>, and the
quantile, <B>q</B>, for the unequal case with finite degrees of freedom.
The <B>parameters</B> are <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>1</SUB>, ..., <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>k</SUB>, the value of <B>nparms</B> is set to <B>k</B>,
and the value of <B>df</B> is set to <B><IMG border="0" src="../common/images/nulc.gif" alt="[nu]"></B>. The equation
follows:</A>
<P>
<P><IMG border="0" src="./images/deqn108.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case with finite
degrees of freedom. No <B>parameters</B> are passed 
<IMG border="0" align="bottom" src="./images/leqn27.gif" alt="[IMAGE]">, the value of <B>nparms</B> is set to <B>k</B>,
and the value of <B>df</B> is set to <B><IMG border="0" src="../common/images/nulc.gif" alt="[nu]"></B>. The equation
follows:
<P>
<P><IMG border="0" src="./images/deqn109.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the unequal case with infinite
degrees of freedom. The <B>parameters</B> are <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>1</SUB>,
..., <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>k</SUB>, the value of <B>nparms</B> is
set to <B>k</B>, and the value of <B>df</B> is set to missing.
The equation follows:
<P>
<P><IMG border="0" src="./images/deqn110.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case with infinite
degrees of freedom. No <B>parameters</B> are passed 
<IMG border="0" align="bottom" src="./images/leqn28.gif" alt="[IMAGE]">, the value of <B>nparms</B> is set to <B>k</B>,
and the value of <B>df</B> is set to missing. The equation follows:
<P>
<P><IMG border="0" src="./images/deqn111.gif" vspace="12" alt="[IMAGE]">
<P>

 <P>
</UL>

<BR><H3><A name="z1016399">Many-One <I>t</I>-Statistics: Dunnett's Two-sided Test</A></H3>


<P>
<P>
<UL>

<LI><A name="z1079706">&#13;   This case relates
the probability, <B>prob</B>, and the
quantile, <B>q</B>, for the unequal case with finite degrees of freedom.
The <B>parameters</B> are <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>1</SUB>, ..., <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>k</SUB>, the value of <B>nparms</B> is set to <B>k</B>,
and the value of <B>df</B> is set to <B><IMG border="0" src="../common/images/nulc.gif" alt="[nu]"></B>. The equation
follows:</A>
<P>
<P><IMG border="0" src="./images/deqn112.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case with finite
degrees of freedom. No <B>parameters</B> are passed, the value of <B>nparms</B> is set to <B>k</B>, and the value of <B>df</B> is
set to <B><IMG border="0" src="../common/images/nulc.gif" alt="[nu]"></B>. The equation follows:
<P>
<P><IMG border="0" src="./images/deqn113.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the unequal case with infinite
degrees of freedom. The <B>parameters</B> are <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>1</SUB>,
..., <IMG border="0" src="../common/images/lambdal.gif" alt="[lambda]"><SUB>k</SUB>, the value of <B>nparms</B> is
set to <B>k</B>, and the value of <B>df</B> is set to missing.
The equation follows:
<P>
<P><IMG border="0" src="./images/deqn114.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case with infinite
degrees of freedom. No <B>parameters</B> are passed, the value of <B>nparms</B> is set to <B>k</B>, and the value of <B>df</B> is
set to missing. The equation follows:
<P>
<P><IMG border="0" src="./images/deqn115.gif" vspace="12" alt="[IMAGE]">
<P>

 <P>
</UL>

<BR><H3><A name="z1016408">The Studentized Range</A></H3>


<P>
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;<A name="z1079711">&#13;
 The studentized range is not computed for finite degrees
of freedom and unequal sample sizes.</A>&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>
<P>
<UL>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case
with finite
degrees of freedom. No <B>parameters</B> are passed, the value of <B>nparms</B> is set to <B>k</B>, and the value of <B>df</B> is
set to <B><IMG border="0" src="../common/images/nulc.gif" alt="[nu]"></B>. The equation follows:
<P>
<P><IMG border="0" src="./images/deqn116.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the unequal case with infinite
degrees of freedom. The <B>parameters</B> are <IMG border="0" src="../common/images/sigmal.gif" alt="[sigma]"><SUB>1</SUB>,
..., <IMG border="0" src="../common/images/sigmal.gif" alt="[sigma]"><SUB>k</SUB>, the value of <B>nparms</B> is
set to <B>k</B>, and the value of <B>df</B> is set to missing.
The equation follows:
<P>
<P><IMG border="0" src="./images/deqn117.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case with infinite
degrees of freedom. No <B>parameters</B> are passed, the value of <B>nparms</B> is set to <B>k</B>, and the value of <B>df</B> is
set to missing. The equation follows:
<P>
<P><IMG border="0" src="./images/deqn118.gif" vspace="12" alt="[IMAGE]">
<P>

 <P>
</UL>

<BR><H3><A name="z1016489">The Studentized Maximum Modulus</A></H3>


<P>
<P>
<UL>

<LI><A name="z1079716">&#13;  This case relates the probability, <B>prob</B>,
and the quantile, <B>q</B>, for the unequal case with finite degrees
of freedom. The <B>parameters</B> are <IMG border="0" src="../common/images/sigmal.gif" alt="[sigma]"><SUB>1</SUB>,
..., <IMG border="0" src="../common/images/sigmal.gif" alt="[sigma]"><SUB>k</SUB>, the value of <B>nparms</B> is
set to <B>k</B>, and the value of <B>df</B> is set to <B><IMG border="0" src="../common/images/nulc.gif" alt="[nu]"></B>. The equation follows:</A>
<P>
<P><IMG border="0" src="./images/deqn119.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case with finite
degrees of freedom. No <B>parameters</B> are passed, the value of <B>nparms</B> is set to <B>k</B>, and the value of <B>df</B> is
set to <B><IMG border="0" src="../common/images/nulc.gif" alt="[nu]"></B>. The equation follows:
<P>
<P><IMG border="0" src="./images/deqn120.gif" vspace="12" alt="[IMAGE]">
<P>

 <P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the unequal case with infinite
degrees of freedom. The <B>parameters</B> are <IMG border="0" src="../common/images/sigmal.gif" alt="[sigma]"><SUB>1</SUB>,
..., <IMG border="0" src="../common/images/sigmal.gif" alt="[sigma]"><SUB>k</SUB>, the value of <B>nparms</B> is
set to <B>k</B>, and the value of <B>df</B> is set to missing.
The equation follows:
<P>
<P><IMG border="0" src="./images/deqn121.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>This case relates the probability, <B>prob</B>, and the quantile, <B>q</B>, for the equal case with infinite
degrees of freedom. No <B>parameters</B> are passed, the value of <B>nparms</B> is set to <B>k</B>, and the value of <B>df</B> is
set to missing. The equation follows:
<P>
<P><IMG border="0" src="./images/deqn122.gif" vspace="12" alt="[IMAGE]">
<P>

 <P>
</UL>

<BR><H3><A name="z1016940">Williams' Test</A></H3>


<P><A name="z1079720">&#13;  PROBMC computes the probabilities
or quantiles from the distribution defined in Williams (1971, 1972) (See </A><A href="z1019314.htm">References</A>). It arises
when you compare the dose treatment means with a control mean to determine
the lowest effective dose of treatment.
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;Williams' Test is computed only for equal sample
sizes.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>
<P>Let <B>X</B><SUB>1</SUB>, <B>X</B><SUB>2</SUB>, ..., <B>X</B><SUB><B>k</B></SUB>
be identical independent N(0,1) random variables. Let <B>Y</B><SUB><B>k</B></SUB> denote their average given by 
<P>
<P><IMG border="0" src="./images/deqn123.gif" vspace="12" alt="[IMAGE]">
<P>
<P>It is required to compute the distribution of 
<P>
<P><IMG border="0" src="./images/deqn124.gif" vspace="12" alt="[IMAGE]">
<P>

where
<TABLE cellpadding="5" cellspacing="0">
<TR align=left valign="top">
<TD><B>Y</B><SUB><B>k</B></SUB></TD>
<TD align="left">is as defined previously</TD></TR>

<TR align=left valign="top">
<TD><B>Z</B></TD>
<TD align="left">is a N(0,1) independent random variable</TD></TR>

<TR align=left valign="top">
<TD><B>S</B></TD>
<TD align="left">is such that &frac12;<IMG border="0" src="../common/images/nulc.gif" alt="[nu]">S<SUP>2</SUP> is a <IMG border="0" src="../common/images/chil.gif" alt="[chi]"><SUP>2</SUP> variable with <IMG border="0" src="../common/images/nulc.gif" alt="[nu]">
degrees of freedom.</TD></TR>
</TABLE>

<P>As described in Williams (1971) (See <A href="z1019314.htm">References</A>), the full
computation
is extremely lengthy and is carried out in three stages. 
<OL START="1" type="1">
<LI>Compute the distribution of <B>Y<SUB>k</SUB></B>. It is the fundamental (expensive)
part of this operation
and it can be used to find both the density and the probability of <B>Y<SUB>k</SUB></B>. Let <B>U<SUB>i</SUB></B>
be defined as 
<P>
<P><IMG border="0" src="./images/deqn125.gif" vspace="12" alt="[IMAGE]">
<P>

You can write a recursive expression for the probability
of <B>Y<SUB>k</SUB></B> > <B>d</B>, with <B>d</B>
being any real number.
<P>
<P><IMG border="0" src="./images/deqn126.gif" vspace="12" alt="[IMAGE]">
<P>

To compute this probability, start from a N(0,1) density
function 
<P>
<P><IMG border="0" src="./images/deqn127.gif" vspace="12" alt="[IMAGE]">
<P>

and recursively compute the  convolution
<P>
<P><IMG border="0" src="./images/deqn128.gif" vspace="12" alt="[IMAGE]">
<P>

From this sequential convolution, it is possible to compute
all the elements of the recursive equation for 
<IMG border="0" align="bottom" src="./images/leqn29.gif" alt="[IMAGE]">,  shown previously.<P>

<LI>Compute the distribution of
<B>Y<SUB>k</SUB> - Z</B>. This involves another convolution to compute
the probability
<P>
<P><IMG border="0" src="./images/deqn129.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>Compute the distribution of <B>(Y<SUB>k</SUB> - Z)/S</B>. This involves another convolution to compute
the probability
<P>
<P><IMG border="0" src="./images/deqn130.gif" vspace="12" alt="[IMAGE]">
<P>

 <P>
</OL>

<P>The third stage is not needed when <IMG border="0" src="../common/images/nulc.gif" alt="[nu]"> = &infin;. Due
to the complexity of the operations, this lengthy algorithm is replaced by
a much faster one when <B>k</B> <IMG border="0" src="../common/images/le.gif" alt="[le]"> 15 for both finite and infinite
degrees of freedom <IMG border="0" src="../common/images/nulc.gif" alt="[nu]">. For <B>k</B> <IMG border="0" src="../common/images/ge.gif" alt="[ge]"> 16, the lengthy computation
is carried out. It is extremely expensive and very slow due to the complexity
of the algorithm.
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z1020424">Comparisons</A></FONT></B></TD></TR></TABLE>

<P>The MEANS statement in the GLM Procedure
of SAS/STAT Software computes the following tests:
<P>
<UL>

<LI>Dunnett's one-sided test<P>

<LI>Dunnett's two-sided
test<P>

<LI>Studentized Range.<P>
</UL>

<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z1010247">Examples</A></FONT></B></TD></TR></TABLE>

<BR><H3> <A name="z1017231">Example 1: Using PROBMC to Compute Probabilities</A> </H3>


<P><A name="z1079738">&#13;
  This
example shows how to use PROBMC in a DO loop to compute
probabilities:


</A>
<PRE>data probs;
   array par{5};
      par{1}=.5;
      par{2}=.51;
      par{3}=.55;
      par{4}=.45;
      par{5}=.2;
   df=40;
   q=1;
   do test="dunnett1","dunnett2", "maxmod";
      prob=probmc(test, q, ., df, 5, of par1-par5);
      put test $10. df q e18.13 prob e18.13;
   end;
run; </PRE><A href="#z1017292">Probabilities from PROBMC</A>
shows the results of this DATA step that are printed to the SAS log.

<P>
<B><I><A name="z1017292">Probabilities from PROBMC</A></I></B><BR>



<TABLE border="1" cellpadding="12" cellspacing="0" bgcolor="#FAFAFA">
<TR>
<TD><PRE>DUNNETT1  40  1.00000000000E+00 4.82992188740E-01
DUNNETT2  40  1.00000000000E+00 1.64023099613E-01
MAXMOD    40  1.00000000000E+00 8.02784203408E-01</PRE></TD></TR></TABLE>

<P>
<BR><H3> <A name="z1017235">Example 2: Comparing Means</A> </H3>


<P>This example
shows how to compare group means to find where the significant differences
lie. The data for this example is taken from a paper by Duncan (1955) (See <A href="z1019314.htm">References</A>) and can
also be found in Hochberg and Tamhane (1987) (See <A href="z1019314.htm">References</A>). The group means are



<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD>49.6</TD></TR>
<TR valign="top"><TD></TD><TD>71.2</TD></TR>
<TR valign="top"><TD></TD><TD>67.6</TD></TR>
<TR valign="top"><TD></TD><TD>61.5</TD></TR>
<TR valign="top"><TD></TD><TD>71.3</TD></TR>
<TR valign="top"><TD></TD><TD>58.1</TD></TR>
<TR valign="top"><TD></TD><TD>61.0</TD></TR></TABLE>For
this data, the mean square error is <B>s</B><SUP>2</SUP> = 79.64 (<B>s</B> = 8.924) with <IMG border="0" src="../common/images/nulc.gif" alt="[nu]"> = 30.



<PRE>data duncan;
   array tr{7}$;
   array mu{7};
   n=7;
   do i=1 to n;
      input tr{i} $1. mu{i};
   end;
   input df s alpha;
   prob= 1-alpha;
      /* compute the interval */
   x = probmc("RANGE", ., prob, df, 7);
   w = x * s / sqrt(6);
      /* compare the means */
   do i = 1 to n;
      do j = i + 1 to n;
         dmean = abs(mu{i} - mu{j});
         if dmean >= w then do;
            put tr{i} tr{j} dmean;
         end;
      end;
   end;
   datalines;
A 49.6
B 71.2
C 67.6
D 61.5
E 71.3
F 58.1
G 61.0
 30 8.924 .05
;</PRE><A href="#z1017289">Group Differences</A>
shows the results of this DATA step that are printed to the SAS log.

<P>
<B><I><A name="z1017289">Group Differences</A></I></B><BR>



<TABLE border="1" cellpadding="12" cellspacing="0" bgcolor="#FAFAFA">
<TR>
<TD><PRE>A B 21.6
A C 18
A E 21.7</PRE></TD></TR></TABLE>

<P>
<BR><H3> <A name="z1017294">Example 3: Computing Confidence Intervals</A> </H3>


<P><A name="z1079747">&#13;
 This example shows how to compute 95% one-sided and two-sided
confidence intervals of Dunnett's test. This example and the data come from
Dunnett (1955) (See </A><A href="z1019314.htm">References</A>)
and can also be found in Hochberg and Tamhane (1987) (See <A href="z1019314.htm">References</A>). The data are blood count
measurements on three groups of animals. As shown in the following table,
the third group serves as the control, while the first two groups were treated
with different drugs. The numbers of animals in these three groups are unequal. 
<P>
<TABLE cellpadding="6" cellspacing="0" border="0">


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="TOP" ><B>Treatment Group:</B></TH>
  <TH  align="LEFT" valign="TOP" ><B>Drug A</B></TH>
  <TH  align="LEFT" valign="TOP" ><B>Drug B</B></TH>
  <TH  align="LEFT" valign="TOP" ><B>Control</B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">9.76</TD>
  
<TD  align="LEFT" valign="TOP">12.80</TD>
  
<TD  align="LEFT" valign="TOP">7.40</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">8.80</TD>
  
<TD  align="LEFT" valign="TOP">9.68</TD>
  
<TD  align="LEFT" valign="TOP">8.50</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">7.68</TD>
  
<TD  align="LEFT" valign="TOP">12.16</TD>
  
<TD  align="LEFT" valign="TOP">7.20</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">9.36</TD>
  
<TD  align="LEFT" valign="TOP">9.20</TD>
  
<TD  align="LEFT" valign="TOP">8.24</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">10.55</TD>
  
<TD  align="LEFT" valign="TOP">9.84</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD ><BR></TD>
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">8.32</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">Group Mean</TD>
  
<TD  align="LEFT" valign="TOP">8.90</TD>
  
<TD  align="LEFT" valign="TOP">10.88</TD>
  
<TD  align="LEFT" valign="TOP">8.25</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">n</TD>
  
<TD  align="LEFT" valign="TOP">4</TD>
  
<TD  align="LEFT" valign="TOP">5</TD>
  
<TD  align="LEFT" valign="TOP">6</TD>
</TR>

</TABLE>

<BR>
<P>The mean square error
<B>s</B><SUP>2</SUP>
= 1.3805 (<B>s</B> = 1.175) with <IMG border="0" src="../common/images/nulc.gif" alt="[nu]"> = 12. 



<PRE>data a;
   array drug{3}$;
   array count{3};
   array mu{3};
   array lambda{2};
   array delta{2};
   array left{2};
   array right{2};

      /* input the table */
   do i = 1 to 3;
      input drug{i} count{i} mu{i};
   end;

      /* input the alpha level,    */
      /* the degrees of freedom,   */
      /* and the mean square error */
   input alpha df s;
   
      /* from the sample size, */
      /* compute the lambdas   */
   do i = 1 to 2;
      lambda{i} = sqrt(count{i}/
        (count{i} + count{3}));
   end;

      /* run the one-sided Dunnett's test */
   test="dunnett1";
      x = probmc(test, ., 1 - alpha, df, 
                 2, of lambda1-lambda2);
      do i = 1 to 2;
         delta{i} = x * s * 
            sqrt(1/count{i} + 1/count{3});
         left{i} = mu{i} - mu{3} - delta{i};
      end;
   put test $10. x left{1} left{2};

      /* run the two-sided Dunnett's test */
   test="dunnett2";
      x = probmc(test, ., 1 - alpha, df, 
                 2, of lambda1-lambda2);
      do i=1 to 2;
         delta{i} = x * s * 
            sqrt(1/count{i} + 1/count{3});
         left{i} = mu{i} - mu{3} - delta{i};
         right{i} = mu{i} - mu{3} + delta{i};
      end;
   put test $10. left{1} right{1};
   put test $10. left{2} right{2};
   datalines;
A 4 8.90
B 5 10.88
C 6 8.25
0.05 12 1.175
;</PRE><A href="#z1017335">Confidence Intervals</A>
shows the results of this DATA step that are printed to the SAS log. 

<P>
<B><I><A name="z1017335">Confidence Intervals</A></I></B><BR>



<TABLE border="1" cellpadding="12" cellspacing="0" bgcolor="#FAFAFA">
<TR>
<TD><PRE>DUNNETT1  2.1210786586 -0.958751705 1.1208571303
DUNNETT2  -1.256411895 2.5564118953
DUNNETT2  0.8416271203 4.4183728797</PRE></TD></TR></TABLE>

<P>
<BR><H3> <A name="z1017337">Example 4: Computing Williams' Test</A> </H3>


<P><A name="z1079776">&#13;

Suppose that a substance has been tested at seven levels in a randomized block
design of eight blocks. The observed treatment means are as follows:</A>
<P>
<TABLE cellpadding="6" cellspacing="0" border="1">


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="TOP" ><B>Treatment</B></TH>
  <TH  align="LEFT" valign="TOP" ><B>Mean</B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">X<SUB>0</SUB></TD>
  
<TD  align="LEFT" valign="TOP">10.4</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">X<SUB>1</SUB></TD>
  
<TD  align="LEFT" valign="TOP">9.9</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">X<SUB>2</SUB></TD>
  
<TD  align="LEFT" valign="TOP">10.0</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">X<SUB>3</SUB></TD>
  
<TD  align="LEFT" valign="TOP">10.6</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">X<SUB>4</SUB></TD>
  
<TD  align="LEFT" valign="TOP">11.4</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">X<SUB>5</SUB></TD>
  
<TD  align="LEFT" valign="TOP">11.9</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">X<SUB>6</SUB></TD>
  
<TD  align="LEFT" valign="TOP">11.7</TD>
</TR>

</TABLE>

<BR>
<P>The mean square, with (7 - 1)(8 - 1) =
42
degrees of freedom, is <B>s</B><SUP>2</SUP> = 1.16.
<P>Determine the maximum likelihood estimates <B>M</B><SUB><B>i</B></SUB>
through the averaging process. 
<P>
<UL>

<LI>Because <B>X</B><SUB>0</SUB>
> <B>X</B><SUB>1</SUB>, form <B>X</B><SUB>0,1</SUB> = (<B>X</B><SUB>0</SUB> + <B>X</B><SUB>1</SUB>)/2 =
10.15.<P>

<LI>Because <B>X</B><SUB>0,1</SUB>
> <B>X</B><SUB>2</SUB>, form <B>X</B><SUB>0,1,2</SUB> = (<B>X</B><SUB>0</SUB> + <B>X</B><SUB>1</SUB> +
<B>X</B><SUB>2</SUB>)/3 = (2<B>X</B><SUB>0,1</SUB> + <B>X</B><SUB>2</SUB>)/3 =
10.1.<P>

<LI><B>X</B><SUB>0,1,2</SUB> &lt; <B>X</B><SUB>3</SUB> &lt; <B>X</B><SUB>4</SUB>
&lt; <B>X</B><SUB>5</SUB><P>

<LI>Because <B>X</B><SUB>5</SUB>
> <B>X</B><SUB>6</SUB>, form <B>X</B><SUB>5,6</SUB> = (<B>X</B><SUB>5</SUB> + <B>X</B><SUB>6</SUB>)/2 =
11.8.<P>
</UL>
Now the order restriction is satisfied. 
<P>The maximum likelihood estimates under the alternative
hypothesis are



<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD><B>M</B><SUB>0</SUB> = <B>M</B><SUB>1</SUB> = <B>M</B><SUB>2</SUB> =
<B>X</B><SUB>0,1,2</SUB> = 10.1</TD></TR>
<TR valign="top"><TD></TD><TD><B>M</B><SUB>3</SUB> = <B>X</B><SUB>3</SUB> =
10.6</TD></TR>
<TR valign="top"><TD></TD><TD><B>M</B><SUB>4</SUB> = <B>X</B><SUB>4</SUB> =
11.4</TD></TR>
<TR valign="top"><TD></TD><TD><B>M</B><SUB>5</SUB> = <B>M</B><SUB>6</SUB> = <B>X</B><SUB>5,6</SUB> =
11.8</TD></TR></TABLE>
<P>Now compute 
<IMG border="0" align="bottom" src="./images/leqn30.gif" alt="[IMAGE]">, and the probability that corresponds to <B>k</B>
= 6, <IMG border="0" src="../common/images/nulc.gif" alt="[nu]"> = 42, and <B>t</B> = 2.60 is .9924467341, which shows strong
evidence that there is a response to the substance. You can also compute the
quantiles for the upper 5% and 1% tails, as shown in the following table.
<P>
<TABLE cellpadding="6" cellspacing="0" border="1">


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="TOP" ><B>SAS Statements</B></TH>
  <TH  align="LEFT" valign="TOP" ><B>Results</B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">
<PRE>prob=probmc("williams",2.6,.,42,6);</PRE>
</TD>
  
<TD  align="LEFT" valign="TOP">0.99244673</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">
<PRE>quant5=probmc("williams",.,.95,42,6);</PRE>
</TD>
  
<TD  align="LEFT" valign="TOP">1.80654052</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP">
<PRE>quant1=probmc("williams",.,.99,42,6);</PRE>
</TD>
  
<TD  align="LEFT" valign="TOP">2.49087829</TD>
</TR>

</TABLE>

<BR>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0245852.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0245933.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0245934.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z1016947">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>