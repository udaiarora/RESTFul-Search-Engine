<HTML>
<HEAD>
<TITLE>Testing for Normality</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect37.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect39.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The MODEL Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Testing for Normality  </H2>
<P><A NAME="idxmod0326">&#13;</A>The NORMAL option on the FIT statement performs multivariate and
univariate tests of normality.
<P><A NAME="idxmod0328">&#13;</A><A NAME="idxmod0327">&#13;</A><A NAME="idxmod0330">&#13;</A><A NAME="idxmod0329">&#13;</A><A NAME="idxmod0331">&#13;</A><A NAME="idxmod0333">&#13;</A><A NAME="idxmod0332">&#13;</A><A NAME="idxmod0334">&#13;</A><A NAME="idxmod0336">&#13;</A><A NAME="idxmod0335">&#13;</A><A NAME="idxmod0337">&#13;</A><A NAME="idxmod0339">&#13;</A><A NAME="idxmod0338">&#13;</A><A NAME="idxmod0340">&#13;</A>The three multivariate tests provided are Mardia's skewness test 
and kurtosis test (Mardia 1980)
and the Henze-Zirkler <IMG WIDTH="36" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq126.gif"
 ALT="{T_{n, {\beta}}}"> test (Henze and Zirkler 1990). 
The two univariate tests provided are the
Shapiro-Wilk W test and the Kolmogorov-Smirnov test.
(For details on the univariate tests, refer to 
&#34;Tests for Normality&#34; in &#34;The UNIVARIATE Procedure&#34; chapter 
in the <I>SAS Procedures Guide</I>.)
The null hypothesis for
all these tests is that the residuals are normally distributed.
<P>For a random sample
<SPAN CLASS="mathfont"><I>X<SUb>1</SUb></I>,  ... , <I>X</I><sub><I>n</I></sub></SPAN>, <IMG WIDTH="58" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq127.gif"
 ALT="{X_{i} {\in} \rm{R}^d}">,where <I>d</I> is the dimension of <SPAN CLASS="mathfont"><I>X</I><SUB><I>i</I></SUB></SPAN> and <I>n</I> is the
number of observations,
a measure of multivariate skewness is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="324" HEIGHT="112"
 SRC="images/modeq128.gif"
 ALT="b_{1,d} = \frac{1}{n^2} \sum_{i=1}^n \sum_{j=1}^n{[ ( X_{i} - {\mu})' S^{-1} 
(X_{j} - {\mu})]^3 }"></DL>
<P>where <B>S</B> is the sample covariance matrix of <B>X</B>.
For weighted regression, both <B>S</B> and <IMG WIDTH="71" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq129.gif"
 ALT="{(X_{i} - {\mu})}"> are 
computed using the weights supplied by the WEIGHT statement 
or the _WEIGHT_ variable.
<P>Mardia showed that under the null hypothesis 
<SPAN CLASS="mathfont">[<I>n</I>/6]<I>b</I><sub>1,<I>d</I></sub></SPAN> is asymptotically distributed as 
<IMG WIDTH="174" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq130.gif"
 ALT="{{\chi}^2( d(d+1)(d+2)/6)}"> .
<P>A measure of multivariate kurtosis is given by
<P>
<DL CLASS="equation"><DD><IMG WIDTH="285" HEIGHT="110"
 SRC="images/modeq131.gif"
 ALT="b_{2,d} = \frac{1}n \sum_{i=1}^n{[( X_{i} - {\mu})^{'} S^{-1} ( X_{i} - {\mu})]^2 }"></DL>
<P>Mardia showed that under the null hypothesis <SPAN CLASS="mathfont"><I>b</I><SUB>2,<I>d</I></SUB></SPAN>is asymptotically normally distributed
with mean <SPAN CLASS="mathfont"><I>d</I>(<I>d</I>+2)</SPAN> and variance <SPAN CLASS="mathfont">8<I>d</I>(<I>d</I>+2)/<I>n</I></SPAN>.
<P>The Henze-Zirkler test is based on a nonnegative functional <SPAN CLASS="mathfont"><I>D</I>(.,.)</SPAN>that measures the distance between two distribution functions
and has the property that
<P>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><I>D</I>(<I>N</I><sub><I>d</I></sub>(0, <I>I</I><sub><I>d</I></sub>), <I>Q</I>) = 0</SPAN>
</DL>
<P>if and only if
<P>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><I>Q</I> = <I>N</I><sub><I>d</I></sub>(0, <I>I</I><sub><I>d</I></sub>)</SPAN>
</DL>
where <IMG WIDTH="81" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq132.gif"
 ALT="{\rm{N}_{d}({\mu}, {\Sigma}_{d}) }"> is a <I>d</I>-dimensional
normal distribution.
<P>The distance measure <SPAN CLASS="mathfont"><I>D</I>(.,.)</SPAN> can be written as
<P>
<DL CLASS="equation"><DD><IMG WIDTH="296" HEIGHT="97"
 SRC="images/modeq133.gif"
 ALT="D_{{\beta}}( P, Q ) = \int_{\rm{R}^d}^{}{| \hat{P}(t) - \hat{Q}(t) |^2 {\varphi}_{{\beta}}(t) dt}"></DL>
<P>where <IMG WIDTH="38" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq134.gif"
 ALT="{\hat{P}(t)}"> and <IMG WIDTH="38" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq135.gif"
 ALT="{\hat{Q}(t)}"> are the Fourier transforms
of P and Q, and <IMG WIDTH="45" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq136.gif"
 ALT="{{\varphi}_{{\beta}}(t)}"> is a weight or a 
kernel function. 
The density of the normal distribution 
<IMG WIDTH="91" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq137.gif"
 ALT="{\rm{N}_{d}(0,{\beta}^2I_{d})}">is used as <IMG WIDTH="45" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq136.gif"
 ALT="{{\varphi}_{{\beta}}(t)}"><P>
<DL CLASS="equation"><DD><IMG WIDTH="300" HEIGHT="99"
 SRC="images/modeq138.gif"
 ALT="{\varphi}_{{\beta}}(t) = ( 2{\pi}{\beta}^2)^{\frac{-d}2} 
\rm{exp} ( \frac{- | t|^2}{2{\beta}^2} ),
\hspace*{1em} t {\in} \rm{R}^d"></DL>
<P>where <SPAN CLASS="mathfont">|<I>t</I>| = (  <I>t<SUP>'</SUP></I> <I>t</I>)<SUP>0.5</SUP></SPAN>.
<P>The parameter <IMG WIDTH="15" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq139.gif"
 ALT="{{\beta}}"> depends on <SPAN CLASS="mathfont"><I>n</I></SPAN> as
<P>
<DL CLASS="equation"><DD><IMG WIDTH="274" HEIGHT="98"
 SRC="images/modeq140.gif"
 ALT="{\beta}_{d}(n) = \frac{1}{\sqrt{2}}( \frac{2d+1}4 )^{1/(d+4)} n^{1/(d+4)}"></DL>
<P>The test statistic computed is called <IMG WIDTH="47" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq141.gif"
 ALT="{T_{{\beta}}(d)}"> and is
approximately distributed as a log normal. The log normal distribution
is used to compute the null hypothesis probability.
<P><DL CLASS="equation"><DD><IMG WIDTH="564" HEIGHT="184" ALIGN="left"
 SRC="images/modeq142.gif"
 ALT="T_{{\beta}}(d) = &\frac{1}{n^2}& \sum_{j=1}^n{\sum_{k=1}^n{{\exp}(- \frac{{\beta...
 ...{\exp}(- \frac{{\beta}^2}{2(1+{\beta}^2)} 
| Y_{j}|^2)}
+ (1+2{\beta}^2)^{-d/2} "><BR CLEAR="ALL">
</DL>
where

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont">|<I>Y</I><SUB><I>j</I></SUB> - <I>Y</I><SUB><I>k</I></SUB>|<SUP>2</SUP> = (<I>X</I><SUB><I>j</I></SUB> - <I>X</I><SUB><I>k</I></SUB>)' <I>S<SUP>-1</SUP></I> 
(<I>X</I><SUB><I>j</I></SUB> - <I>X</I><SUB><I>k</I></SUB>)
</SPAN>
</DL>

<DL CLASS="equation"><DD><IMG WIDTH="242" HEIGHT="77"
 SRC="images/modeq143.gif"
 ALT="| Y_{j}|^2 = (X_{j} - \bar{X})' S^{-1} 
(X_{j} - \bar{X})"></DL>
<P>Monte Carlo simulations
suggest that <IMG WIDTH="47" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/modeq141.gif"
 ALT="{T_{{\beta}}(d)}"> has good power 
against distributions with heavy tails.
<P>The Shapiro-Wilk W test is computed only when the number of 
observations (<I>n</I>) is less than <SPAN CLASS="mathfont">2000</SPAN>.
<P>The following is an example of the output produced by the NORMAL option:
<P><A NAME="modnormal">&#13;</A><CENTER>
         <TABLE BORDER="1" WIDTH="95%" CELLPADDING="10" CELLSPACING="0"
          RULES="GROUPS" FRAME="BOX" BGCOLOR="#F0F0F0" 
          BORDERCOLOR="#000000">
          <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0"><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><A NAME="IDX"></A>
<P>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i> 
<TABLE  border=0 width=100% cellpadding=1 cellspacing=1 rules=NONE frame=VOID>
<TR>
 <TD ALIGN=CENTER><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i>The MODEL Procedure</i></b></font></TD>
</TR>
</TABLE>
<P>
</i></b></font><CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=4 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Normality Test</b></font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Equation</b></font></TD>
 <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Test Statistic</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Value</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Prob</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>y1</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">Shapiro-Wilk W</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.37</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">&lt;.0001</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>y2</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">Shapiro-Wilk W</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.84</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">&lt;.0001</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>System</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">Mardia Skewness</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">286.4</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">&lt;.0001</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>&nbsp;</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">Mardia Kurtosis</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">31.28</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">&lt;.0001</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>&nbsp;</b></font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">Henze-Zirkler T</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">7.09</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">&lt;.0001</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<P>
</TD></TR></TABLE></CENTER><SPAN CLASS="ssften"><B>Figure 14.31:</B> Normality Test Output</SPAN><P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect37.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect39.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
