<HTML>
<HEAD>
<TITLE>Kernel Density</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect23.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect25.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Distribution Analyses</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Kernel Density  </H2>
<A NAME="idxdist0321">&#13;</A><A NAME="idxdist0320">&#13;</A><A NAME="idxdist0323">&#13;</A><A NAME="idxdist0322">&#13;</A><A NAME="idxdist0325">&#13;</A><A NAME="idxdist0324">&#13;</A><A NAME="idxdist0327">&#13;</A><A NAME="idxdist0326">&#13;</A><I>Kernel density estimation</I> provides normal,
triangular, and quadratic kernel density estimators.
The general form of a kernel estimator is

<DL CLASS="equation"><DD><IMG WIDTH="221" HEIGHT="110"
 SRC="images/disteq120.gif"
 ALT="\hat{ f_{\lambda}}(y) =
 \frac{1}{n \lambda}
 \sum_{i=1}^n K_0(\frac{y- y_{i}}{\lambda})"></DL>
where  <SPAN CLASS="mathfont"><I>K<SUB>0</SUB></I></SPAN> is a kernel
function and <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/disteq121.gif"
 ALT="\lambda"> is the bandwidth.
<A NAME="idxdist0329">&#13;</A><A NAME="idxdist0328">&#13;</A><A NAME="idxdist0331">&#13;</A><A NAME="idxdist0330">&#13;</A><A NAME="idxdist0333">&#13;</A><A NAME="idxdist0332">&#13;</A><A NAME="idxdist0335">&#13;</A><A NAME="idxdist0334">&#13;</A><A NAME="idxdist0337">&#13;</A><A NAME="idxdist0336">&#13;</A><A NAME="idxdist0339">&#13;</A><A NAME="idxdist0338">&#13;</A>Some symmetric probability density functions
commonly used as kernel functions are
<P><TABLE COLS=3 BORDER=0><COL><COL ALIGN=JUSTIFY><COL ALIGN=JUSTIFY>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="96" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/disteq122.gif"
 ALT=" \bullet  Normal"></TD><TD><IMG WIDTH="200" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq123.gif"
 ALT="K_0(t) = \frac{1}{\sqrt{2{\pi}}} \exp( - t^2/2 )"></TD><TD>for <IMG WIDTH="109" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq124.gif"
 ALT="-\infty\lt t\lt\infty"></TD></TR>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="123" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq125.gif"
 ALT=" \bullet  Triangular"></TD><TD><IMG WIDTH="152" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq126.gif"
 ALT="K_0(t) = \{ 1 - {| t|}
 \ 0 
 \ ."></TD><TD><IMG WIDTH="96" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq127.gif"
 ALT="  {for | t|\le 1} \  {otherwise} \ "></TD></TR>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="114" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq128.gif"
 ALT=" \bullet  Quadratic"></TD><TD><IMG WIDTH="175" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq129.gif"
 ALT="K_0(t) = \{ \frac{3}4 (1 - t^2)
 \ 0 
 \ ."></TD><TD><IMG WIDTH="96" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq127.gif"
 ALT="  {for | t|\le 1} \  {otherwise} \ "></TD></TR>
</TABLE>
<P><A NAME="idxdist0340">&#13;</A>Both theory and practice suggest that the choice of
a kernel function is not crucial to the statistical
performance of the method (Epanechnikov 1969).
With a specific kernel function, the value of <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/disteq121.gif"
 ALT="\lambda">determines the degree of averaging in the estimate of
the density function and is called a <I>smoothing parameter</I>.
You select a bandwidth <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/disteq121.gif"
 ALT="\lambda"> for each kernel
estimator by specifying <SPAN CLASS="mathfont"><I>c</I></SPAN> in the formula
<A NAME="idxdist0341">&#13;</A>
<DL CLASS="equation"><DD><IMG WIDTH="88" HEIGHT="79"
 SRC="images/disteq130.gif"
 ALT="\lambda = n^{-\frac{1}5} Q c"></DL>
<P>where <SPAN CLASS="mathfont"><I>Q</I></SPAN> is the sample
interquartile range of the <SPAN CLASS="ssbeleven"><B>Y</B></SPAN> variable.
This formulation makes <SPAN CLASS="mathfont"><I>c</I></SPAN>
independent of the units of <SPAN CLASS="ssbeleven"><B>Y</B></SPAN>.
<A NAME="idxdist0343">&#13;</A><A NAME="idxdist0342">&#13;</A><A NAME="idxdist0344">&#13;</A>For a specific kernel function, the discrepancy between
the density estimator <IMG WIDTH="45" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/disteq131.gif"
 ALT="{\hat{ f_{\lambda}}(y)}">and the true density <SPAN CLASS="mathfont"><I>f</I>(<I>y</I>)</SPAN> can be measured by
the mean integrated square error
<P>
<DL CLASS="equation"><DD><IMG WIDTH="426" HEIGHT="100"
 SRC="images/disteq132.gif"
 ALT="\rm{MISE}(\lambda) = \int_{y}^{}{\{E(\hat{ f_{\lambda}}(y))
 - f(y)\}^2dy } +
 \int_{y}^{}{\rm{Var}(\hat{ f_{\lambda}}(y)) \,dy }"></DL>
<P>which is the sum of the integrated
square bias and the integrated variance.
<A NAME="idxdist0345">&#13;</A><A NAME="idxdist0347">&#13;</A><A NAME="idxdist0346">&#13;</A>An approximate mean integrated square
error based on the bandwidth <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/disteq121.gif"
 ALT="\lambda"> is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="490" HEIGHT="100"
 SRC="images/disteq133.gif"
 ALT="\rm{AMISE}(\lambda) =
 \frac{1}4 \lambda^4
 ( \int_{t}^{}{t^2K(t)dt} )^2
 \int_{y}^{}{({f''}(y))^2\,dy }
 + \frac{1}{n\lambda}
 \int_{t}^{}{K(t)^2 dt }"></DL>
<A NAME="idxdist0348">&#13;</A><A NAME="idxdist0350">&#13;</A><A NAME="idxdist0349">&#13;</A><BR>
<P>If <SPAN CLASS="mathfont"><I>f</I>(<I>y</I>)</SPAN> is assumed normal, then a bandwidth based on
the sample mean and variance can be computed to minimize AMISE.
The resulting bandwidth for a specific kernel
is used when the associated kernel function is
selected in the density estimation options dialog.
This is equivalent to choosing <SPAN CLASS="ssbeleven"><B>MISE</B></SPAN> from the
normal, triangular, or quadratic kernel menus. 
If <SPAN CLASS="mathfont"><I>f</I>(<I>y</I>)</SPAN> is not roughly normal,
this choice may not be appropriate.
<A NAME="idxdist0351">&#13;</A>SAS/INSIGHT software divides the range of the data into
128 evenly spaced intervals, then approximates the data
on this grid and uses the fast Fourier transformation
(Silverman 1986) to estimate the density.
<A NAME="idxdist0352">&#13;</A>If you select a <SPAN CLASS="ssbeleven"><B>Weight</B></SPAN> variable, the kernel estimator is
modified to include the individual observation weights.
<P>
<DL CLASS="equation"><DD><IMG WIDTH="275" HEIGHT="110"
 SRC="images/disteq134.gif"
 ALT="\hat{ f_{\lambda}} (y) =
 \frac{1}{\sum_{i}^{}{w_{i}} \lambda }
 \sum_{i=1}^n w_{i} 
 K_0(\frac{y- y_{i}}{\lambda})"></DL>
<P>You can specify the kernel function in the density
estimation options dialog or from the <SPAN CLASS="ssbeleven"><B>Curves</B></SPAN> menu.
When you specify the kernel function in the density
estimation options dialog, <SPAN CLASS="ssbeleven"><B>AMISE</B></SPAN> is used.
After choosing <SPAN CLASS="ssbeleven"><B>Curves:Kernel Density</B></SPAN> from
the menu, you can specify the kernel function and use
either <SPAN CLASS="ssbeleven"><B>AMISE</B></SPAN> or a specified C value
in the <SPAN CLASS="ssbeleven"><B>Kernel Density Estimation</B></SPAN> dialog.
<P><A NAME="kerneldensitydialog">&#13;</A><CENTER><IMG SRC="images/dist25.gif" ALT="dist25.gif (2879 bytes)" HEIGHT="223" WIDTH="323"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 38.25:</B> Kernel Density Dialog</SPAN><P>
<P>The default uses a normal kernel density with
a <SPAN CLASS="mathfont"><I>c</I></SPAN> value that minimizes the AMISE.
<A HREF="sect24.htm#kerneldensityestimation">Figure 38.26</A> displays normal kernel estimates
with <SPAN CLASS="mathfont"><I>c</I></SPAN> = 0.7852 (the AMISE value) and
<SPAN CLASS="mathfont"><I>c</I></SPAN> = 0.25.
Small values of <SPAN CLASS="mathfont"><I>c</I></SPAN> (and hence small values
of the smoothing parameter <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/disteq121.gif"
 ALT="\lambda">) provide jagged estimates
as the curve more closely follows the data points.
Large values of <SPAN CLASS="mathfont"><I>c</I></SPAN> provide smoother estimates.
The <SPAN CLASS="ssbeleven"><B>Mode</B></SPAN> is the point with the largest estimated density.
Use the slider to change the smoothing parameter, <SPAN CLASS="mathfont"><I>c</I></SPAN>.
<P><CENTER><IMG SRC="images/dist26.gif" ALT="dist26.gif (16170 bytes)" HEIGHT="530" WIDTH="810"></CENTER><P><A NAME="kerneldensityestimation">&#13;</A><SPAN CLASS="ssften"><B>Figure 38.26:</B> Kernel Density Estimation</SPAN><P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect23.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect25.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
