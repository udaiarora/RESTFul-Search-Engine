<HTML>
<!-- This page produced Tue Jul  6 11:09:12 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Macros : Stored Compiled Macro Facility </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0606441.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0395269.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0395277.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">SAS Companion for the CMS Environment                                                                                     </FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z0395274">Stored Compiled Macro Facility</A></FONT></H1>


<P><A name="z0595238">&#13;
 The stored compiled macro facility gives you access to permanent
SAS catalogs that contain compiled macros.  The purpose of the stored compiled
macro facility is to improve efficiency in the execution of production jobs.
In order for SAS to use stored compiled macros, the SAS system option MSTORED
must be in effect.  In addition, you use the SAS system option SASMSTORE=
to specify the libref of a SAS data library that contains a catalog of stored
compiled SAS macros.  For more information about these options, see </A><A href="z0395668.htm">System Options in the CMS Environment</A> and  



<B>SAS Language Reference: Dictionary</B>.
<P>Using stored compiled macros offers the following advantages
over other methods of making macros available to your session: 
<P>
<UL>

<LI>SAS does not have to compile a macro definition
when a macro call is made. Therefore, your program may be more efficient.<P>

<LI>Session-compiled macros and the autocall facility
are also available in the same session.<P>
</UL>

<P>Because you cannot re-create the source statements from
a compiled macro, you must save the original macro source statements.
<P>Using the stored compiled macro facility is the most
efficient way to make macros accessible to your SAS session. However, you
can use these approaches: 
<P>
<UL>

<LI>place all macro definitions in the program before
calling them<P>

<LI>use a %INCLUDE statement to bring macro definitions
in the program from external files<P>

<LI>use the autocall facility to search predefined
source libraries for macro definitions.<P>
</UL>

<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5">Accessing Stored Compiled Macros</FONT></B></TD></TR></TABLE>

<P>The following example illustrates how to create a stored
compiled macro in one session and then how to use the macro in a later session.
  

<PRE>/* Create stored compiled macro */
libname mylib 'mylib a';
options mstored sasmstore=mylib;
%macro myfiles / store;
   filename file1 'first mylib a';
   filename file2 'second mylib a';
%mend;

/* Use stored compiled macro later */
libname mylib 'mylib a';
options mstored sasmstore=mylib;

%myfiles
data _null_;
   infile file1;
      ...<I>statements reading input FILE1</I>...
   file file2;
      ...<I>statements writing output FILE2</I>...
run;</PRE>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0606441.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0395269.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0395277.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z0395274">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>