<HTML>
<HEAD>
<TITLE>Ordinary Differential Equations</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect41.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect43.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The MODEL Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Ordinary Differential Equations  </H2>
<P>Ordinary differential
equations (ODEs) are also called <I>initial value problems</I>
because a time zero value for each first-order differential
equation is needed. The following is an example of a
first-order system of ODEs:
<DL CLASS="equation"><DD><IMG WIDTH="170" HEIGHT="160" ALIGN="left"
 SRC="images/modeq175.gif"
 ALT="{y'} &=& -0.1 y + 2.5 z^2 \cr
{z'} &=& -z \cr
y_{0} &=& 0 \cr
z_{0} &=& 1 "><BR CLEAR="ALL">
</DL>
<P>Note that you must provide an initial value for each ODE.
<P>As a reminder, any <I>n</I>-order differential equation can
be modeled as a system of first-order differential equations.
For example, consider the differential equation
<DL CLASS="equation"><DD><IMG WIDTH="127" HEIGHT="140" ALIGN="left"
 SRC="images/modeq176.gif"
 ALT="y^{''} &=& b y^{'} + c y \cr
y_{0} &=& 0 \cr
 y^{'}_{0} &=& 1 "><BR CLEAR="ALL">
</DL>
<P>which can be written as the system of differential equations
<DL CLASS="equation"><DD><IMG WIDTH="125" HEIGHT="160" ALIGN="left"
 SRC="images/modeq177.gif"
 ALT="y^{'} &=& z \cr
z^{'} &=& b y^{'} + c y \cr
y_{0} &=& 0 \cr
z_{0} &=& 1 "><BR CLEAR="ALL">
</DL>
<P>This differential system can be simulated as follows:
<PRE>
      data t;
         time=0; output;
         time=1; output;
         time=2; output;
      run;
   
      proc model data=t ;
         dependent y 0 z 1;
         parm b -2 c -4;
            /* Solve  y''=b y' + c y --------------*/
   
         dert.y = z;
         dert.z = b * dert.y + c * y;
   
         solve y z / dynamic solveprint;
      run;
</PRE>
<P>The preceding statements produce the following output.
These statements produce additional output, which is 
not shown.
<P><CENTER>
         <TABLE BORDER="1" WIDTH="95%" CELLPADDING="10" CELLSPACING="0"
          RULES="GROUPS" FRAME="BOX" BGCOLOR="#F0F0F0" 
          BORDERCOLOR="#000000">
          <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0"><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><A NAME="IDX"></A>
<P>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i> 
<TABLE  border=0 width=100% cellpadding=1 cellspacing=1 rules=NONE frame=VOID>
<TR>
 <TD ALIGN=CENTER><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i>The MODEL Procedure</i></b></font></TD>
</TR>
<TR>
 <TD ALIGN=CENTER><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i>Simultaneous Simulation</i></b></font></TD>
</TR>
</TABLE>
<P>
</i></b></font><CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Observation</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">1</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Missing</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">2</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>CC</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC" nowrap><font  face="Verdana, Helvetica, helv" size="2" color="#000000">-1.000000</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>&nbsp;</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">&nbsp;</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Iterations</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>&nbsp;</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">&nbsp;</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<A NAME="IDX1"></A>
<CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=2 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Solution Values</b></font></TD>
</TR>
<TR>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>y</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>z</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.000000</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">1.000000</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<A NAME="IDX2"></A>
<CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Observation</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">2</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Iterations</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>CC</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.000000</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ERROR.y</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.000000</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<A NAME="IDX3"></A>
<CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=2 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Solution Values</b></font></TD>
</TR>
<TR>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>y</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>z</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.2096398</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">-.2687053</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<A NAME="IDX4"></A>
<CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Observation</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">3</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Iterations</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>CC</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">9.464802</font></TD>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ERROR.y</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC" nowrap><font  face="Verdana, Helvetica, helv" size="2" color="#000000">-0.234405</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<A NAME="IDX5"></A>
<CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=2 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Solution Values</b></font></TD>
</TR>
<TR>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>y</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>z</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">-.0247649</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">-.1035929</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<P>
</TD></TR></TABLE></CENTER><BR><A NAME="idxmod0364">&#13;</A>The differential variables are distinguished by the derivative
with respect to time (DERT.)
prefix. Once you define the DERT. variable, you can use it
on the right-hand side of another equation. The differential equations
must be expressed in normal form; implicit differential
equations are not allowed, and other terms on the left-hand side are
not allowed.
<P>The TIME variable is the <I>implied with respect to</I> variable for
all DERT. variables. The TIME variable is also the only variable
that must be in the input data set.
<P>You can provide initial values for the
differential equations in the data set,  
in the declaration statement (as in the previous example),
or in statements in the code. Using the previous example,
you can specify the initial values as
<PRE>
      proc model data=t ;
         dependent y z ;
         parm b -2 c -4;
            /* Solve  y''=b y' + c y --------------*/
         if ( time=0 ) then 
            do;
               y=0; 
               z=1;
            end;
         else 
            do;
               dert.y = z;
               dert.z = b * dert.y + c * y;
            end;
         end;
         solve y z / dynamic solveprint;
      run;
</PRE>
<P>If you do not provide an initial value, 0 is used.
<P><A NAME="idxmod0366">&#13;</A><A NAME="idxmod0365">&#13;</A><A NAME="idxmod0368">&#13;</A><A NAME="idxmod0367">&#13;</A><A NAME="idxmod0369">&#13;</A><A NAME="idxmod0370">&#13;</A><A NAME="idxmod0371">&#13;</A><A NAME="idxmod0372">&#13;</A><H3><I>DYNAMIC and STATIC Simulation</I></H3>
Note that, in the previous example, the DYNAMIC option was specified
in the SOLVE statement.
The DYNAMIC and STATIC options work the same for differential
equations as they do for dynamic systems. In the
differential equation case, the DYNAMIC option makes the initial
value needed at each observation the computed
value from the previous iteration. For a static simulation,
the data set must contain values for the integrated variables. For
example, if DERT.Y and DERT.Z are the differential variables, 
you must include Y and Z 
in the input data set in order to do a static simulation of the model.
<P>If the simulation is dynamic, the initial values for the 
differential equations are obtained from the data set, if
they are available. If the variable is not in the data set,
you can specify the initial value in a declaration statement. If
you do not specify an initial value, the value of 0.0 is used.
<P>A dynamic solution is obtained
by solving one initial value problem for all the data.
A graph of a simple dynamic simulation is shown in
<A HREF="sect42.htm#modroc2">Figure 14.36</A>. If the time variable for the current observation
is less than the time variable for the previous observation, 
the integration is restarted from this point. This allows for
multiple samples in one data file.
<P>
<P><A NAME="modroc2">&#13;</A><SPAN CLASS="ssften"><B>Figure 14.36:</B> Dynamic Solution </SPAN><P>
<CENTER>
        <TABLE BORDER="1" CELLPADDING="7" CELLSPACING="0" 
         RULES="GROUPS" FRAME="BOX"
         BGCOLOR="#F0F0F0" BORDERCOLOR="#000000">
        <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0">
<IMG SRC="images/moddyn.gif" ALT="moddyn.gif (2359 bytes)" HEIGHT="277" WIDTH="373">
</TD></TR></TABLE></CENTER><BR>In a static solution,
n-1 initial value problems are solved using the first n-1 data
values as initial values.
The equations are integrated
using the <SPAN CLASS="mathfont"><I>i</I></SPAN>th data value as an initial value to the i+1 data
value. <A HREF="sect42.htm#modroc">Figure 14.37</A> displays a static simulation
of noisy data from a simple differential equation. 
The static solution does not propagate errors in initial
values as the dynamic solution does.
<P>
<P><A NAME="modroc">&#13;</A><SPAN CLASS="ssften"><B>Figure 14.37:</B> Static Solution </SPAN><P>
<CENTER>
        <TABLE BORDER="1" CELLPADDING="7" CELLSPACING="0" 
         RULES="GROUPS" FRAME="BOX"
         BGCOLOR="#F0F0F0" BORDERCOLOR="#000000">
        <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0">
<IMG SRC="images/modsta.gif" ALT="modsta.gif (2484 bytes)" HEIGHT="305" WIDTH="406">
</TD></TR></TABLE></CENTER><P>
<P><A NAME="idxmod0373">&#13;</A><A NAME="idxmod0374">&#13;</A>For estimation, the DYNAMIC and STATIC options in the FIT statement
perform the same functions as they do in the SOLVE statement. 
Components of differential systems that have missing values or are
not in the data set are simulated dynamically. For example, often in
multiple compartment kinetic models, only one compartment is monitored.
The differential equations describing the unmonitored compartments are
simulated dynamically.
<P>For estimation, it is important to have
accurate initial values for ODEs that are not in the data set. If
an accurate initial value is not known, the initial value can be
made an unknown parameter and estimated. This allows for errors in 
the initial values but increases the number of parameters to estimate 
by the number of equations.
<P><H3><I>Estimation of Differential Equations</I></H3>
<A NAME="idxmod0376">&#13;</A><A NAME="idxmod0375">&#13;</A><A NAME="idxmod0377">&#13;</A><A NAME="idxmod0379">&#13;</A><A NAME="idxmod0378">&#13;</A>Consider the kinetic model for the accumulation of mercury (Hg) in 
mosquito fish (Matis, Miller, and Allen 1991, p. 177). 
The model for this process is the one-compartment constant 
infusion model shown in <A HREF="sect42.htm#modmkin1">Figure 14.38</A>.
<P>
<CENTER>
        <TABLE BORDER="1" CELLPADDING="7" CELLSPACING="0" 
         RULES="GROUPS" FRAME="BOX"
         BGCOLOR="#F0F0F0" BORDERCOLOR="#000000">
        <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0">
<IMG SRC="images/modkin.gif" ALT="modkin.gif (1493 bytes)" HEIGHT="170" WIDTH="222">
</TD></TR></TABLE></CENTER><P><A NAME="modmkin1">&#13;</A><SPAN CLASS="ssften"><B>Figure 14.38:</B> One-Compartment Constant Infusion Model </SPAN><P>
<P>The differential equation that models this process is
<DL CLASS="equation"><DD><IMG WIDTH="187" HEIGHT="123" ALIGN="left"
 SRC="images/modeq178.gif"
 ALT="\frac{d conc}{d t} &=& k_{u} - k_{e}conc \cr
conc_{0} &=& 0 "><BR CLEAR="ALL">
</DL>
The analytical solution to the model is

<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><I>conc</I> = (<I>k</I><sub><I>u</I></sub>/<I>k</I><sub><I>e</I></sub>)(1-exp(-<I>k</I><sub><I>e</I></sub><I>t</I>))</SPAN>
</DL>
<P>The data for the model are 
<PRE>
      data fish;
         input day conc;
         datalines;
      0.0    0.0
      1.0    0.15
      2.0    0.2
      3.0    0.26
      4.0    0.32
      6.0    0.33
      ;
      run;
</PRE>
<P>To fit this model in differential form, use the following
statements:
<PRE>
      proc model data=fish;
         parm ku ke;
   
         dert.conc = ku - ke * conc;
   
         fit conc / time=day;
      run;
</PRE>
<P>The results from this estimation are shown in <A HREF="sect42.htm#modkinout">Figure 14.39</A>.
<P><A NAME="modkinout">&#13;</A><CENTER>
         <TABLE BORDER="1" WIDTH="95%" CELLPADDING="10" CELLSPACING="0"
          RULES="GROUPS" FRAME="BOX" BGCOLOR="#F0F0F0" 
          BORDERCOLOR="#000000">
          <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0"><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><A NAME="IDX"></A>
<P>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i> 
<TABLE  border=0 width=100% cellpadding=1 cellspacing=1 rules=NONE frame=VOID>
<TR>
 <TD ALIGN=CENTER><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i>The MODEL Procedure</i></b></font></TD>
</TR>
</TABLE>
<P>
</i></b></font><CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=5 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Nonlinear OLS Parameter Estimates </b></font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Parameter</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Estimate</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx Std Err</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>t&nbsp;Value</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx<br> Pr &gt; |t|</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ku</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.180159</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0312</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">5.78</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0044</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ke</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.524661</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.1181</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">4.44</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0113</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<P>
</TD></TR></TABLE></CENTER><SPAN CLASS="ssften"><B>Figure 14.39:</B> Static Estimation Results for Fish Model</SPAN><P>
<P><A NAME="idxmod0380">&#13;</A>To perform a dynamic estimation of the differential equation,
add the DYNAMIC option to the FIT statement.
<PRE>
      proc model data=fish;
         parm ku .3 ke .3;
   
         dert.conc = ku - ke * conc;
   
         fit conc / time = day dynamic;
      run;
</PRE>
<P>The equation DERT.CONC is integrated from <SPAN CLASS="mathfont"><I>conc</I>(0) =0</SPAN>. The results
from this estimation are shown in <A HREF="sect42.htm#modkinout2">Figure 14.40</A>.
<P><A NAME="modkinout2">&#13;</A><CENTER>
         <TABLE BORDER="1" WIDTH="95%" CELLPADDING="10" CELLSPACING="0"
          RULES="GROUPS" FRAME="BOX" BGCOLOR="#F0F0F0" 
          BORDERCOLOR="#000000">
          <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0"><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><A NAME="IDX"></A>
<P>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i> 
<TABLE  border=0 width=100% cellpadding=1 cellspacing=1 rules=NONE frame=VOID>
<TR>
 <TD ALIGN=CENTER><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i>The MODEL Procedure</i></b></font></TD>
</TR>
</TABLE>
<P>
</i></b></font><CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=5 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Nonlinear OLS Parameter Estimates </b></font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Parameter</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Estimate</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx Std Err</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>t&nbsp;Value</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx<br> Pr &gt; |t|</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ku</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.167109</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0170</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">9.84</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0006</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ke</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.469033</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0731</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">6.42</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0030</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<P>
</TD></TR></TABLE></CENTER><SPAN CLASS="ssften"><B>Figure 14.40:</B> Dynamic Estimation Results for Fish Model</SPAN><P>
<P>To perform a dynamic estimation of the differential equation
and estimate the initial value, use the following
statements:
<PRE>
      proc model data=fish;
         parm ku .3 ke .3 conc0 0;
   
         dert.conc = ku - ke * conc;
   
         fit conc initial=(conc = conc0) / time = day dynamic;
      run;
</PRE>
<P><A NAME="idxmod0381">&#13;</A>The INITIAL= option in the FIT statement is used to associate the
initial value of a differential equation with a parameter.
The results from this estimation are shown in <A HREF="sect42.htm#modkinout4">Figure 14.41</A>.
<P><A NAME="modkinout4">&#13;</A><CENTER>
         <TABLE BORDER="1" WIDTH="95%" CELLPADDING="10" CELLSPACING="0"
          RULES="GROUPS" FRAME="BOX" BGCOLOR="#F0F0F0" 
          BORDERCOLOR="#000000">
          <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0"><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><A NAME="IDX"></A>
<P>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i> 
<TABLE  border=0 width=100% cellpadding=1 cellspacing=1 rules=NONE frame=VOID>
<TR>
 <TD ALIGN=CENTER><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i>The MODEL Procedure</i></b></font></TD>
</TR>
</TABLE>
<P>
</i></b></font><CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=5 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Nonlinear OLS Parameter Estimates </b></font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Parameter</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Estimate</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx Std Err</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>t&nbsp;Value</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx<br> Pr &gt; |t|</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ku</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.164408</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0230</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">7.14</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0057</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ke</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.45949</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0943</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">4.87</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0165</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>conc0</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.003798</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0174</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.22</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.8414</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<P>
</TD></TR></TABLE></CENTER><SPAN CLASS="ssften"><B>Figure 14.41:</B> Dynamic Estimation with Initial Value for Fish Model</SPAN><P>
<P>Finally, to estimate the fish model using the analytical solution,
use the following statements:
<PRE>
      proc model data=fish;
         parm ku .3  ke .3;
   
         conc = (ku/ ke)*( 1 -exp(-ke * day));
   
         fit conc;
      run;
</PRE>
<P>The results from this estimation are shown in <A HREF="sect42.htm#modkinout3">Figure 14.42</A>.
<P><A NAME="modkinout3">&#13;</A><CENTER>
         <TABLE BORDER="1" WIDTH="95%" CELLPADDING="10" CELLSPACING="0"
          RULES="GROUPS" FRAME="BOX" BGCOLOR="#F0F0F0" 
          BORDERCOLOR="#000000">
          <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0"><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><A NAME="IDX"></A>
<P>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i> 
<TABLE  border=0 width=100% cellpadding=1 cellspacing=1 rules=NONE frame=VOID>
<TR>
 <TD ALIGN=CENTER><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><b><i>The MODEL Procedure</i></b></font></TD>
</TR>
</TABLE>
<P>
</i></b></font><CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD COLSPAN=5 ALIGN=CENTER VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Nonlinear OLS Parameter Estimates </b></font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Parameter</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Estimate</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx Std Err</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>t&nbsp;Value</b></font></TD>
 <TD ALIGN=RIGHT VALIGN=BOTTOM bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Approx<br> Pr &gt; |t|</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ku</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.167109</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0170</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">9.84</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0006</font></TD>
</TR>
<TR>
 <TD ALIGN=LEFT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>ke</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.469033</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0731</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">6.42</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.0030</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<P>
</TD></TR></TABLE></CENTER><SPAN CLASS="ssften"><B>Figure 14.42:</B> Analytical Estimation Results for Fish Model</SPAN><P>
<P>A comparison of the 
results among the four estimations reveals that the two dynamic estimations
and the analytical estimation give nearly identical results (identical
to the default precision). The two dynamic estimations are
identical because the estimated initial value (0.00013071) is
very close to the initial value used in the first dynamic estimation (0).
Note also that the static model did not require an
initial guess for the parameter values. Static estimation, in general,
is more forgiving of bad initial values.
<P>The form of the estimation that is preferred depends mostly on
the model and data. If a very accurate initial value is known,
then a dynamic estimation makes sense. If, additionally, the model can be 
written analytically, then the analytical estimation is computationally
simpler. If only an approximate initial value is known and
not modeled as an unknown parameter, the static estimation is
less sensitive to errors in the initial value.
<P>The form of the error 
in the model is also an important factor in choosing the form
of the estimation. If the error term is additive and independent
of previous error, then the dynamic mode is appropriate. If, on
the other hand, the errors are cumulative, a static estimation
is more appropriate. See the section &#34;Monte Carlo Simulation&#34; for 
an example.
<P><A NAME="idxmod0383">&#13;</A><A NAME="idxmod0382">&#13;</A><A NAME="idxmod0384">&#13;</A><H3><I>Auxiliary Equations</I></H3>
Auxiliary equations can be used with differential equations.
These are equations that need to be satisfied with the
differential equations at each point between each data value.
They are automatically added to the system, so 
you do not need to specify them in the SOLVE or FIT statement.
<P>Consider the following example.
<P><A NAME="idxmod0385">&#13;</A>The Michaelis-Menten Equations describe the kinetics of an
enzyme-catalyzed reaction. The enzyme is E, and S is called
the <I>substrate</I>. The enzyme first reacts with the substrate
to form the enzyme-substrate complex ES, which then breaks
down in a second step to form enzyme and products P.
<P>The reaction rates are described by the following system of
differential equations:
<P><DL CLASS="equation"><DD><IMG WIDTH="377" HEIGHT="169" ALIGN="left"
 SRC="images/modeq179.gif"
 ALT="\frac{d[{ES}]}{dt} &=& k_{1}([E] - [{ES}])[S] - k_{2}[{ES}] 
- k_{3}[{ES}] \cr
\...
 ...]}{dt} &=& -k_{1}([E] - [{ES}])[S] + k_{2}[{ES}] \cr
[E] &=& [E]_{tot} - [{ES}] "><BR CLEAR="ALL">
</DL>
The first equation describes the rate
of formation of ES from E + S. The rate of formation of
ES from E + P is very small and can be ignored. The enzyme is
in either the complexed or the uncomplexed form. So if the
total (<SPAN CLASS="mathfont">[<I>E</I>]<sub><I>tot</I></sub></SPAN>) concentration of enzyme and the
amount bound to the substrate is known, <SPAN CLASS="mathfont">[<I>E</I>]</SPAN> can be obtained by
conservation.
<P>In this example, the conservation equation is an auxiliary
equation and is coupled with the differential equations
for integration.
<P><A NAME="idxmod0387">&#13;</A><A NAME="idxmod0386">&#13;</A><A NAME="idxmod0388">&#13;</A><A NAME="idxmod0389">&#13;</A><A NAME="idxmod0390">&#13;</A><H3><I>Time Variable</I></H3>
You must provide a time variable in the data set. The name of the
time variable defaults to TIME. You can use other variables 
as the time variable by specifying the TIME= option in the FIT or SOLVE
statement. The time intervals need not be evenly spaced. 
If the time variable for the current observation
is less than the time variable for the previous observation,
the integration is restarted.
<P><A NAME="idxmod0392">&#13;</A><A NAME="idxmod0391">&#13;</A><A NAME="idxmod0394">&#13;</A><A NAME="idxmod0393">&#13;</A><A NAME="idxmod0395">&#13;</A><H3><I>Differential Equations and Goal Seeking</I></H3>
Consider the following differential equation

<DL CLASS="equation"><DD><IMG WIDTH="67" HEIGHT="77"
 SRC="images/modeq180.gif"
 ALT="y^{'} = a {\ast} x "></DL>
<P>and the data set
<PRE>
      data t2;
         y=0; time=0; output;
         y=2; time=1; output;
         y=3; time=2; output;
      run;
</PRE>
<P>The problem is to find values for X that satisfy the differential
equation and the data in the data set. Problems of this kind are
sometimes referred to as <I>goal seeking problems</I> because they require
you to search for values of X that will satisfy the goal of Y.
<P>This problem is solved with the following statements:
<PRE>
      proc model data=t2 ;
         dependent x 0;
         independent y;
         parm a 5;
         dert.y = a * x;
         solve x / out=foo;
      run;
   
      proc print data=foo; run;
</PRE>
<P>The output from the PROC PRINT statement is shown in <A HREF="sect42.htm#moddiff21">Figure 14.43</A>.
<P><A NAME="moddiff21">&#13;</A><CENTER>
         <TABLE BORDER="1" WIDTH="95%" CELLPADDING="10" CELLSPACING="0"
          RULES="GROUPS" FRAME="BOX" BGCOLOR="#F0F0F0" 
          BORDERCOLOR="#000000">
          <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0"><font  face="Verdana, Helvetica, helv" size="2" color="#003399"><A NAME="IDX"></A>
<P>
<CENTER>
<font  face="Verdana, Helvetica, helv" size="2" color="#003399"> 
<TABLE  border=1 cellpadding=7 cellspacing=1 rules=GROUPS frame=BOX bordercolor="#000000">
<thead>
<TR>
 <TD ALIGN=CENTER bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>Obs</b></font></TD>
 <TD ALIGN=CENTER bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>_TYPE_</b></font></TD>
 <TD ALIGN=CENTER bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>_MODE_</b></font></TD>
 <TD ALIGN=CENTER bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>_ERRORS_</b></font></TD>
 <TD ALIGN=CENTER bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>x</b></font></TD>
 <TD ALIGN=CENTER bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>y</b></font></TD>
 <TD ALIGN=RIGHT bgcolor="#AAAAAA"><font  face="Verdana, Helvetica, helv" size="2" color="#0033AA"><b>time</b></font></TD>
</TR>
</thead>
<tbody>
<TR>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">1</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">PREDICT</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">SIMULATE</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000"> 0.00000</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0.00000</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0</font></TD>
</TR>
<TR>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">2</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">PREDICT</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">SIMULATE</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000"> 0.80000</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">2.00000</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">1</font></TD>
</TR>
<TR>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">3</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">PREDICT</font></TD>
 <TD ALIGN=LEFT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">SIMULATE</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">0</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC" nowrap><font  face="Verdana, Helvetica, helv" size="2" color="#000000">-0.40000</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">3.00000</font></TD>
 <TD ALIGN=RIGHT bgcolor="#CCCCCC"><font  face="Verdana, Helvetica, helv" size="2" color="#000000">2</font></TD>
</TR>
</tbody>
</TABLE>
<P>
</font></CENTER>
<P>
</TD></TR></TABLE></CENTER><SPAN CLASS="ssften"><B>Figure 14.43:</B> Dynamic Solution</SPAN><P>
<P>Note that an initial value of 0 is provided for the X variable
because it is undetermined at TIME = 0.
<P>In the preceding goal seeking example, X is treated as a linear function
between each set of data points (see <A HREF="sect42.htm#modfxuig">Figure 14.44</A>).
<P>
<CENTER>
        <TABLE BORDER="1" CELLPADDING="7" CELLSPACING="0" 
         RULES="GROUPS" FRAME="BOX"
         BGCOLOR="#F0F0F0" BORDERCOLOR="#000000">
        <TR><TD ALIGN="CENTER" VALIGN="MIDDLE" BGCOLOR="#F0F0F0">
<IMG SRC="images/modint.gif" ALT="modint.gif (1769 bytes)" HEIGHT="238" WIDTH="270">
</TD></TR></TABLE></CENTER><P><A NAME="modfxuig">&#13;</A><SPAN CLASS="ssften"><B>Figure 14.44:</B> Form of X Used for Integration in Goal Seeking </SPAN><P>
<P>If you integrate <SPAN CLASS="mathfont"><I>y<SUP>'</SUP></I>=<I>ax</I></SPAN> manually, you have
<P><DL CLASS="equation"><DD><IMG WIDTH="408" HEIGHT="204" ALIGN="left"
 SRC="images/modeq181.gif"
 ALT="x(t) &=& \frac{t_{f} - t}{t_{f} -t_{0}}
x_{0} + \frac{- T_{0}}{t_{f} -t_{0}}x_{f...
 ...f}x_{0} - 
t_{0} x_{f}) + \frac{1}2 t^2 ( x_{f} - x_{0})) {|}^{{t_{f}}}_{t_{0}} "><BR CLEAR="ALL">
</DL>
<P>For observation 2, this reduces to
<DL CLASS="equation"><DD><IMG WIDTH="105" HEIGHT="125" ALIGN="left"
 SRC="images/modeq182.gif"
 ALT="y &=& \frac{1}2 a {\ast} x_{f} \cr
2 &=& 2.5 {\ast} x_{f} "><BR CLEAR="ALL">
</DL>
So <SPAN CLASS="mathfont"><I>x</I> = 0.8</SPAN> for this observation.
<P>Goal seeking for the TIME variable is not allowed.
<BR>
<P>
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect41.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect43.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
