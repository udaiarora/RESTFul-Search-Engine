<HTML>
<HEAD>
<TITLE>Anscombe Residuals</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect56.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect58.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Fit Analyses</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Anscombe Residuals  </H2>
<A NAME="idxfit0805">&#13;</A><A NAME="idxfit0804">&#13;</A><A NAME="idxfit0807">&#13;</A><A NAME="idxfit0806">&#13;</A>For nonnormal response distributions in
generalized linear models, the distribution
of the Pearson residuals is often skewed.
Anscombe proposed a residual using a function
<SPAN CLASS="mathfont"><I>A</I>(<I>y</I>)</SPAN> in place of <I>y</I> in the residual
derivation (Anscombe 1953, McCullagh and Nelder 1989).
The function <SPAN CLASS="mathfont"><I>A</I>(<I>y</I>)</SPAN> is chosen to make the distribution
of <SPAN CLASS="mathfont"><I>A</I>(<I>y</I>)</SPAN> as normal as possible and is given by

<DL CLASS="equation"><DD><IMG WIDTH="184" HEIGHT="99"
 SRC="images/fiteq249.gif"
 ALT="A(\mu) = \int_{-{\infty}}^{\mu}{V^{-1/3}(t) dt }"></DL>
where <SPAN CLASS="mathfont"><I>V</I>(<I>t</I>)</SPAN> is the variance function.
<P>For a binomial distribution with  <SPAN CLASS="mathfont"><I>m</I><sub><I>i</I></sub></SPAN>
trials in the <SPAN CLASS="mathfont"><I>i</I></SPAN>th observation,
the <I>Anscombe residual</I> is defined as

<DL CLASS="equation"><DD><IMG WIDTH="201" HEIGHT="102"
 SRC="images/fiteq250.gif"
 ALT="r_{Ai} = \sqrt{ m_{i}}
 \frac{A( y_{i})
 -A(\hat{ \mu_{i}})}{{A'}(\hat{ \mu_{i}})
 \sqrt{V(\hat{ \mu_{i}})}}"></DL>
<P>For other distributions, the Anscombe residual is defined as

<DL CLASS="equation"><DD><IMG WIDTH="164" HEIGHT="102"
 SRC="images/fiteq251.gif"
 ALT="r_{Ai} = \frac{A( y_{i})
 -A(\hat{ \mu_{i}})}{{A'}(\hat{ \mu_{i}})
 \sqrt{V(\hat{ \mu_{i}})} }"></DL>
where <IMG WIDTH="47" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq252.gif"
 ALT="{{A'}(\mu)}"> is the derivative of <IMG WIDTH="42" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq253.gif"
 ALT="{A(\mu)}">.<P>
<P>For the response distributions used in the fit analysis,
Anscombe residuals are
<P><DL>
<DT><SPAN CLASS="ssbeleven"><B>Normal</B></SPAN>
<DD><IMG WIDTH="105" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq254.gif"
 ALT="{ r_{Ai} = y_{i}-\hat{ \mu_{i}} }"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
<BR><BR>  <DT><SPAN CLASS="ssbeleven"><B>Inverse Gaussian</B></SPAN>
<DD><IMG WIDTH="242" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq255.gif"
 ALT="{ r_{Ai} = ( \log( y_{i})-
 \log(\hat{ \mu_{i}}) ) /
 \hat{ \mu_{i}}^{1/2}}"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
<BR><BR>  <DT><SPAN CLASS="ssbeleven"><B>Gamma</B></SPAN>
<DD><IMG WIDTH="183" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq256.gif"
 ALT="{ r_{Ai} = 3 ( ( y_{i} / \hat{ \mu_{i}})^{1/3} - 1 ) }"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
<BR><BR>  <DT><SPAN CLASS="ssbeleven"><B>Poisson</B></SPAN>
<DD><IMG WIDTH="219" HEIGHT="45" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq257.gif"
 ALT="{ r_{Ai} = \frac{3}2 ( y_{i}^{2/3}
 \hat{ \mu_{i}}^{-1/6}
 -
 \hat{ \mu_{i}}^{1/2}) }"> &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
<BR><BR>  <DT><SPAN CLASS="ssbeleven"><B>Binomial</B></SPAN>
<DD><IMG WIDTH="425" HEIGHT="39" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq258.gif"
 ALT="r_{Ai} = \sqrt{ m_{i}} (
 B( y_{i},\frac{2}3,\frac{2}3)- 
 B(\hat{ \mu_{i}},\frac{2}3,\frac{2}3) )
 (\hat{ \mu_{i}} (1-\hat{ \mu_{i}}))^{-1/6} "><BR><BR>where <IMG WIDTH="251" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq259.gif"
 ALT="B(z,a,b) =
 \int_{0}^zt^{a-1}(1-t)^{b-1}\, dt"></DL><BR>You can save Anscombe residuals to your data set by using the
<SPAN CLASS="ssbeleven"><B>Output Variables</B></SPAN> dialog, as shown in <A HREF="sect15.htm#fitoutputvariablesdialog">Figure 39.5</A>,
or the <SPAN CLASS="ssbeleven"><B>Vars</B></SPAN> menu, as shown in <A HREF="sect46.htm#fitvarsmenu">Figure 39.48</A>.
These residuals are stored in variables named
<SPAN CLASS="ssbeleven"><B>RA_</B></SPAN><I><SPAN CLASS="ssbeleven"><B>yname</B></SPAN></I> for each response variable,
where <I><SPAN CLASS="ssbeleven"><B>yname</B></SPAN></I> is the response variable name.
<A NAME="idxfit0808">&#13;</A>The standardized and studentized Anscombe residuals are

<DL CLASS="equation"><DD><IMG WIDTH="148" HEIGHT="107"
 SRC="images/fiteq260.gif"
 ALT="r_{Asi} = \frac{r_{Ai}}{\sqrt{\hat{\phi} (1- h_{i})} }"></DL>

<DL CLASS="equation"><DD><IMG WIDTH="164" HEIGHT="107"
 SRC="images/fiteq261.gif"
 ALT="r_{Ati} = \frac{r_{Ai}}{\sqrt{ \hat{\phi}_{(i)}
 (1- h_{i})} }"></DL>
where <IMG WIDTH="14" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq240.gif"
 ALT="{\hat{ \phi}}"> is the
estimate of the dispersion parameter <IMG WIDTH="14" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq23.gif"
 ALT="\phi">, and
<IMG WIDTH="31" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq241.gif"
 ALT="{ \hat{ \phi}_{(i)}}">is a one-step approximation of <IMG WIDTH="14" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq23.gif"
 ALT="\phi"> after
excluding the <SPAN CLASS="mathfont"><I>i</I></SPAN>th observation.
<P>The standardized Anscombe residuals are stored
in variables named <SPAN CLASS="ssbeleven"><B>RAS_</B></SPAN><I><SPAN CLASS="ssbeleven"><B>yname</B></SPAN></I> and the studentized
Anscombe residuals are stored in variables named
<SPAN CLASS="ssbeleven"><B>RAT_</B></SPAN><I><SPAN CLASS="ssbeleven"><B>yname</B></SPAN></I> for each response variable,
where <I><SPAN CLASS="ssbeleven"><B>yname</B></SPAN></I> is the response variable name.
<A NAME="idxfit0809">&#13;</A><P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect56.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect58.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
