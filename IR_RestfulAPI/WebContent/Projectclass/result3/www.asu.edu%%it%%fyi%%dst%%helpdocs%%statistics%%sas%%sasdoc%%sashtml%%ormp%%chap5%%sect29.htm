<HTML>
<HEAD>
<TITLE>Hessian and CRP Jacobian Scaling</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect28.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect30.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The NLP Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Hessian and CRP Jacobian Scaling  </H2>
<A NAME="idxnlp0463">&#13;</A><A NAME="idxnlp0464">&#13;</A><A NAME="idxnlp0465">&#13;</A>The rows and columns of the Hessian and crossproduct Jacobian matrix
can be scaled when using the trust-region, Newton-Raphson, Double Dogleg,
and Levenberg-Marquardt optimization techniques.
Each element <SPAN CLASS="mathfont"><I>G</I><SUB><I>i</I>,<I>j</I></SUB></SPAN>, <SPAN CLASS="mathfont"><I>i</I>,<I>j</I> = 1, ... ,<I>n</I>,</SPAN> is divided by the
scaling factor <SPAN CLASS="mathfont"><I>d</I><SUB><I>i</I></SUB> * <I>d</I><SUB><I>j</I></SUB></SPAN>, where the scaling vector
<SPAN CLASS="mathfont"><I>d</I> = (<I>d<SUb>1</SUb></I>, ... ,<I>d</I><sub><I>n</I></sub>)</SPAN> is iteratively updated in a way
specified by the HESCAL=<SPAN CLASS="mathfont"><I>i</I></SPAN> option, as follows:
<DL>
<DT><STRONG><SPAN CLASS="mathfont"><I>i</I> = 0</SPAN></STRONG>
<DD>: No scaling is done (equivalent to <SPAN CLASS="mathfont"><I>d</I><SUB><I>i</I></SUB>=1</SPAN>).
<DT><STRONG><IMG WIDTH="43" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/nlpeq118.gif"
 ALT="i \neq 0"></STRONG>
<DD>: First iteration and each restart iteration sets:

<DL CLASS="equation"><DD><IMG WIDTH="177" HEIGHT="89"
 SRC="images/nlpeq35.gif"
 ALT="d_i^{(0)} = \sqrt{\max(| G^{(0)}_{i,i}|,\epsilon)} "></DL>
<DT><STRONG><SPAN CLASS="mathfont"><I>i</I> = 1</SPAN></STRONG>
<DD>: refer to Mor<IMG WIDTH="11" HEIGHT="32" ALIGN="MIDDLE" BORDER="0"
 SRC="images/nlpeq36.gif"
 ALT="\acute{e}"> (1978):
     
<DL CLASS="equation"><DD><IMG WIDTH="279" HEIGHT="89"
 SRC="images/nlpeq37.gif"
 ALT="d_i^{(k+1)} = \max(d_i^{(k)},\sqrt{\max(| G^{(k)}_{i,i}|,\epsilon)}) "></DL>
<DT><STRONG><SPAN CLASS="mathfont"><I>i</I> = 2</SPAN></STRONG>
<DD>: refer to Dennis, Gay, and Welsch (1981):
     
<DL CLASS="equation"><DD><IMG WIDTH="310" HEIGHT="89"
 SRC="images/nlpeq119.gif"
 ALT="d_i^{(k+1)} = \max(.6 * d_i^{(k)},\sqrt{\max(| G^{(k)}_{i,i}|,\epsilon)})
 "></DL>
<DT><STRONG><SPAN CLASS="mathfont"><I>i</I> = 3</SPAN></STRONG>
<DD>: <SPAN CLASS="mathfont"><I>d</I><SUB><I>i</I></SUB></SPAN> is reset in each iteration:
     
<DL CLASS="equation"><DD><IMG WIDTH="196" HEIGHT="89"
 SRC="images/nlpeq39.gif"
 ALT="d_i^{(k+1)} = \sqrt{\max(| G^{(k)}_{i,i}|,\epsilon)} "></DL></DL>
<A NAME="idxnlp0466">&#13;</A><A NAME="idxnlp0467">&#13;</A><A NAME="idxnlp0468">&#13;</A><A NAME="idxnlp0469">&#13;</A>where <IMG WIDTH="11" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/nlpeq24.gif"
 ALT="\epsilon"> is the relative machine precision or, equivalently,
the largest double precision value that when added to 1 results in 1.
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect28.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect30.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
