<HTML>
<HEAD>
<TITLE>Overview</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="index.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect2.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The SPECTRA Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H1><FONT SIZE="5">Overview  </FONT></H1>
<P>The SPECTRA procedure performs spectral and cross-spectral analysis of
time series.  You can use spectral analysis techniques to look for
periodicities or cyclical patterns in data.
<P>The SPECTRA procedure produces estimates of the spectral and
cross-spectral densities of a multivariate time series.
Estimates of the spectral and cross-spectral densities of a
multivariate time series are produced using a finite Fourier transform
to obtain periodograms and cross-periodograms.
The periodogram ordinates are smoothed by a moving average
to produce estimated spectral and cross-spectral densities.
PROC SPECTRA can also test whether or not the data are white noise.
<A NAME="idxspe0002">&#13;</A><A NAME="idxspe0001">&#13;</A><A NAME="idxspe0004">&#13;</A><A NAME="idxspe0003">&#13;</A><A NAME="idxspe0006">&#13;</A><A NAME="idxspe0005">&#13;</A>PROC SPECTRA uses the finite Fourier transform to decompose
data series into a sum of sine and cosine waves of different 
amplitudes and wavelengths.
The Fourier transform decomposition of the series <I>x</I><SPAN CLASS="mathfont"><SUB><I>t</I></SUB></SPAN> is
<A NAME="idxspe0008">&#13;</A><A NAME="idxspe0007">&#13;</A><A NAME="idxspe0010">&#13;</A><A NAME="idxspe0009">&#13;</A>
<DL CLASS="equation"><DD><IMG WIDTH="312" HEIGHT="110"
 SRC="images/speeq1.gif"
 ALT="x_{t}=\frac{a_{0}}2
+\sum_{k=1}^m{[ a_{k} {cos}({\omega}_{k} t)
+b_{k} {sin}({\omega}_{k} t) ]}"></DL>
<P>where
<P><DL>
<DT><SPAN CLASS="mathfont"><I>t</I></SPAN>
<DD>is the time subscript, <SPAN CLASS="mathfont"><I>t</I> = 1,2, ... &#160;,<I>n</I></SPAN>
<BR><BR><DT><SPAN CLASS="mathfont"><I>x</I><SUB><I>t</I></SUB></SPAN>
<DD>are the data
<BR><BR><DT><SPAN CLASS="mathfont"><I>n</I></SPAN>
<DD>is the number of observations in the time series
<BR><BR><DT><SPAN CLASS="mathfont"><I>m</I></SPAN>
<DD>is the number of of frequencies in the Fourier decomposition:
<SPAN CLASS="mathfont"><I>m</I> = [<I>n</I>/2]</SPAN> if <SPAN CLASS="mathfont"><I>n</I></SPAN> is even;
<SPAN CLASS="mathfont"><I>m</I> = [(<I>n</I>-1)/2]</SPAN> if <SPAN CLASS="mathfont"><I>n</I></SPAN> is odd
<BR><BR><DT><SPAN CLASS="mathfont"><I>a<SUB>0</SUB></I></SPAN>
<DD>is the mean term: <IMG WIDTH="65" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/speeq2.gif"
 ALT="{a_{0} = 2 {\overline x}}">
<DT><SPAN CLASS="mathfont"><I>a</I><SUB><I>k</I></SUB></SPAN>
<DD>are the cosine coefficients
<BR><BR><DT><SPAN CLASS="mathfont"><I>b</I><SUB><I>k</I></SUB></SPAN>
<DD>are the sine coefficients
<BR><BR><DT><IMG WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/speeq3.gif"
 ALT="{{\omega}_{k}}"><DD>are the Fourier frequencies: <IMG WIDTH="75" HEIGHT="38" ALIGN="MIDDLE" BORDER="0"
 SRC="images/speeq4.gif"
 ALT="{{\omega}_{k} = \frac{2{\pi}k}n}"></DL><BR>Functions of the Fourier coefficients <SPAN CLASS="mathfont"><I>a</I><SUB><I>k</I></SUB></SPAN> and <SPAN CLASS="mathfont"><I>b</I><SUB><I>k</I></SUB></SPAN>
can be plotted against frequency or against wave length to form
<I>periodograms</I>.
The amplitude periodogram <SPAN CLASS="mathfont"><I>J</I><SUB><I>k</I></SUB></SPAN> is defined as follows:
<A NAME="idxspe0012">&#13;</A><A NAME="idxspe0011">&#13;</A>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><I>J</I><sub><I>k</I></sub> = [<I>n</I>/2] ( <I>a<SUp>2</SUp></I><sub><I>k</I></sub>+ <I>b<SUp>2</SUp></I><sub><I>k</I></sub> )</SPAN>
</DL><BR>Several definitions of the term periodogram are used 
in the spectral analysis literature.
The following discussion refers to the <SPAN CLASS="mathfont"><I>J</I><SUB><I>k</I></SUB></SPAN> sequence
as the periodogram.
<BR><BR>The periodogram can be interpreted as the contribution of the <I>k</I>th
harmonic <IMG WIDTH="23" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/speeq3.gif"
 ALT="{{\omega}_{k}}"> to the total sum of squares, 
in an analysis of variance sense,
for the decomposition of the process into two-degree-of-freedom
components for each of the <I>m</I> frequencies.
When <I>n</I> is even, <IMG WIDTH="67" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/speeq5.gif"
 ALT="{{sin}( {\omega}_{\frac{n}2} )}"> is zero, 
and thus the last periodogram value is a one-degree-of-freedom component.
<BR><BR>The periodogram is a volatile and inconsistent estimator of the spectrum.
The spectral density estimate is produced by smoothing the periodogram.
Smoothing reduces the variance of the estimator but introduces a bias.
The weight function used for the smoothing process, W(), 
often called the kernel or spectral window, 
is specified with the WEIGHTS statement.
It is related to another weight function, <I>w</I>(), the lag window,
that is used in other methods to taper the correlogram rather than
to smooth the periodogram.
Many specific weighting functions have been suggested in the literature
(Fuller 1976, Jenkins and Watts 1968, Priestly 1981).
<A HREF="sect16.htm#spet1">Table 17.1</A> later in this chapter gives the formulas relevant
when the WEIGHTS statement is used.
<BR><BR>Letting <I>i</I> represent the imaginary unit <IMG WIDTH="42" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/speeq6.gif"
 ALT="{\sqrt{-1}}">,
the cross-periodogram is defined as follows:
<A NAME="idxspe0014">&#13;</A><A NAME="idxspe0013">&#13;</A><A NAME="idxspe0016">&#13;</A><A NAME="idxspe0015">&#13;</A>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><I>J</I><sup><I>xy</I></sup><sub><I>k</I></sub> =  [<I>n</I>/2] ( <I>a</I><sup><I>x</I></sup><sub><I>k</I></sub> <I>a</I><sup><I>y</I></sup><sub><I>k</I></sub> + <I>b</I><sup><I>x</I></sup><sub><I>k</I></sub> <I>b</I><sup><I>y</I></sup><sub><I>k</I></sub> ) + <I>i</I> [<I>n</I>/2] ( <I>a</I><sup><I>x</I></sup><sub><I>k</I></sub> <I>b</I><sup><I>y</I></sup><sub><I>k</I></sub> - <I>b</I><sup><I>x</I></sup><sub><I>k</I></sub> <I>a</I><sup><I>y</I></sup><sub><I>k</I></sub> )</SPAN>
</DL>
<P>The cross-spectral density estimate is produced by smoothing the 
cross-periodogram in the same way as the periodograms are smoothed
using the spectral window specified by the WEIGHTS statement.
<P>The SPECTRA procedure creates an output SAS data set whose variables
contain values of the periodograms, cross-periodograms, estimates
of spectral densities, and estimates of cross-spectral densities.
The form of the output data set is described
in the section &#34;OUT= Data Set&#34; later in this chapter.
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="index.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect2.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
