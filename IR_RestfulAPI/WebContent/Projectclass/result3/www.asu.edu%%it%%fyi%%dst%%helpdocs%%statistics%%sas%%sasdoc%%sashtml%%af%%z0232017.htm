<HTML>
<!-- This page produced Tue Jul 20 10:24:46 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Data Set Model Class : Data Set Model: _setKey  </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z1slam.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z12015.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0232020.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">Data Set Model: _setKey </FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z0232017">Data Set Model: _setKey </A></FONT></H1>

<P><HR><BR><B>Sets an index key for retrieving the rows in the
table</B><p>
 <HR>
<TABLE cellspacing="0" cellpadding="1">
<TR>
<TD colspan="2"><A href="z0232017.htm#zid-5237"><FONT size="2"><B>Syntax</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0232017.htm#z0232018"><FONT size="2"><B>Details</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0232017.htm#z0232019"><FONT size="2"><B>Example</b></FONT></A></TD></TR></TABLE>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><H2><A name="zid-5237">Syntax</A></H2></TD></TR></TABLE>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top"><TD>
CALL SEND (<I>object-id</I>, '_setKey', <I>rc</I>&lt;,
<I>keyname</I>&gt;&lt;, <I>condition</I>&gt;&lt;, <I>scroll</I>&gt;&lt;,
<I>val-list</I>&gt;);
</TD></TR></TABLE><A name="zid-5238">&#13;</A>
<P>
<P>
<TABLE cellpadding="6" cellspacing="0" border="0">


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="BOTTOM" ><B>Argument </B></TH>
  <TH  align="LEFT" valign="BOTTOM" ><B>Type </B></TH>
  <TH  colspan="2" align="LEFT" valign="BOTTOM" ><B>Description </B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>rc</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">N </TD>
  
<TD  colspan="2" align="LEFT" valign="TOP">returns whether the key was successfully applied</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">0        </TD>
  
<TD  align="LEFT" valign="TOP">key was successfully applied</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD ><BR></TD>
  
<TD ><BR></TD>
  
<TD  align="LEFT" valign="TOP">not 0      </TD>
  
<TD  align="LEFT" valign="TOP">otherwise</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>keyname</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">C </TD>
  
<TD  colspan="2" align="LEFT" valign="TOP">specifies the name of the key or index to use on the   table.  The <B>keyname</B> may
specify a single or a composite index.</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>condition</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">C </TD>
  
<TD  colspan="2" align="LEFT" valign="TOP">specifies the condition to use when comparing the   key value:</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP">'EQ'</TD>
  
<TD  align="LEFT" valign="TOP">equal to</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP">'GE'</TD>
  
<TD  align="LEFT" valign="TOP">greater than or equal to</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP">'GT' </TD>
  
<TD  align="LEFT" valign="TOP">greater than</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP">'LE'</TD>
  
<TD  align="LEFT" valign="TOP">      less than or equal to</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP">'LT'</TD>
  
<TD  align="LEFT" valign="TOP">        less than</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>scroll</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">C </TD>
  
<TD  colspan="2" align="LEFT" valign="TOP">specifies whether rows can be retrieved in   random order:</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP">'SCROLL' </TD>
  
<TD  align="LEFT" valign="TOP">rows can be retrieved in random order (default)</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP"><BR></TD>
  
<TD  align="LEFT" valign="TOP">'NOSCROLL' </TD>
  
<TD  align="LEFT" valign="TOP">rows can only be retrieved sequentially</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><B>val-list</B><BR></TD>
  
<TD  align="LEFT" valign="TOP">N </TD>
  
<TD  colspan="2" align="LEFT" valign="TOP">specifies the identifier of an SCL list that   contains values to use
in the   key.  The item name should reflect the appropriate column name, and
  the item value should be the value that the key value is compared   against.</TD>
</TR>

</TABLE>

<BR>

<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0232018">Details</A></FONT></B></TD></TR></TABLE>

<P>  If you modify the current row in the table, you must use the _updateRow
method before calling the _setKey method.
<P>The _setKey method enables you to set an active key in an open table
to a simple or composite key.  It establishes a set of criteria for reading
table rows by evaluating the value of the columns against the key value in
the rows.
<P>Using a composite key with _setKey operates the same way as the _where
method only when the condition is EQ.  The value returned when the condition
is EQ is the same as if the columns specified in the composite key were connected
by WHERE conditions that use AND or ALSO.
<P>For all other conditions (GT, GE, LT, or LE) specified with _setKey
for a composite key, the composite key columns are concatenated together to
form the index key.  The number returned by the _keyCount method is the number
of rows in the table that satisfy the composite key.  For example, if the
composite index consists of columns SEX and AGE and the condition is GT (greater
than), the values to search for are concatenated such that key values of 


<CODE><B>F</B></CODE> for SEX and 13 for AGE yield an index key of 


<CODE><B>F13</B></CODE>.
 Because the search is performed on the concatenated values, some values may
meet the search condition that you did not expect, such as SEX of 


<CODE><B>M</B></CODE>
and AGE of 11, because the string 


<CODE><B>M11</B></CODE> is considered greater
than the string 


<CODE><B>F13</B></CODE>.
<P>Once an active key is set through the _setKey method, it remains active
until the following conditions are met: 
<P>
<UL>

<LI>the table is closed<P>

<LI>another key is set<P>

<LI>the current setting is cleared by passing
the <B>rc</B>
argument alone to the _setKey method.<P>
</UL>

<P>The table is automatically positioned at the row that meets the specified
criteria.  Use the _getRow or _fetchRow method to read the row.
<P>The _setKey method cannot be used in conjunction with a WHERE clause.
<P>The _setKey method sets SYSRC for error,
note, and warning conditions.
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0232019">Example</A></FONT></B></TD></TR></TABLE>

<P>  In the following example, the Data Set Model class is being used as
a stand-alone model, that is, the model class is not being used with a data
form or data table object.
<P>This example creates an index on the STATE variable in the table SASUSER.CRIME.
 It subsets on STATE values less than 20.  In this example, COUNT returns
15.
<P>   



<TABLE cellspacing="0" cellpadding="6" border="0">
<TR valign="top">
<TD ><A name="z0316354">&nbsp;</A><A href="z0316354.htm"><IMG border="0" src="../common/images/snbut.gif" height="24" width="24" alt="Note about code"></A></TD><TD><PRE>
INIT:
   dsid=open('sasuser.crime', 'v');
   rc=icreate(dsid, 'state', 'state');
   dsid=close(dsid);

   datcl=loadclass('sashelp.fsp.datast_m.class');
   datid=instance(datcl);</PRE></TD></TR></TABLE>


  



<TABLE cellspacing="0" cellpadding="6" border="0">
<TR valign="top">
<TD ><A name="z0316356">&nbsp;</A><A href="z0316356.htm"><IMG border="0" src="../common/images/snbut.gif" height="24" width="24" alt="Note about code"></A></TD><TD><PRE>
  call send(datid,'_setDataset',
            'sasuser.crime');</PRE></TD></TR></TABLE>


  



<TABLE cellspacing="0" cellpadding="6" border="0">
<TR valign="top">
<TD ><A name="z0316357">&nbsp;</A><A href="z0316357.htm"><IMG border="0" src="../common/images/snbut.gif" height="24" width="24" alt="Note about code"></A></TD><TD><PRE>
   list=makelist();
   list=setnitemn(list, 20, 'state');
   call send(datid, '_setKey', rc, 'state',
            'LT', 'scroll', list);
   call send(datid, '_keyCount', rc, count);
   put count=;
return;</PRE></TD></TR></TABLE>


  



<TABLE cellspacing="0" cellpadding="6" border="0">
<TR valign="top">
<TD ><A name="z0316359">&nbsp;</A><A href="z0316359.htm"><IMG border="0" src="../common/images/snbut.gif" height="24" width="24" alt="Note about code"></A></TD><TD><PRE>
TERM:
   call send(datid,'_term');
   list=dellist(list);
 return;</PRE></TD></TR></TABLE>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z1slam.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z12015.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0232020.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z0232017">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>