<HTML>
<!-- This page produced Mon Jul 19 13:58:41 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Statements : UPDATE </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0293668.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0220968.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0202951.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">UPDATE</FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z0202975">UPDATE</A></FONT></H1>

<P><HR><BR><B>Updates a master file by applying transactions</B><p>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="right" bgcolor="#F5F5F5" nowrap><B>Valid:</B></TD>
<TD bgcolor="#CCCCCC" align="left">in a DATA step
</TD></TR>
<TR valign="top">
<TD align="right" bgcolor="#F5F5F5" nowrap><B>Category:</B></TD>
<TD bgcolor="#CCCCCC" align="left">File-handling
</TD></TR>
<TR valign="top">
<TD align="right" bgcolor="#F5F5F5" nowrap><B>Type:</B></TD>
<TD bgcolor="#CCCCCC" align="left">Executable
</TD></TR>
</TABLE><HR>
<TABLE cellspacing="0" cellpadding="1">
<TR>
<TD colspan="2"><A href="z0202975.htm#zid-2628"><FONT size="2"><B>Syntax</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0202975.htm#zid-2629"><FONT size="2"><B>Arguments</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0202975.htm#z0290107"><FONT size="2"><B>Details</b></FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0202975.htm#z0290108"><FONT size="2">Requirements</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0202975.htm#z0290109"><FONT size="2">Transaction Data Sets</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0202975.htm#z0290110"><FONT size="2">Missing Values</FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0202975.htm#z0290113"><FONT size="2"><B>Comparisons</b></FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0202975.htm#z0290114"><FONT size="2"><B>Examples</b></FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0202975.htm#z0101770"><FONT size="2">Example 1: Basic Updating</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0202975.htm#z0101772"><FONT size="2">Example 2: Updating By Renaming Variables</FONT></A></TD></TR>
<TR>
<TD width="18"></TD>
<TD><A href="z0202975.htm#z0101773"><FONT size="2">Example 3: Updating with Missing Values</FONT></A></TD></TR>
<TR>
<TD colspan="2"><A href="z0202975.htm#z0290118"><FONT size="2"><B>See Also</b></FONT></A></TD></TR></TABLE>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><H2><A name="zid-2628">Syntax</A></H2></TD></TR></TABLE>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top"><TD>
<B>UPDATE</B><I>master-data-set</I>&lt;(<I>data-set-options</I>)&gt; 
<I>transaction-data-set</I>&lt;(<I>data-set-options</I>)&gt;
<TABLE cellpadding="2" cellspacing="2">
<TR><TD width="24"></TD><TD>
&lt;END=<I>variable</I>&gt;
</TD></TR></TABLE>
<TABLE cellpadding="2" cellspacing="2">
<TR><TD width="24"></TD><TD>
&lt;UPDATEMODE=
<BR>
MISSINGCHECK|NOMISSINGCHECK&gt;;
</TD></TR></TABLE>
<TABLE cellpadding="2" cellspacing="2">
<TR><TD width="24"></TD><TD>
<B>BY</B> <I>by-variable</I>;
</TD></TR></TABLE>
</TD></TR></TABLE>
<BR><H3><A name="zid-2629">Arguments</A></H3>

<P><A name="z0855987">&#13;</A>
<DL>
<DT><B><B><I>master-data-set</I></B></B></DT>
<DD>names the SAS data set used as the master
file.
<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Range:</B></TD>
<TD align="left" bgcolor="#F5F5F5">The name can be a one-level
name (for example, FITNESS), a two-level name (for example, IN.FITNESS), or
one of the special SAS data set names.</TD>
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>See Also:</B></TD>
<TD align="left" bgcolor="#F5F5F5">SAS Names and Words
in       
<I><B>SAS Language Reference: Concepts</B></I>.</TD>
</TABLE>
<P></DD>

<DT><B><B><I>(data-set-options)</I></B></B></DT>
<DD>specifies actions SAS is to take when it
reads variables into the DATA step for processing.
<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Requirements:</B></TD>
<TD align="left" bgcolor="#F5F5F5"><B><I>Data-set-options</I></B> must appear within parentheses and follow
a SAS data set name.</TD>
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Tip:</B></TD>
<TD align="left" bgcolor="#F5F5F5">Dropping, keeping, and renaming
variables is often useful when you update a data set. Renaming like-named
variables prevents the second value that is read from over-writing the first
one. By renaming one variable, you make the values of both of them available
for processing, such as comparing.</TD>
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Featured in:</B></TD>
<TD align="left" bgcolor="#F5F5F5"><A href="#z0101772">Updating By Renaming Variables</A></TD>
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>See Also:</B></TD>
<TD align="left" bgcolor="#F5F5F5">A list of data set
options to use with input data sets in <A href="z0104210.htm">Data Set Options by Category</A>    
.</TD>
</TABLE>
<P></DD>

<DT><B><B><I>transaction-data-set</I></B></B></DT>
<DD>names the SAS data set that contains the
changes to be applied to the master data set.
<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Range:</B></TD>
<TD align="left" bgcolor="#F5F5F5">The name can be a one-level
name (for example, HEALTH), a two-level name (for example, IN.HEALTH), or
one of the special SAS data set names.</TD>
</TABLE>
<P></DD>

<DT><B><A name="z0856001">&#13;END=<B><I>variable</I></B></A></B></DT>
<DD>creates and names a temporary variable that
contains an end-of-file indicator. This variable is initialized to 0 and is
set to 1 when UPDATE processes the last observation. This variable is not
added to any data set.<P></DD>

<DT><B><A name="z0856003">&#13;UPDATEMODE=MISSINGCHECK</A>
<BR>UPDATEMODE=NOMISSINGCHECK</B></DT>
<DD>specifies if missing variable values in
a transaction data set are to be allowed to replace existing variable values
in a master data set.
<P>
<DL>
<DT>MISSINGCHECK  </DT>
<DD>performs a check that prevents missing variable
values in a transaction data set from replacing values in a master data set. <P></DD>

<DT>NOMISSINGCHECK</DT>
<DD>prevents a check and, therefore, allows
missing variable values in a transaction data set to replace values in a master
data set.<P></DD>
</DL>

<TABLE cellpadding="4" cellspacing="2">
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Tip:</B></TD>
<TD align="left" bgcolor="#F5F5F5">Special missing values,
however, are the exception and will replace values in the master data set
even when MISSINGCHECK (the default) is in effect. </TD>
<TR valign="top">
<TD align="left" bgcolor="#F5F5F5" width="95" nowrap><B>Default:</B></TD>
<TD align="left" bgcolor="#F5F5F5">MISSINGCHECK</TD>
</TABLE>
<P></DD>
</DL>


<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0290107">Details</A></FONT></B></TD></TR></TABLE>

<BR><H3><A name="z0290108">Requirements</A></H3>


<P>
<P>
<UL>

<LI>The UPDATE statement must be accompanied by a
BY statement that specifies the variables by which observations are matched.<P>

<LI>The BY statement should immediately follow the
UPDATE statement to which it applies.<P>

<LI>The data sets listed in the UPDATE statement must
be sorted by the values of the variables listed in the BY statement, or they
must have an appropriate index.<P>

<LI>Each observation in the master data set should
have a unique value of the BY variable or BY variables. If there are multiple
values for the BY variable, only the first observation with that value is
updated. The transaction data set can contain more than one observation with
the same BY value.  (Multiple transaction observations are all applied to
the master observation before it is written to the output file.)<P>
</UL>

<BR><H3><A name="z0290109">Transaction Data Sets</A></H3>


<P>Usually,
the master data set and the transaction data set contain the same variables.
 However, to reduce processing time, you can create a transaction data set
that contains only those variables that are being updated.  The transaction
data set can also contain new variables to be added to the output data set. 
<P>The output data set contains one observation for each
observation in the master data set.  If any transaction observations do not
match master observations, they become new observations in the output data
set.  Observations that are not to be updated can be omitted from the transaction
data set. See "Reading, Modifying, and Combining SAS Data Sets"
in       
<B>SAS Language Reference: Concepts</B>. 
<BR><H3><A name="z0290110">Missing Values</A></H3>


<P>By default
the UPDATEMODE=MISSINGCHECK option is in effect, so missing values in the
transaction data set do <B>not</B> replace existing values in the master
data set.  Therefore, if you want to update some but not all variables and
if the variables you want to update differ from one observation to the next,
set to missing those variables that are not changing. If you want missing
values in the transaction data set to replace existing values in the master
data set, use UPDATEMODE=NOMISSINGCHECK. 
<P>Even when UPDATEMODE=MISSINGCHECK is in effect, you
can replace existing values with missing values by using special missing value
characters in the transaction data set.  To create the transaction data set,
use the MISSING statement in the DATA step.  If you define one of the special
missing values 


<CODE><B>A</B></CODE> through 


<CODE><B>Z</B></CODE> for the transaction data
set, SAS updates numeric variables in the master data set to that value.
<P>If you want the resulting value in the master data set
to be a regular missing value, use a single underscore (_) to represent missing
values in the transaction data set. The resulting value in the master data
set will be a period (.) for missing numeric values and a blank for missing
character values.
<P>For more information about defining and using special
missing value characters, see <A href="z0227561.htm">MISSING</A>
     
. 
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0290113">Comparisons</A></FONT></B></TD></TR></TABLE>

<P><A name="z0856023">&#13;</A>
<P>
<UL>

<LI>Both UPDATE and MERGE can update observations
in a SAS data set.<P>

<LI>MERGE automatically replaces existing values in
the first data set with missing values in the second data set. UPDATE, however,
does not do so by default. To cause UPDATE to overwrite existing values in
the master data set with missing ones in the transaction data set, you must
use UPDATEMODE=NOMISSINGCHECK.<P>

<LI>UPDATE changes or updates the values of selected
observations in a master file by applying transactions. UPDATE can also add
new observations.<P>
</UL>

<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="z0290114">Examples</A></FONT></B></TD></TR></TABLE>

<BR><H3> <A name="z0101770">Example 1: Basic Updating</A> </H3>


<P>These program
statements create a new data set (OHIO.QTR1) by applying transactions to a
master data set(OHIO.JAN). The BY variable STORE must appear in both OHIO.JAN
and OHIO.WEEK4, and its values in the master data set should be unique:  



<PRE>data ohio.qtr1;
   update ohio.jan ohio.week4;
   by store;
run;</PRE>
<BR><H3> <A name="z0101772">Example 2: Updating By Renaming Variables</A> </H3>


<P>This example shows renaming a variable in the FITNESS data set so that it
will not overwrite the value of the same variable in the program data vector.
Also, the WEIGHT variable is renamed in each data set and a new WEIGHT variable
is calculated. The master data set and the transaction data set are listed
before the code that performs the update:



<PRE>Master Data Set                          
            HEALTH                      

OBS    ID     NAME     TEAM    WEIGHT      

 1    1114    sally    blue      125       
 2    1441    sue      green     145       
 3    1750    joey     red       189       
 4    1994    mark     yellow    165
 5    2304    joe      red       170</PRE>






<PRE>Transaction Data Set
            FITNESS

OBS   ID     NAME     TEAM    WEIGHT

 1   1114    sally    blue      119
 2   1994    mark     yellow    174
 3   2304    joe      red       170
 </PRE>






<PRE>options nodate pageno=1 linesize=80 pagesize=60;

   /* Sort both data sets by ID */
proc sort data=health;
   by id;
run;
proc sort data=fitness;
   by id;
run;

   /* Update Master with Transaction */
data health2;
   length STATUS $11;
   update health(rename=(weight=ORIG) in=a)
          fitness(drop=name team in=b);
   by id ;
   if a and b then
      do;
         CHANGE=abs(orig - weight);
         if weight&lt;orig then status='loss';
         else if weight>orig then status='gain';
         else status='same';
      end;
   else status='no weigh in';
run;

options nodate ls=78;

proc print data=health2;
   title 'Weekly Weigh-in Report';
run;</PRE>




<P>



<TABLE border="1" cellpadding="12" cellspacing="0" bgcolor="#FAFAFA">
<TR>
<TD><PRE>                     Weekly Weigh-in Report             1

  OBS STATUS        ID   NAME   TEAM    ORIG  WEIGHT  CHANGE

   1  loss         1114  sally  blue     125    119      6  
   2  no weigh in  1441  sue    green    145      .      .  
   3  no weigh in  1750  joey   red      189      .      .  
   4  gain         1994  mark   yellow   165    174      9  
   5  same         2304  joe    red      170    170      0  </PRE></TD></TR></TABLE>

<P>
<BR><H3> <A name="z0101773">Example 3: Updating with Missing Values</A> </H3>


<P>This example illustrates the DATA steps used to create a master data set PAYROLL
and a transaction data set INCREASE that contains regular and special missing
values: 



<PRE>options nodate pageno=1 linesize=80 pagesize=60;

   /* Create the Master Data Set */
data payroll;
   input ID SALARY;
   datalines;
011 245
026 269
028 374
034 333
057 582
;

   /* Create the Transaction Data Set */
data increase;
   input ID SALARY;
   missing A _;
   datalines;
011 376
026 .
028 374
034 A
057 _
;

   /* Update Master with Transaction */
data newpay;
   update payroll increase;
   by id;
run;
proc print data=newpay;
   title 'Updating with Missing Values';
run;</PRE>
<P>
<P>


<TABLE border="1" cellpadding="12" cellspacing="0" bgcolor="#FAFAFA">
<TR>
<TD><PRE>       Updating with Missing Values              1

           OBS     ID     SALARY

            1     1011      376 
            2     1026      269    &lt;=== value remains 269
            3     1028      374 
            4     1034        A    &lt;=== special missing value
            5     1057        .    &lt;=== regular missing value</PRE></TD></TR></TABLE>

<P>
<P>
<TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><FONT size="5"><A name="z0290118">See Also</A></FONT>
</FONT></B></TD></TR></TABLE>
<P>
<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD>Statements:



<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD><A href="z0202968.htm">BY</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0202970.htm">MERGE</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0227561.htm">MISSING</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0173361.htm">MODIFY</A></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0173782.htm">SET</A></TD></TR></TABLE></TD></TR>
<TR valign="top"><TD></TD><TD>System
Option:
<P>
<TABLE cellpadding="6" cellspacing="2">
<TR valign="top"><TD></TD><TD><A href="z0227574.htm">MISSING=</A></TD></TR></TABLE></TD></TR>
<TR valign="top"><TD></TD><TD>"Reading,
Modifying, and Combining SAS Data Sets"
in       
<B>SAS Language Reference: Concepts</B></TD></TR>
<TR valign="top"><TD></TD><TD><A href="z0201788.htm">Data Set Options</A>
   </TD></TR></TABLE>

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z0293668.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="z0220968.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="z0202951.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z0202975">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>