<HTML>
<!-- This page produced Wed Jun 30 13:31:34 EDT 1999
 -->
<!-- Used program version 1.118.1.2 from beta -->
<HEAD>
<!-- <META http-equiv="Content-Type" content="text/html; charset="> -->
<TITLE>Query and Reporting : Building a Query </TITLE></HEAD>
<BODY bgcolor="#FFFFFF">
<!-- navigation -->
<TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z1084674.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="openqm.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="zetables.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
</TR></TABLE>
<!-- running head -->
<TABLE width="100%" cellpadding="4">
<TR valign="MIDDLE">
<TD bgcolor="#CCCC99"><I><FONT size="2">Doing More with SAS/ASSIST Software                                                                                       </FONT></I></TD>
</TR>
</TABLE><H1><FONT size="5"><A name="z0940396">Building a Query</A></FONT></H1>


<P><A name="z1286898">&#13;To
build a query on the table that you have selected, you must first return to
the Query window; from the Select window, choose <B>Close</B> from the <B>File</B> menu.  Any tables that
you have selected in the Select window are displayed in theQuery
window, as shown in the following display. <B>&lt;UNTITLED></B>
appears in the Query window name because you have
not given your query a name yet (you do so later in </A><A href="#zvequery">Saving a Query</A>).
<P>
<P>
<B><I><A name="z1133449">Query Window With AIRLINE.MARCH Table</A></I></B><BR>

<P><IMG border="0" src="./images/01319270.gif" vspace="12" alt="[IMAGE]">
<P>
<P>The Query window
assigns
aliases to the tables and columns.  An <B>alias</B> is a temporary,
alternate name for a table. If you select two tables that have columns with
the same name, the aliases are used so that you can distinguish them. In the
previous display, the AIRLINE.MARCH table is assigned an alias of <B>A</B>.
<P>If you chose one table in the Select
window, <B>Subset</B> and <B>Expression</B>
are displayed. If you select multiple tables, <B>Join</B>
is also displayed in the window.
<P>If your query has many columns or several tables so
that the list of columns extends beyond one display of this window, you can
see the other columns in one of two ways: 
<P>
<UL>

<LI>Scroll forward (down) or backward (up) by using
the <B>View</B> menu items.<P>

<LI>Change the numbers in the ranges above the listed
columns and tables. For example, the AIRLINE.MARCH table in the previous display
shows this range: 



<PRE>1 to 7 of 7      1 to 1 of 1</PRE>
      
<P>The range on the left refers to the columns in the table.
This example shows selected columns for the query on AIRLINE.MARCH.  However,
if you had many columns in your table, you could specify the first number
of the range in the first field.  For example, if you have 27 columns in the
table, and you change the first number in the left range to 5 and press ENTER,
the range changes to <B>5 to 20 of 27</B>.  Columns 5
to 20 are displayed in the window.  The total number of columns in the table
does not change.
<P>The range on the right refers to the number of tables
in the query. Again, you can specify the first number of the range that you
want to see. The total number of tables does not change.<P>
</UL>

<P>To see the SQL that has been created by selecting columns
from the AIRLINE.MARCH table, select <B>Show SQL</B> from
the <B>View</B> menu. The first page of the SQL code is
shown in the following display.
<P>
<P>
<B><I>Show SQL Window</I></B><BR>

<P><IMG border="0" src="./images/01319271.gif" vspace="12" alt="[IMAGE]">
<P>
<P>This window also has a range so
that you can scroll
to a particular line of code.  Select <B>Close</B> from
the <B>File</B> menu to return to the Query window.
<P>To run this query, within the Query
window, select <B>Submit</B> from the <B>Run</B> menu.  The following display shows the results.
<P>
<P>
<B><I>Query Results</I></B><BR>

<P><IMG border="0" src="./images/01319272.gif" vspace="12" alt="[IMAGE]">
<P>
<P>When you return to the
Query
window, a message indicates how many rows were retrieved.  
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;You can use the Report Engine window to enhance
the report, as described in <A href="z1081489.htm">Doing More with the Report Engine</A>.
 Select <B>Report Engine</B> from the <B>View</B> menu to go directly to the Report Engine
window.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5">Customizing Your Query</FONT></B></TD></TR></TABLE>

<P><A name="z1286911">&#13;You can customize your query by re-ordering the
columns, applying
aggregate (summary) functions to the columns, retrieving a subset of the data,
setting up a prompt for queries, or adding fields that include arithmetic
expressions to the selection list.</A>
<BR><H3>Using the Cmd Field</H3>


<P><A name="z1286912">&#13;The <B>Cmd</B> field
accepts these commands: </A>
<TABLE cellpadding="5" cellspacing="0">
<TR align=left valign="top">
<TD><CODE><B>I</B></CODE></TD>
<TD align="left">Displays information about the column,
as described in <A href="openqm.htm#zoreinfo">Expanding a List to Get More Information</A>.</TD></TR>

<TR align=left valign="top">
<TD><CODE><B>D</B></CODE></TD>
<TD align="left">Permanently deselects (excludes)
one or more columns from your query.</TD></TR>

<TR align=left valign="top">
<TD><CODE><B>R</B></CODE></TD>
<TD align="left">Repeats the row, adding the duplicate
after the row to be repeated.</TD></TR>

<TR align=left valign="top">
<TD><CODE><B>?</B></CODE></TD>
<TD align="left">Displays a list of available commands.</TD></TR>
</TABLE>

<BR><H3>Using the No Field</H3>


<P><A name="z1286921">&#13;Although the
<B>No</B> field (abbreviated
from "Number") does not accept commands, you can use it to perform
these actions:  </A>
<OL START="1" type="1">
<LI>Blanking out or "erasing" a number
in this field omits the column temporarily from the query.  The omitted column
moves to the bottom of the column list.  You can retype the number to select
the column again.<P>

<LI>Typing a new number over a current number reorganizes
the column order accordingly.  For example, if you want <B>A.NONREV</B> to be the first column in <A href="#z1133449">Query Window With AIRLINE.MARCH Table</A>, type 


<CODE><B>1</B></CODE> in the <B>No</B> field next to <B>A.NONREV</B> and a different
number for <B>A.FLIGHT</B> (the previous Column 1). When
you press ENTER, the columns are reordered.<P>
</OL>

<BR><H3>Using the Order Field</H3>


<P><A name="z1286924">&#13;The
<B>Order</B> field accepts these
commands: </A>
<TABLE cellpadding="5" cellspacing="0">
<TR align=left valign="top">
<TD><CODE><B>A</B></CODE></TD>
<TD align="left">Organizes the data within each column
in ascending order, that is, in numeric order or alphabetic order from A to
Z.</TD></TR>

<TR align=left valign="top">
<TD><CODE><B>D</B></CODE></TD>
<TD align="left">Organizes the data within each column
in descending (reverse) order, such as the highest miles traveled to the lowest
miles traveled.</TD></TR>

<TR align=left valign="top">
<TD><CODE><B>?</B></CODE></TD>
<TD align="left">Displays a list of available commands.</TD></TR>
</TABLE>

<P>You can designate one column as 


<CODE><B>A</B></CODE>
and another as 


<CODE><B>D</B></CODE> within the same query.  If you want the sorting
order (ascending or descending) to be different from the column order, you
can combine a letter (


<CODE><B>A</B></CODE> or 


<CODE><B>D</B></CODE>) with a number in the <B>Order</B> field. This affects only the query's output and not the
ordering of any columns in the Query window.
<P>For example, to list the dates and departure times in
the AIRLINE.MARCH table in ascending order, you specify 


<CODE><B>A1</B></CODE>
next to the <B>A.DATE</B> and 


<CODE><B>A2</B></CODE> next to <B>A.DEPART</B>.  This would have the same effect as if you wrote the
following SQL query:



<PRE>select a.depart, a.date
   from airline.march a
   order by a.date asc, a.depart asc;</PRE>
<BR><H3>Using the Usage Field</H3>


<P><A name="z1286933">&#13;The
<B>Usage</B> field accepts several
commands that apply summary (aggregate) functions on the values in the designated
column as shown in the following table. </A>
<P>
<TABLE cellpadding="6" cellspacing="0" border="1">


<TR valign="bottom" bgcolor="#CCCCCC">
  <TH  align="LEFT" valign="BOTTOM" ><B>Command</B></TH>
  <TH  align="LEFT" valign="BOTTOM" ><B>Function</B></TH>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>GROUP</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Groups data by the values in the column</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>SUM</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Computes the sum of values in the column</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>MIN</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Lists the lowest value (minimum)</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>MAX</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Lists the highest value (maximum)</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>MEAN</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Averages or finds the mean of values in the column;
equivalent to AVG</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>AVG</B></CODE><BR></TD>
  
<TD  align="LEFT" valign="TOP">Averages or finds the mean of values in the column</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>COUNT</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Counts the number of distinct, nonmissing values</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>N</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Counts the number of distinct, nonmissing values</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>CSS</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Reports the corrected sum of squares</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>CV</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Returns the coefficient of variation (percent)</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>NMISS</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Reports the number of missing values</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>PRT</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Reports the probability of a greater absolute value
of   Student's <B>t</B></TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>RANGE</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Reports a range of values</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>STD</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Shows the standard deviation</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>STDERR</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Returns the standard error of the mean</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>SUMWGT</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Returns the weighted sum</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>T</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Returns the Student's <B>t</B></TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>USS</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Returns the uncorrected sum of squares</TD>
</TR>


<TR valign="top" bgcolor="#FFFFFF">
  
<TD  align="LEFT" valign="TOP"><CODE><B>VAR</B></CODE></TD>
  
<TD  align="LEFT" valign="TOP">Returns the variance</TD>
</TR>

</TABLE>

<BR>
<P>When you use
summary functions in queries, columns with
no usage are treated as if they have GROUP usage. With SAS data, use the <B>Grouping in summary</B> User Profile option to specify which action
to take when using summary functions in queries. If you set this option to <B>Pop-up</B>, you are prompted whether or not to apply the GROUP usage
to all columns. If you set this option to <B>Yes</B>,
the GROUP usage is automatically applied to all columns. If you set this option
to <B>No</B>, the GROUP usage is not applied to any columns.
 See <A href="z1044230.htm">Doing More with Results</A>
and <A href="z1090164.htm">Customizing SAS/ASSIST Software</A>
for additional information.  Note that in DB2 queries, the GROUP usage is
always applied to all columns.
<BR><H3><A name="zesubset">Retrieving a Subset of Data</A></H3>


<P><A name="z1286975">&#13;To retrieve
some but not all rows of data in a query, apply subsetting criteria to the
data. In this example, you apply a subsetting criterion that retrieves information
about flights that were filled to at least three-quarters capacity.</A>
<OL START="1" type="1">
<LI>Select <B>Subset</B> from
the Query window to open the Subset
Rows window. In this window, you specify your subsetting criteria
(also called WHERE predicates). Do not include the word WHERE.<P>

<LI>On the first line, type the following:



<PRE>(boarded+transfer+nonrev)>=(0.75*capacity)</PRE>The following display shows
the edited Subset Rows window.
<P>
<P>
<B><I>Subset Rows Window</I></B><BR>

<P><IMG border="0" src="./images/01319273.gif" vspace="12" alt="[IMAGE]">
<P>Note that if only one table is selected for the query,
the alias
is not required for identifying columns in the Subset Rows
window.<P>

<LI>Follow this selection path to save your subset
criteria and return to the Query window:
<P><TABLE cellpadding="2">
<TR valign="middle">
<TD nowrap bgcolor="#CCCCCC">File</TD>
<TD><center><IMG border="0" src="../common/images/arrow.gif" alt="[arrow]"></center></TD>
<TD nowrap bgcolor="#CCCCCC">Close</TD></TR></TABLE>The word <B>Specified</B> appears under
<B>Subset</B>, so
you know that selection criteria have been applied to this query.<P>
</OL>
.
<P>If you do not remember the name of a column, you can
choose it from a selection list. Position your cursor in your subsetting criteria
where you want the column name. Select <B>Add Column Name</B>
from the <B>Edit</B> menu. A list of columns in the current
tables appears. First select a table from the list, and then select a column
name. The column name is added to your subsetting criteria.
<BR><H3><A name="prompt">Using the Prompt Facility</A></H3>


<P><A name="z1286980">&#13;You can use prompts
to run the same query several times on different subsets of data.  When you
run a query with a prompt, a window opens where you type a subset value. 
The rest of the query is then run with this value. Prompts give you more flexibility
in customizing your program.</A>
<P>The following steps show you how to create a prompt
window. In this example, you create a prompt that asks for a time value. The
prompt is used to return only rows with a departure time of or earlier than
the user-supplied time value.
<OL START="1" type="1">
<LI>Re-open the Subset Rows
window.<P>

<LI>On the second line, type the following:



<PRE>and depart&lt;=&amp;promptn</PRE>
<P>
<UL>

<LI><CODE><B>and</B></CODE> is a logical operator that specifies that both of the criteria must
be met for the row to be included in the output. Other logical operators are 


<CODE><B>or</B></CODE> and 


<CODE><B>not</B></CODE>.<P>

<LI><CODE><B>&amp;promptn</B></CODE> is the name of the prompt. The prompt name must be seven characters
or fewer and must be preceded by an ampersand (


<CODE><B>&amp;</B></CODE>).  <P>
</UL>
The following display shows the edited Subset
Rows window.
<P>
<P>
<B><I>Adding a Prompt to the Subset Rows Window</I></B><BR>

<P><IMG border="0" src="./images/01319274.gif" vspace="12" alt="[IMAGE]">
<P><P>

<LI>Select
<B>Prompt</B> from
the <B>Run</B> menu.  The Query Prompt Design window appears.<P>

<LI>Fill in the fields as shown in the following
display. 
<P>
<P>
<B><I>Query Prompt Design Window</I></B><BR>

<P><IMG border="0" src="./images/01319275.gif" vspace="12" alt="[IMAGE]">
<P>The <B>Default
value</B> field is optional;
if used, this value appears in the prompt window for the user to either accept
or overwrite.<P>

<LI>Select <B>OK</B> to return
to the Subset Rows window.<P>

<LI>Select <B>Close</B> from the <B>File</B> menu to return to the
Query
window.<P>
</OL>

<P>You can create an unlimited number of prompts for a
query. You can use a prompt to substitute any part of the subsetting criteria,
such as a logical operator (AND, OR, NOT), and you can use SAS macro functions.
 
<P><B>Note:</B>&nbsp;&nbsp;&nbsp;The prompt facility is also available from the SQL Editor window and from the Query Expression
window.&nbsp;&nbsp;<IMG border="0" src="../common/images/cautend.gif" alt="[cautionend]" align="bottom"><BR>
<BR><H3>Defining an Expression</H3>


<P><A name="z1286992">&#13;An
expression uses column names, functions, or constants to compute a result.
The expression creates a new column in the query. In this example, you create
a column that contains the number of paying customers on each flight.</A>
<OL START="1" type="1">
<LI>Select <B>Expression</B> from
the Query window. The Query Expression window appears.<P>

<LI>The expression is called EXP<B>_nnn</B>
by default. If desired, change it by typing over the name in the <B>Expression</B> field.  You can change the data type in the <B>Column type</B> field by
typing over the default value or by typing
a 


<CODE><B>?</B></CODE> in the field to display a selection list of data types. You can also
supply values for the <B>Format</B> and <B>Label</B> fields.
<P>Add your expression below the <B>Label</B>
field as shown in the following display.
<P>
<P>
<B><I>Query Expression Window</I></B><BR>

<P><IMG border="0" src="./images/01319276.gif" vspace="12" alt="[IMAGE]">
<P>Note that if only one table is selected for
the query, the alias
is not required when identifying columns in the Query Expression window.
<P>The previous display shows the Query
Expression window filled in, with the name changed to PAY_CUST, the column
type as NUMERIC, a LENGTH of 8, and the label "PAYING CUSTOMERS"
assigned.  An expression to calculate the number of paying customers is added
after the label.
<P>If you do not remember the name of a column, you can
choose it from a selection list. Position your cursor in your expression where
you want the column name. Select <B>Add Column Name</B>
from the <B>Edit</B> menu. A list of columns in the current
tables appears.  First select a table from the list and then select a column
name.  The column name is added to the expression.<P>

<LI>Select <B>Close</B> from the <B>File</B> menu to return to the
Query
window. The word <B>Specified</B> appears under <B>Expression</B> to indicate that an expression has been applied to
this query, and the new column, PAY_CUST, appears in the list of columns.<P>
</OL>

<P>The next time you select <B>Expression</B>
from the Query window,  a list of expressions appears;
select an expression to modify or select <B>&lt;NEW></B>
to create a new expression. Alternatively, you can edit an expression by typing 


<CODE><B>I</B></CODE> in the <B>Cmd</B> field next to the expression
name.
<P>You can add unlimited expressions to a query. To delete
an expression, select <B>Expression</B> from the Query  window and select the expression to be selected. From
the Query Expression window, select <B>Clear</B> from the <B>Edit</B> menu. Alternatively,
delete the column in the Query window by typing 


<CODE><B>D</B></CODE> in the <B>Cmd</B> field next to the expression
name.
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="zefining">Viewing the SQL Code, Running the Query, and Refining the Output</A></FONT></B></TD></TR></TABLE>

<BR><H3>Viewing the SQL Code</H3>


<P><A name="z1287001">&#13;As you
make changes to a query, the SQL code changes. You can browse the code by
selecting <B>Show SQL</B> from the <B>View</B>
menu in the Query window, the Subset
Rows window, the Query Expression
window, or the Join Manager window.</A>
<P>The SQL code in the following display is based on the
query on the AIRLINE.MARCH table constructed in the previous sections. Scroll
down to see the changes.
<P>
<P>
<B><I>Show SQL Window</I></B><BR>

<P><IMG border="0" src="./images/01319277.gif" vspace="12" alt="[IMAGE]">
<P>
<P>Select
<B>Close</B> from the <B>File</B> menu to return to the Query
window.
<BR><H3>Running the Query</H3>


<P><A name="z1287004">&#13;</A>
<OL START="1" type="1">
<LI>To
run the query, follow this
selection path from
the Query window: 
<P><TABLE cellpadding="2">
<TR valign="middle">
<TD nowrap bgcolor="#CCCCCC">Run</TD>
<TD><center><IMG border="0" src="../common/images/arrow.gif" alt="[arrow]"></center></TD>
<TD nowrap bgcolor="#CCCCCC">Submit</TD></TR></TABLE>The Prompt
window appears.
<P>
<P>
<B><I>Prompt Window</I></B><BR>

<P><IMG border="0" src="./images/01319278.gif" vspace="12" alt="[IMAGE]">
<P>For
this report, specify 


<CODE><B>'9:00't</B></CODE>, Make sure to use single quotation
marks (') around the date value, and include the 


<CODE><B>t</B></CODE> after the closing quote to convert the time to a SAS time value.<P>

<LI>Press ENTER. The query returns your output.
<P>
<P>
<B><I>Query Results</I></B><BR>

<P><IMG border="0" src="./images/01319279.gif" vspace="12" alt="[IMAGE]">
<P><P>
</OL>

<BR><H3>Refining the Output</H3>


<P><A name="z1287007">&#13;To
enhance the appearance of your report, make the following changes: </A>
<OL START="1" type="1">
<LI>From the Report Output
window, select <B>Titles</B> from the <B>Edit</B> menu.  Add the title 


<CODE><B>Information on Early Morning Flights</B></CODE>. Select <B>Close</B> from the <B>File</B> menu; when prompted, select <B>Yes</B>
to save the changes to the Titles window.<P>

<LI>Select <B>Page Layout</B>
from the <B>Edit</B> menu. If the <B>Date</B>
value is 


<CODE><B>YES</B></CODE>, set it to 


<CODE><B>NO</B></CODE> to remove the date and time
listing in your report. Set the <B>Center</B> value to 


<CODE><B>YES</B></CODE>, which centers the title.
Select <B>OK</B>.<P>
</OL>

<P>Select <B>Close</B> from the <B>File</B> menu to return to the
Query
window, then re-run the query by selecting Submit
from the <B>Run</B> menu. The following display shows
the modified report output.
<P>
<P>
<B><I>Query Results With Refinements</I></B><BR>

<P><IMG border="0" src="./images/01319280.gif" vspace="12" alt="[IMAGE]">
<P>
<P>Select
<B>Close</B> from the <B>File</B> menu to return to theQuery window.
<P>To save your output as a SAS or DB2
table, see <A href="zetables.htm">Creating New Tables</A>
<BR><H3>Limiting the Report's Output</H3>


<P><A name="z1287013">&#13;If you anticipate that your report may have many rows of output
and you need to see only some of them, you can limit the number of rows processed.
Doing so might also shorten the time the query runs, unless you have used
summary (aggregate) functions that must be computed on every row in the query.</A>
<P>To limit the number of rows in your output before you
run the query, select <B>Limit Output Rows</B> from the <B>Edit</B> menu of the Query window. The Limit Number of Output
Rows window appears.
<P>
<P>
<B><I>Limit Number of Output Rows Window</I></B><BR>

<P><IMG border="0" src="./images/01319281.gif" vspace="12" alt="[IMAGE]">
<P>The default value is
<B>MAX</B>. Type the number
of rows that you want to display and select <B>OK</B>. 
<P>When you exit the window, be aware that the specified
limit always limits the number of rows displayed in the Report
Output window. It also limits SAS or DB2 processing unless the
query contains summary functions that force processing of all rows of the
table(s) before returning the output to SAS.
<P>If a limit has been placed on the number of output rows
in your User Profile, you might be prompted when a query is run. A prompt
window appears, verifying that you want to limit the number of rows to be
output when this option has been selected in your profile. Type 


<CODE><B>S</B></CODE>
to stop at the specified number of rows, or 


<CODE><B>C</B></CODE> to ignore the limit,
and press ENTER. This feature is controlled by the User Profile options <B>Limit output rows</B> and <B>Limit Rows Pop-up Window</B> (see
<A href="z1090164.htm">Customizing SAS/ASSIST Software</A>).
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5"><A name="zvequery">Saving a Query</A></FONT></B></TD></TR></TABLE>

<P><A name="z1287017">&#13;The Query window remains untitled
until you save a query by using <B>Save</B> or <B>Save As</B> from the <B>File</B> menu. When you save a query, you give it a name and,
optionally,
a description. After the query is named, its name appears as part of the Query window title. To save and name your query, select <B>Save As</B> from the
<B>File</B> menu in the Query window. The Save As window
opens. Type the name of the query and a short description. Change the default
catalog if you want and select <B>OK</B>. When you return
to the Query window, the name of your query is
displayed after the window title.</A>
<P>Saved queries can be used to create reports with the
Report Engine. See <A href="z1081489.htm">Doing More with the Report Engine</A>
for more information.
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5">Resetting the Query Window</FONT></B></TD></TR></TABLE>

<P><A name="z1287019">&#13;To reset the
Query window in order
to build another query, select <B>New</B> from the <B>File</B> menu.  Doing so clears all existing data and specifications
from the Query window. To start another query,
choose <B>Select</B> to open the Select
window.</A>
<P><TABLE width="100%" cellpadding="0" cellspacing="0">
<TR valign="bottom"><TD><HR></TD></TR>
<TR valign="top"><TD><B><FONT size="5">Performing a COUNT(*) on a Table</FONT></B></TD></TR></TABLE>

<P><A name="z1287020">&#13;In order
to display the number of rows returned by a query (that is, to perform a COUNT(*)
on the table), follow these instructions: </A>
<OL START="1" type="1">
<LI>Use the Select window
to select tables and columns for the query.<P>

<LI>Modify the query with subsets, expressions, repeated
and deleted columns, and usages as desired.<P>

<LI>Follow this selection path:
<P><TABLE cellpadding="2">
<TR valign="middle">
<TD nowrap bgcolor="#CCCCCC">Edit</TD>
<TD><center><IMG border="0" src="../common/images/arrow.gif" alt="[arrow]"></center></TD>
<TD nowrap bgcolor="#CCCCCC">Count(*)</TD></TR></TABLE>Query and
Reporting
creates an expression called <B>COUNT(*)</B> with a usage
of <B>*</B>. This expression appears in the Query window.<P>

<LI>Select <B>Submit</B> from
the <B>Run</B> menu. If you have not applied a usage to
all columns, a prompt appears asking you if you want to apply a GROUP usage
to all columns. Select <B>Yes</B> or <B>No</B>.
The output includes a count of the returned rows.<P>

<LI>Select <B>Close</B> from the <B>File</B> menu to return to the
Query
window.<P>
</OL>

<P>To perform a COUNT DISTINCT(*) on a table:
<OL START="1" type="1">
<LI>Use the Select window
to select table for the query.<P>

<LI>From the Query window,
select <B>Expression</B> and specify 


<CODE><B>*</B></CODE> as your expression. Give the expression a name
and select <B>Close</B> from the <B>File</B>
menu to return to the Query window.<P>

<LI>Delete the numbers in the <B>No</B>
column for all columns, except the new expression, to remove them from the
output.<P>

<LI>Select <B>Submit</B> from
the <B>Run</B> menu. The output shows the number of distinct
nonmissing rows for the entire table.<P>

<LI>Select <B>Close</B> from the <B>File</B> menu to return to the
Query
window.<P>
</OL>

<P>To perform a COUNT(*) within a group: 
<OL START="1" type="1">
<LI>Use the Select window
to select tables and columns for the query.<P>

<LI>From the Query window,
select <B>Expression</B> and specify 


<CODE><B>*</B></CODE> as your expression. Give the expression a name
and select <B>Close</B> form the <B>File</B>
menu to return to the Query window.<P>

<LI>Specify the GROUP usage for the column of interest.
Delete the numbers in the <B>No</B> column for all columns
except the new expression and the column of interest.<P>

<LI>Select <B>Submit</B> from
the <B>Run</B> menu to run your query.  The output shows
the number of distinct values (groups) in the column of interest.<P>

<LI>Select <B>Close</B> from the <B>File</B> menu to
return to the Query
window.<P>
</OL>

<P>See <A href="z1081489.htm">Doing More with the Report Engine</A>
for more information on the <B>Usage</B> field.

<P><!-- navigation -->
<P><TABLE cellpadding="0" cellspacing="0">
<TR valign="top">
<TD align="center">
<A href="z1084674.htm">
<IMG border="0" SRC="../common/images/cont1.gif"><BR><FONT size="-2">Chapter Contents</FONT></A></TD>
<TD align="center">
<A href="openqm.htm">
<IMG border="0" src="../common/images/prev1.gif"><BR><FONT size="-2">Previous</FONT></A></TD>
<TD align="center">
<A href="zetables.htm">
<IMG border="0" SRC="../common/images/next1.gif"><BR><FONT size="-2">Next</FONT></A></TD>
<TD align="center">
<A href="#z0940396">
<IMG border="0" SRC="../common/images/top1.gif"><BR><FONT size="-2">Top of Page</FONT></A></TD>
</TR></TABLE>
<P><FONT size=1><A href="../common/images/copyrite.htm">Copyright 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>