<HTML>
<HEAD>
<TITLE>Numerical Integration</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect57.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect59.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The MODEL Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Numerical Integration  </H2>
<P>The differential equation system is numerically integrated to
obtain a solution for the derivative variables at each data point.
The integration is performed by evaluating the provided model
at multiple points between each 
data point. The integration method used is a variable order,
variable step-size backward difference scheme; for more
detailed information, refer to Aiken (1985) and Byrne (1975). The step size or
time step is chosen to satisfy a <I>local truncation error</I> requirement.
The term <I>truncation error</I> comes from the fact that the
integration scheme uses a truncated series expansion of the
integrated function to do the integration. Because the series
is truncated, the integration scheme is within the
truncation error of the true value.
<P>To further improve the accuracy of the integration, the total 
integration time is broken up into
small intervals (time steps or step sizes), and the integration 
scheme is applied to those
intervals. The integration at each time step uses the values
computed at the previous time step so that the truncation error
tends to accumulate.
It is usually not possible to estimate the global error with much
precision. The best that can be done is to monitor and to control
the local truncation error, which is the truncation error committed 
at each time step relative to
<P>
<DL CLASS="equation"><DD><IMG WIDTH="171" HEIGHT="85"
 SRC="images/modeq283.gif"
 ALT="d = \max_{0 {\leq} t {\leq} T}
({\parallel}y(t){\parallel}_{{\infty}},1 ) "></DL>
<P>where <SPAN CLASS="mathfont"><I>y</I>(<I>t</I>)</SPAN> is the integrated variable. Furthermore, the 
<SPAN CLASS="mathfont"><I>y</I>(<I>t</I>)</SPAN>s are 
dynamically scaled to within two orders of magnitude one to
keep the error monitoring well behaved.
<P><A NAME="idxmod0570">&#13;</A><A NAME="idxmod0571">&#13;</A><A NAME="idxmod0572">&#13;</A>The local truncation error requirement defaults to <SPAN CLASS="mathfont">1.0<I>E</I>-9</SPAN>. You can 
specify the LTEBOUND= option to modify that requirement. 
The LTEBOUND= option is a relative measure of accuracy, so a value
smaller than <SPAN CLASS="mathfont">1.0<I>E</I>-10</SPAN> is usually not practical. A larger
bound increases the speed of the simulation and estimation
but decreases the accuracy of the results. If the LTEBOUND= option is
set too small, the integrator is not able to take time steps
small enough to satisfy the local truncation error requirement
and still have enough machine precision to compute the results.
Since the integrations are scaled to within <SPAN CLASS="mathfont">1.0<I>E</I>-2</SPAN> of one, the
simulated values should be correct to at least seven decimal places.
<P><A NAME="idxmod0573">&#13;</A><A NAME="idxmod0574">&#13;</A><A NAME="idxmod0575">&#13;</A>There is a default minimum time step of <SPAN CLASS="mathfont">1.0<I>E</I>-14</SPAN>. This minimum
time step is controlled by the MINTIMESTEP= option and the machine
epsilon. If the minimum time step is smaller than the
machine epsilon times the final time value, the minimum time step
is increased automatically.
<P>For the points between each observation in the data set, the values for
nonintegrated variables in the data set are obtained from
a linear interpolation from the two closest points. Lagged variables
can be used with integrations, but their values are discrete
and are not interpolated between points. Lagging, therefore,  can then be
used to input step functions into the integration.
<P>The derivatives necessary for estimation (the gradient with respect to
the parameters) and goal seeking (the Jacobian)
are computed by numerically integrating analytical derivatives.
The accuracy of the derivatives is controlled by the same
integration techniques mentioned previously.
<P><A NAME="idxmod0577">&#13;</A><A NAME="idxmod0576">&#13;</A><A NAME="idxmod0579">&#13;</A><A NAME="idxmod0578">&#13;</A><A NAME="idxmod0580">&#13;</A><A NAME="idxmod0582">&#13;</A><A NAME="idxmod0581">&#13;</A><P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect57.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect59.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
