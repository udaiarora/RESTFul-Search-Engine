<HTML>
<HEAD>
<TITLE>Nonparametric Kernel Smoother</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect43.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect45.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Fit Analyses</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Nonparametric Kernel Smoother  </H2>
<A NAME="idxfit0689">&#13;</A><A NAME="idxfit0688">&#13;</A><A NAME="idxfit0691">&#13;</A><A NAME="idxfit0690">&#13;</A>A <I>kernel estimator</I> uses an explicitly defined set of
weights at each point <I>x</I> to produce the estimate at <I>x</I>.
The kernel estimator of <SPAN CLASS="mathfont"><I>f</I></SPAN> has the form

<DL CLASS="equation"><DD><IMG WIDTH="195" HEIGHT="110"
 SRC="images/fiteq195.gif"
 ALT="\hat{f_\lambda}(x) = \sum_{i=1}^n{W( x , x_{i} ; \lambda) y_{i}}"></DL>
where W<IMG WIDTH="71" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq196.gif"
 ALT="{( x , x_{i} ; \lambda)}"> is the weight
function that depends on the smoothing parameter <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda">.<A NAME="idxfit0693">&#13;</A><A NAME="idxfit0692">&#13;</A>The weights are derived from a single
function that is independent of the design

<DL CLASS="equation"><DD><IMG WIDTH="235" HEIGHT="108"
 SRC="images/fiteq197.gif"
 ALT="W( x , x_{i} ; \lambda) =
 \frac{K_{0} (
 \frac{x- x_{i}}{\lambda} )}{\sum_{j=1}^n{K_{0} (
 \frac{x- x_{j}}{\lambda} ) }}"></DL>
where  <SPAN CLASS="mathfont"><I>K<SUB>0</SUB></I></SPAN> is a kernel function and
<IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> is the bandwidth or smoothing parameter.
The weights are nonnegative and sum to 1.
<P>Symmetric probability density functions
commonly used as kernel functions are
<P><TABLE COLS=3 BORDER=0><COL><COL ALIGN=JUSTIFY><COL ALIGN=JUSTIFY>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="96" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq164.gif"
 ALT=" \bullet  Normal"></TD><TD><IMG WIDTH="195" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq198.gif"
 ALT="K_{0}(t) = \frac{1}{\sqrt{2{\pi}}} \exp( - t^2/2 )"></TD><TD>for <IMG WIDTH="109" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq199.gif"
 ALT="-\infty\lt t\lt\infty"></TD></TR>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="123" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq200.gif"
 ALT=" \bullet  Triangular"></TD><TD><IMG WIDTH="152" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq201.gif"
 ALT="K_{0}(t) = \{ 1 - {| t|}
 \ 0 
 \ ."></TD><TD><IMG WIDTH="96" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq202.gif"
 ALT="  {for | t|\le 1} \  {otherwise} \ "></TD></TR>
<TR VALIGN="TOP"><TD ALIGN=LEFT NOWRAP><IMG WIDTH="114" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq166.gif"
 ALT=" \bullet  Quadratic"></TD><TD><IMG WIDTH="175" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq203.gif"
 ALT="K_{0}(t) = \{ \frac{3}4 (1 - t^2)
 \ 0 
 \ ."></TD><TD><IMG WIDTH="96" HEIGHT="60" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq202.gif"
 ALT="  {for | t|\le 1} \  {otherwise} \ "></TD></TR>
</TABLE>
<P><A NAME="idxfit0695">&#13;</A><A NAME="idxfit0694">&#13;</A><A NAME="idxfit0697">&#13;</A><A NAME="idxfit0696">&#13;</A><A NAME="idxfit0699">&#13;</A><A NAME="idxfit0698">&#13;</A><A NAME="idxfit0701">&#13;</A><A NAME="idxfit0700">&#13;</A><A NAME="idxfit0703">&#13;</A><A NAME="idxfit0702">&#13;</A><A NAME="idxfit0705">&#13;</A><A NAME="idxfit0704">&#13;</A><A NAME="idxfit0707">&#13;</A><A NAME="idxfit0706">&#13;</A>You select a bandwidth <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> for each kernel
estimator by specifying <I>c</I> in the formula

<DL CLASS="equation"><DD><IMG WIDTH="90" HEIGHT="79"
 SRC="images/fiteq204.gif"
 ALT="\lambda = n^{-\frac{1}5} Q c"></DL>
where <I>Q</I> is the sample interquartile range of the
explanatory variable and <SPAN CLASS="mathfont"><I>n</I></SPAN> is the sample size.
This formulation makes <I>c</I> independent of the units of <SPAN CLASS="ssbeleven"><B>X</B></SPAN>.
<A NAME="idxfit0709">&#13;</A><A NAME="idxfit0708">&#13;</A>SAS/INSIGHT software divides the range of the explanatory
variable into 128 evenly spaced intervals, then approximates
the data on this grid and uses the fast Fourier transformation
(Silverman 1986) to estimate the kernel fit on this grid.
For a data point <SPAN CLASS="mathfont"> <I>x</I><SUB><I>i</I></SUB></SPAN> that lies
between two grid points, a linear interpolation
is used to compute the predicted value.
A small value of <IMG WIDTH="14" HEIGHT="16" ALIGN="BOTTOM" BORDER="0"
 SRC="images/fiteq54.gif"
 ALT="\lambda"> (relative to the width of the
interval) may give unstable estimates of the kernel fit.
<P>
<P>After choosing <SPAN CLASS="ssbeleven"><B>Curves:Kernel</B></SPAN>, you specify a kernel and
smoothing parameter selection method in the <SPAN CLASS="ssbeleven"><B>Kernel Fit</B></SPAN> dialog.
<P><A NAME="fitkernelfitdialog">&#13;</A><CENTER><IMG SRC="images/fit40.gif" ALT="fit40.gif (4499 bytes)" HEIGHT="287" WIDTH="587"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 39.42:</B> Kernel Fit Dialog</SPAN><P>
<P>The default <SPAN CLASS="ssbeleven"><B>Weight:Normal</B></SPAN> uses a normal weight,
and <SPAN CLASS="ssbeleven"><B>Method:GCV</B></SPAN> uses a <I>c</I> value that minimizes
<IMG WIDTH="100" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/fiteq127.gif"
 ALT="{ \rm{MSE}_{GCV}(\lambda)}">.<A HREF="sect44.htm#fitkernelestimates">Figure 39.43</A> illustrates normal
kernel estimates with <I>c</I> values of
0.0944 (the GCV value) and 0.7546 (DF=3).
Use the slider to change the <I>c</I> value of the kernel fit.
<A NAME="idxfit0710">&#13;</A><P><A NAME="fitkernelestimates">&#13;</A><CENTER><IMG SRC="images/fit41.gif" ALT="fit41.gif (13516 bytes)" HEIGHT="527" WIDTH="943"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 39.43:</B> Kernel Estimates</SPAN><P>
<P>
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect43.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect45.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
