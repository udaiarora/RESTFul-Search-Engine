<HTML>
<HEAD>
<TITLE>Forecasting</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect19.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect21.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">The STATESPACE Procedure</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Forecasting  </H2>
<P><A NAME="idxsta0105">&#13;</A><A NAME="idxsta0104">&#13;</A><A NAME="idxsta0107">&#13;</A><A NAME="idxsta0106">&#13;</A>Given estimates of <SPAN CLASS="mathfont"><b>F</b></SPAN>, <SPAN CLASS="mathfont"><b>G</b></SPAN>,
and <IMG WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq53.gif"
 ALT="{{\Sigma}_{ee}}">,forecasts of <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN> are computed
from the conditional expectation of <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I></sub></SPAN>.
<P>In forecasting, the parameters <B>F</B>, <B>G</B>, and
<IMG WIDTH="34" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq53.gif"
 ALT="{{\Sigma}_{ee}}">are replaced with the estimates
or by values specified in the RESTRICT statement.
One-step-ahead forecasting is performed
for the observation <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN>, where <IMG WIDTH="65" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq63.gif"
 ALT="{t{\leq}n-b}">.Here <SPAN CLASS="mathfont"><I>n</I></SPAN> is the number of observations
and <I>b</I> is the value of the BACK= option.
For the observation <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I></sub></SPAN>,
where <SPAN CLASS="mathfont"><I>t</I> &#62; <I>n</I>-<I>b</I></SPAN>,
<I>m</I>-step-ahead forecasting is performed for <SPAN CLASS="mathfont"><I>m</I> = <I>t</I>-<I>n</I> + <I>b</I></SPAN>.
The forecasts are generated recursively with the initial condition
<SPAN CLASS="mathfont"><b>z</b><sub>0</sub> = 0</SPAN>.
<P>The <I>m</I>-step-ahead forecast of <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I>+<I>m</I></sub></SPAN> is
<IMG WIDTH="51" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq64.gif"
 ALT="{z_{t+m| t}}">,where <IMG WIDTH="51" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq64.gif"
 ALT="{z_{t+m| t}}"> denotes the conditional expectation
of <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I>+<I>m</I></sub></SPAN> given the information available at time <I>t</I>.
The <I>m</I>-step-ahead forecast of <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I>+<I>m</I></sub></SPAN>
is <IMG WIDTH="141" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq65.gif"
 ALT="{x_{t+m| t} = H{z}_{t+m| t}}">,where the matrix <SPAN CLASS="mathfont"><b>H</b> = [<b>I</b><sub><I>r</I></sub> <b>0</b>]</SPAN>.
<P>Let <IMG WIDTH="83" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq66.gif"
 ALT="{{\Psi}_{i} = F^i G}">.Note that the last <SPAN CLASS="mathfont"><I>s</I>-<I>r</I></SPAN> elements of <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I></sub></SPAN>
consist of the elements of <IMG WIDTH="32" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq67.gif"
 ALT="{x_{u| t}}"> for <SPAN CLASS="mathfont"><I>u</I>&#62;<I>t</I></SPAN>.
<P>The state vector <SPAN CLASS="mathfont"><b>z</b><sub><I>t</I>+<I>m</I></sub></SPAN> can be represented as
<P>
<DL CLASS="equation"><DD><IMG WIDTH="234" HEIGHT="112"
 SRC="images/staeq68.gif"
 ALT="z_{t+m} = F^m z_{t} +
 \sum_{i=0}^{m-1}{{\Psi}_{i} e_{t+m-i}}"></DL>
<P>Since <IMG WIDTH="78" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq69.gif"
 ALT="{e_{t+i| t} = 0}"> for <SPAN CLASS="mathfont"><I>i</I>&#62;0</SPAN>,
the <I>m</I>-step-ahead forecast <IMG WIDTH="51" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq64.gif"
 ALT="{z_{t+m| t}}"> is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="213" HEIGHT="76"
 SRC="images/staeq70.gif"
 ALT="z_{t+m| t} = F^m z_{t} = F z_{t+m-1| t}"></DL>
<P>Therefore, the <I>m</I>-step-ahead forecast of <SPAN CLASS="mathfont"><b>x</b><sub><I>t</I>+<I>m</I></sub></SPAN> is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="134" HEIGHT="75"
 SRC="images/staeq71.gif"
 ALT="x_{t+m| t} = H{z}_{t+m| t}"></DL>
<P>The <I>m</I>-step-ahead forecast error is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="240" HEIGHT="112"
 SRC="images/staeq72.gif"
 ALT="z_{t+m}-z_{t+m| t} =
\sum_{i=0}^{m-1}{{\Psi}_{i} e_{t+m-i}}"></DL>
<P>The variance of the <I>m</I>-step-ahead forecast error is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="168" HEIGHT="112"
 SRC="images/staeq73.gif"
 ALT="V_{z,m} =
\sum_{i=0}^{m-1}{{\Psi}_{i} {\Sigma}_{ee}
{\Psi}_{i}'}"></DL>
<P>Letting <SPAN CLASS="mathfont"><b>V</b><sub><I>z</I>,0</sub> = <b>0</b></SPAN>,
the variance of the <I>m</I>-step-ahead forecast error of
<SPAN CLASS="mathfont"><b>z</b><sub><I>t</I>+<I>m</I></sub></SPAN>, <SPAN CLASS="mathfont"><b>V</b><sub><I>z</I>,<I>m</I></sub></SPAN>,
can be computed recursively as follows:
<P>
<DL CLASS="equation"><DD><IMG WIDTH="266" HEIGHT="79"
 SRC="images/staeq74.gif"
 ALT="V_{z,m} = V_{z,m-1} + {\Psi}_{m-1}
 {\Sigma}_{ee} {\Psi}^{'}_{m-1}"></DL>
<P>The variance of the <I>m</I>-step-ahead forecast error of
<SPAN CLASS="mathfont"><b>x</b><sub><I>t</I>+<I>m</I></sub></SPAN> is
the <SPAN CLASS="mathfont"><I>r</I> &times;<I>r</I></SPAN> left upper submatrix of <SPAN CLASS="mathfont"><b>V</b><sub><I>z</I>,<I>m</I></sub></SPAN>;
that is,
<P>
<DL CLASS="equation"><DD>
<SPAN CLASS="mathfont"><b>V</b><sub><I>x</I>,<I>m</I></sub> = <b>H</b><b>V</b><sub><I>z</I>,<I>m</I></sub><b>H</b>'</SPAN>
</DL>
<P>Unless the NOCENTER option is specified, the sample mean vector
is added to the forecast.
When differencing is specified,
the forecasts <B>x</B><SPAN CLASS="mathfont"><SUB><I>t</I>+<I>m</I>|<I>t</I></SUB></SPAN> plus the sample mean vector
are integrated back to produce forecasts for the original series.
<P>Let <SPAN CLASS="mathfont"><b>y</b><sub><I>t</I></sub></SPAN> be the original series specified by the VAR statement,
with some 0 values appended corresponding to the unobserved past observations.
Let B be the backshift operator,
and let <IMG WIDTH="50" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq75.gif"
 ALT="{{\Delta}(B)}"> be the <SPAN CLASS="mathfont"><I>s</I> &times;<I>s</I></SPAN> matrix polynomial in the
backshift operator corresponding to the differencing specified by the
VAR statement.
The off-diagonal elements of <IMG WIDTH="26" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq76.gif"
 ALT="{{\Delta}_{i}}"> are 0.
Note that <IMG WIDTH="68" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq77.gif"
 ALT="{{\Delta}_{0} = I_{s}}">, where
<SPAN CLASS="mathfont"><b>I</b><sub><I>s</I></sub></SPAN> is the <SPAN CLASS="mathfont"><I>s</I> &times;<I>s</I></SPAN> identity matrix.
Then <IMG WIDTH="106" HEIGHT="33" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq78.gif"
 ALT="{z_{t} = {\Delta}(B)y_{t}}">.<P>This gives the relationship
<P>
<DL CLASS="equation"><DD><IMG WIDTH="224" HEIGHT="110"
 SRC="images/staeq79.gif"
 ALT="y_{t} = {\Delta}^{-1}(B) z_{t}
 = \sum_{i=0}^{{\infty}}{{\Lambda}_{i}z_{t-i}}"></DL>
<P>where
<IMG WIDTH="179" HEIGHT="36" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq80.gif"
 ALT="{{\Delta}^{-1}(B) =\sum_{i=0}^{{\infty}}{{\Lambda}_{i} B^i}}"> and
<IMG WIDTH="65" HEIGHT="31" ALIGN="MIDDLE" BORDER="0"
 SRC="images/staeq81.gif"
 ALT="{{\Lambda}_{0} = I_{s}}">.<P>The <I>m</I>-step-ahead forecast of <SPAN CLASS="mathfont"><b>y</b><sub><I>t</I>+<I>m</I></sub></SPAN> is
<P>
<DL CLASS="equation"><DD><IMG WIDTH="317" HEIGHT="112"
 SRC="images/staeq82.gif"
 ALT="y_{t+m| t} = \sum_{i=0}^{m-1}{{\Lambda}_{i} z_{t+m-i| t}}
 + \sum_{i=m}^{{\infty}}{{\Lambda}_{i} z_{t+m-i}}"></DL>
<P>The <I>m</I>-step-ahead forecast error of <SPAN CLASS="mathfont"><b>y</b><sub><I>t</I>+<I>m</I></sub></SPAN> is
<P><DL CLASS="equation"><DD><IMG WIDTH="449" HEIGHT="126" ALIGN="left"
 SRC="images/staeq83.gif"
 ALT="\sum_{i=0}^{m-1}{{\Lambda}_{i}
 (z_{t+m-i} - z_{t+m-i| t})}
 = \sum_{i=0}^{m-1} (\sum_{u=0}^i{{\Lambda}_{u} {\Psi}_{i-u}}) e_{t+m-i} "><BR CLEAR="ALL">
</DL>
<P>Letting <SPAN CLASS="mathfont"><b>V</b><sub><I>y</I>,0</sub> = <b>0</b></SPAN>,
the variance of the <I>m</I>-step-ahead forecast error
of <SPAN CLASS="mathfont"><b>y</b><sub><I>t</I>+<I>m</I></sub></SPAN>, <SPAN CLASS="mathfont"><b>V</b><sub><I>y</I>,<I>m</I></sub></SPAN>, is
<P><DL CLASS="equation"><DD><IMG WIDTH="513" HEIGHT="189" ALIGN="left"
 SRC="images/staeq84.gif"
 ALT="V_{y,m} &=& \sum_{i=0}^{m-1}{(\sum_{u=0}^i{{\Lambda}_{u} {\Psi}_{i-u}})
 {\Sigma...
 ...Psi}_{m-1-u}})
 {\Sigma}_{ee} (\sum_{u=0}^{m-1}{{\Lambda}_{u} {\Psi}_{m-1-u}})' "><BR CLEAR="ALL">
</DL><P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect19.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect21.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
