<HTML>
<HEAD>
<TITLE>Normal Kernel Fit</TITLE>
<LINK REL="STYLESHEET" TYPE="text/css" HREF="../sas.css">
</HEAD>
<BODY BGCOLOR="#FFFFFF" TEXT="#000000">
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A NAME="topofpage" HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect5.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect7.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
</TR>
</TABLE>
<TABLE BGCOLOR="#CCCC99" WIDTH="100%" CELLPADDING=4>
<TR>
  <TD VALIGN=MIDDLE CLASS="chaphead"><I><FONT SIZE="2">Fitting Curves</FONT></I></TD>
</TR>
</TABLE><BR>
<P><!--End of Navigation Panel-->
<H2>Normal Kernel Fit  </H2>
<A NAME="idxcur0053">&#13;</A><A NAME="idxcur0052">&#13;</A><A NAME="idxcur0055">&#13;</A><A NAME="idxcur0054">&#13;</A><A NAME="idxcur0056">&#13;</A>To add a normal kernel estimate in the <SPAN CLASS="ssbeleven"><B>MININGX</B></SPAN> fit window
from the preceding section, follow these steps.
<P><p><TABLE WIDTH="100%" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD ALIGN="CENTER" WIDTH="70"><img width="32" height="32" alt="" src="../../common/images/step.gif"><br>
</TD><TD BGCOLOR="#F0F0F0" CLASS="step">Choose <SPAN CLASS="ssbeleven"><B>Curves:Kernel</B></SPAN>.</TD></TR></TABLE><p><BR>This displays the kernel fit dialog, as 
shown in <A HREF="sect6.htm#curkernelfitdialog">Figure 13.14</A>.
<P><A NAME="curkernelfitdialog">&#13;</A><CENTER><IMG SRC="images/cur14.gif" ALT="cur14.gif (4764 bytes)" HEIGHT="297" WIDTH="597"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 13.14:</B> Kernel Fit Dialog</SPAN><P>
<P>
<P><p><TABLE WIDTH="100%" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD ALIGN="CENTER" WIDTH="70"><img width="32" height="32" alt="" src="../../common/images/step.gif"><br>
</TD><TD BGCOLOR="#F0F0F0" CLASS="step">Click on <SPAN CLASS="ssbeleven"><B>OK</B></SPAN> in the dialog to display 
the kernel fit, as shown in <A HREF="sect6.htm#curnormalkernelfit">Figure 13.15</A>.</TD></TR></TABLE><p>
<P><A NAME="curnormalkernelfit">&#13;</A><CENTER><IMG SRC="images/cur15.gif" ALT="cur15.gif (12104 bytes)" HEIGHT="515" WIDTH="906"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 13.15:</B> Normal Kernel Fit</SPAN><P>
<P>By default, the optimal kernel smoothness is estimated based on
mean square error using <I>generalized cross validation</I> (GCV).
Cross validation leaves out points
(<I>x<SPAN CLASS="mathfont"><SUB><I>i</I></SUB></SPAN></I>, <I>y<SPAN CLASS="mathfont"><SUB><I>i</I></SUB></SPAN></I>) one at a time and
computes the kernel regression at <I>x<SPAN CLASS="mathfont"><SUB><I>i</I></SUB></SPAN></I>
based on the remaining <I>n</I>-1 observations.
Generalized cross validation is a weighted version
of cross validation and is easier to compute.
This estimation is carried out for a number of
different values of the smoothing parameter, and
the value that minimizes the estimated mean square
error is selected (Hastie and Tibshirani 1990).
This technique is described in detail in <A HREF="../chap39/index.htm">Chapter 39, &#34;Fit Analyses.&#34;</A>
Note that in <A HREF="sect6.htm#curnormalkernelfit">Figure 13.15</A>, the <SPAN CLASS="ssbeleven"><B>Kernel Fit</B></SPAN>
table shows the <SPAN CLASS="ssbeleven"><B>Method</B></SPAN> as <SPAN CLASS="ssbeleven"><B>GCV</B></SPAN>.
<A NAME="idxcur0058">&#13;</A><A NAME="idxcur0057">&#13;</A><A NAME="idxcur0060">&#13;</A><A NAME="idxcur0059">&#13;</A><A NAME="idxcur0062">&#13;</A><A NAME="idxcur0061">&#13;</A><A NAME="idxcur0064">&#13;</A><A NAME="idxcur0063">&#13;</A><A NAME="idxcur0065">&#13;</A><A NAME="idxcur0066">&#13;</A><A NAME="idxcur0067">&#13;</A>You can change the degree of smoothness by using the slider
in the <SPAN CLASS="ssbeleven"><B>Kernel Fit</B></SPAN> table to change the value of <I>c</I>.
Higher values of <I>c</I> result in smoother curves closer to
a straight line; smaller values produce more flexible curves.
It is often necessary to experiment with several values
before finding one that fits your data well.
See <A HREF="../chap39/index.htm">Chapter 39, &#34;Fit Analyses,&#34;</A> for detailed information about
kernels and the <I>c</I> parameter.
Note that if you use the slider to change the value
of <I>c</I>, the <SPAN CLASS="ssbeleven"><B>Method</B></SPAN> entry also changes.
<A NAME="idxcur0068">&#13;</A>The <SPAN CLASS="ssbeleven"><B>Kernel Fit</B></SPAN> table contains several statistics
for comparing the kernel fit to other fits.
The table contains the bandwidth or smoothing parameter
of the kernel that corresponds to the value of <I>c</I>.
The column labeled <SPAN CLASS="ssbeleven"><B>DF</B></SPAN> gives the approximate
degrees of freedom for the kernel fit.
Smoother curves have fewer degrees of freedom and
result in lower values of  <SPAN CLASS="mathfont"><I>R<SUp>2</SUp></I></SPAN> and
possibly higher values of mean square error.
<SPAN CLASS="ssbeleven"><B>R-square</B></SPAN> measures the proportion of the total
variation accounted for by the kernel fit.
<SPAN CLASS="ssbeleven"><B>MSE(GCV)</B></SPAN> is an estimate of the mean square
error using generalized cross validation.
These statistics are also discussed in <A HREF="../chap39/index.htm">Chapter 39, &#34;Fit Analyses.&#34;</A>
<A NAME="idxcur0069">&#13;</A><A NAME="idxcur0070">&#13;</A><A NAME="idxcur0071">&#13;</A><A NAME="idxcur0072">&#13;</A><A NAME="idxcur0073">&#13;</A>This kernel tracks the data fairly well.
The fit requires 20.759 degrees of freedom, indicating
that the model may still be under-smoothed.
The generalized cross validation method often
results in under-smoothed fits, particularly with
small data sets (Hastie and Tibshirani 1990).
In this case, the data were collected from a single
drilling hole, and this can lead to spurious cyclical
patterns in the data caused by autocorrelation.
The curve may be tracking these cycles.
A smoother fit is probably desirable.
<A NAME="idxcur0074">&#13;</A><A NAME="idxcur0075">&#13;</A><p><TABLE WIDTH="100%" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD ALIGN="CENTER" WIDTH="70"><img width="32" height="32" alt="" src="../../common/images/step.gif"><br>
</TD><TD BGCOLOR="#F0F0F0" CLASS="step">Click three times on the right arrow in the slider.</TD></TR></TABLE><p><BR>This results in a smoother kernel fit, as shown in 
<A HREF="sect6.htm#curnormalkernelfitsmoother">Figure 13.16</A>.
<P><A NAME="curnormalkernelfitsmoother">&#13;</A><CENTER><IMG SRC="images/cur16.gif" ALT="cur16.gif (11528 bytes)" HEIGHT="515" WIDTH="906"></CENTER><BR>
<SPAN CLASS="ssften"><B>Figure 13.16:</B> Normal Kernel Fit Made Smoother</SPAN><P>
<P>
<P>
<!--Navigation Panel-->
<TABLE BORDER="0" CELLPADDING="0">
<TR VALIGN="TOP">
  <TD ALIGN="CENTER">
  <A HREF="index.htm">
  <IMG BORDER="0" SRC="../../common/images/cont1.gif" ALT="Chapter Contents" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Chapter Contents</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect5.htm"><IMG BORDER="0" SRC="../../common/images/prev1.gif" ALT="Previous" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Previous</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="sect7.htm"><IMG BORDER="0" SRC="../../common/images/next1.gif" ALT="Next" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Next</FONT></A></TD>
  <TD ALIGN=CENTER>
  <A HREF="#topofpage">
  <IMG BORDER="0" SRC="../../common/images/top1.gif" ALT="Top" WIDTH="99" HEIGHT="16"><BR><FONT SIZE="-2">Top</FONT></A></TD>
</TR>
</TABLE>
<P><!--End of Navigation Panel-->
<P><FONT SIZE="1"><A HREF="../../common/images/copyrite.htm">Copyright &copy; 1999 by SAS Institute Inc., Cary, NC, USA. All rights reserved.</A></FONT>
</BODY>
</HTML>
